{"componentChunkName":"component---src-templates-post-tsx","path":"/react-fiber03/","result":{"data":{"markdownRemark":{"html":"<p><a href=\"https://medium.com/react-in-depth/in-depth-explanation-of-state-and-props-update-in-react-51ab94563311\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이글</a>을 번역 및 분석 한 글입니다. 잘못된 번역 및 생략된 번역이 있을 수 있습니다.</p>\n<h1 id=\"in-depth-explanation-of-state-and-props-update-in-react\" style=\"position:relative;\"><a href=\"#in-depth-explanation-of-state-and-props-update-in-react\" aria-label=\"in depth explanation of state and props update in react permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>In-depth explanation of state and props update in React</h1>\n<p>이전 기사 인 <a href=\"https://medium.com/react-in-depth/inside-fiber-in-depth-overview-of-the-new-reconciliation-algorithm-in-react-e1c04700ef6e?source=post_page---------------------------\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Inside Fiber: in-depth overview of the new reconciliation algorithm in React</a> 에서는 이 기사에서 설명 할 업데이트 프로세스의 기술적 세부 사항을 이해하는 데 필요한 기반을 마련했습니다.</p>\n<p>필자는 이 기사에서 사용할 주요 데이터 구조 및 개념, 특히 fiber 노드, current 및 work-in-progress 트리, side-effects 및 effects list 에 대해 설명했습니다. 또한 주요 알고리즘에 대한 높은 수준의 개요를 제공하고 렌더링 및 커밋 단계의 차이점을 설명했습니다. 그것을 읽지 않았다면 거기에서 시작하는 것이 좋습니다.</p>\n<p>또한 화면에 렌더링 된 숫자를 단순히 증가시키는 버튼을 사용하여 샘플 애플리케이션을 소개했습니다.</p>\n<p><a href=\"https://stackblitz.com/edit/react-jwqn64?source=post_page---------------------------\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">여기</a>에서 해볼 수 있습니다. 이는 render 메소드에서 두 개의 하위 요소 button 및 span 을 반환하는 간단한 구성 요소로 구현됩니다. 버튼을 클릭하면 구성 요소의 상태가 핸들러 내부에서 업데이트됩니다. <code class=\"language-text\">span</code> 요소에 대한 텍스트 업데이트 결과는 다음과 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ClickCounter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> count<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> count<span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token operator\">&lt;</span>button key<span class=\"token operator\">=</span><span class=\"token string\">\"1\"</span> onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        Update counter\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">&lt;</span>span key<span class=\"token operator\">=</span><span class=\"token string\">\"2\"</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기에서는 <code class=\"language-text\">componentDidUpdate</code> 라이프 사이클 메서드를 구성 요소에 추가했습니다. 이것은 React 가 <code class=\"language-text\">커밋 단계</code>에서 이 메서드를 호출하는 <a href=\"https://medium.com/react-in-depth/inside-fiber-in-depth-overview-of-the-new-reconciliation-algorithm-in-react-e1c04700ef6e\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">effects</a>를 추가하는 방법을 보여주기 위해 필요합니다.</p>\n<p>이 글에서는 React 프로세스 state 업데이트 및 effects list 작성 방법을 알려 드리고자 합니다. <code class=\"language-text\">렌더링</code> 및 <code class=\"language-text\">커밋 단계</code>의 고급 기능에서 진행중인 작업을 살펴 ​​ 봅니다.\n특히, 우리는 React <code class=\"language-text\">completeWork</code>에서 어떻게 작동하는지 볼것입니다.</p>\n<ul>\n<li><code class=\"language-text\">ClickCounter</code>의 <code class=\"language-text\">state</code>에서 <code class=\"language-text\">count</code> 속성을 업데이트합니다.</li>\n<li><code class=\"language-text\">render</code> 메서드를 호출하여 children 목록을 가져 와서 비교를 수행합니다.</li>\n<li><code class=\"language-text\">span</code> 요소에 대한 props 을 업데이트합니다.</li>\n</ul>\n<p>그리고, <code class=\"language-text\">commitRoot</code>에서 React :</p>\n<ul>\n<li><code class=\"language-text\">span</code> 요소의 <code class=\"language-text\">textContent</code> 속성을 업데이트합니다.</li>\n<li><code class=\"language-text\">componentDidUpdate</code> 라이프 사이클 메소드를 호출합니다.</li>\n</ul>\n<p>그러나 그 전에 <code class=\"language-text\">click</code> 핸들러에서 <code class=\"language-text\">setState</code>를 호출 할 때 작업 일정을 빠르게 살펴 보겠습니다.</p>\n<p><strong>React 를 사용하기 위해 그걸 알 필요는 없습니다. 이 기사는 React 가 내부적으로 어떻게 작동하는지에 대한 것입니다.</strong></p>\n<h2 id=\"render-phase\" style=\"position:relative;\"><a href=\"#render-phase\" aria-label=\"render phase permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Render phase</h2>\n<h3 id=\"scheduling-updates\" style=\"position:relative;\"><a href=\"#scheduling-updates\" aria-label=\"scheduling updates permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scheduling updates</h3>\n<p>버튼을 클릭하면 <code class=\"language-text\">click</code> 이벤트가 트리거되고 React 는 button props 로 전달한 콜백함수를 실행합니다. 우리의 응용 프로그램에서는 단순히 카운터를 증가시키고 상태를 업데이트합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ClickCounter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>count<span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>모든 React component 에는 component 와 React 코어 사이의 다리 역할을 하는 연결된 <code class=\"language-text\">updater</code>가 있습니다. 이를 통해 setState 가 ReactDOM, React Native, 서버 측 렌더링 및 테스트 유틸리티에 의해 다르게 구현 될 수 있습니다.</p>\n<p><a href=\"https://github.com/facebook/react/blob/b87aabdfe1b7461e7331abb3601d9e6bb27544bc/packages/react/src/ReactBaseClasses.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">setState 여기 참조</a></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * Base class helpers for the updating state of a component.\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">,</span> updater</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 적절한 updater를 받게 되어 있음.</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context <span class=\"token operator\">=</span> context<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// If a component has string refs, we will assign a different object later.</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>refs <span class=\"token operator\">=</span> emptyObject<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// We initialize the default updater but the real one gets injected by the</span>\n  <span class=\"token comment\">// renderer.</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>updater <span class=\"token operator\">=</span> updater <span class=\"token operator\">||</span> ReactNoopUpdateQueue<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token class-name\">Component</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">setState</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">partialState<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">invariant</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">typeof</span> partialState <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span> <span class=\"token operator\">||</span>\n      <span class=\"token keyword\">typeof</span> partialState <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span> <span class=\"token operator\">||</span>\n      partialState <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'setState(...): takes an object of state variables to update or a '</span> <span class=\"token operator\">+</span>\n      <span class=\"token string\">'function which returns an object of state variables.'</span>\n  <span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>updater<span class=\"token punctuation\">.</span><span class=\"token function\">enqueueSetState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> partialState<span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">,</span> <span class=\"token string\">'setState'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://github.com/facebook/react/blob/0f3838a01b0fda0ac5fd054c6be13166697a113c/packages/react-reconciler/src/ReactFiberClassComponent.js#L180\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">classComponentUpdater 여기 참조</a></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> classComponentUpdater <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  isMounted<span class=\"token punctuation\">,</span>\n  <span class=\"token function\">enqueueSetState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">inst<span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> fiber <span class=\"token operator\">=</span> ReactInstanceMap<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>inst<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> currentTime <span class=\"token operator\">=</span> <span class=\"token function\">requestCurrentTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> expirationTime <span class=\"token operator\">=</span> <span class=\"token function\">computeExpirationForFiber</span><span class=\"token punctuation\">(</span>currentTime<span class=\"token punctuation\">,</span> fiber<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> update <span class=\"token operator\">=</span> <span class=\"token function\">createUpdate</span><span class=\"token punctuation\">(</span>expirationTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    update<span class=\"token punctuation\">.</span>payload <span class=\"token operator\">=</span> payload<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>callback <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">&amp;&amp;</span> callback <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>__DEV__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">warnOnInvalidCallback</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">,</span> <span class=\"token string\">'setState'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      update<span class=\"token punctuation\">.</span>callback <span class=\"token operator\">=</span> callback<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">enqueueUpdate</span><span class=\"token punctuation\">(</span>fiber<span class=\"token punctuation\">,</span> update<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">scheduleWork</span><span class=\"token punctuation\">(</span>fiber<span class=\"token punctuation\">,</span> expirationTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 글에서는 Fiber reconciler 를 사용하는 ReactDOM 의 updater 객체 구현을 살펴 보겠습니다. <code class=\"language-text\">ClickCounter</code> 구성 요소의 경우 <a href=\"https://github.com/facebook/react/blob/6938dcaacbffb901df27782b7821836961a5b68d/packages/react-reconciler/src/ReactFiberClassComponent.js?source=post_page---------------------------#L186\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">classComponentUpdater</code></a>입니다. 이는 Fiber 의 인스턴스를 검색하고, 업데이트를 대기열에 넣어두고, 작업을 예약하는(scheduling) 역할을합니다.</p>\n<p>업데이트가 대기열에 있으면 기본적으로 업데이트 큐에 추가되어 fiber 노드에서 처리됩니다. 여기서는 <code class=\"language-text\">ClickCounter</code> 구성 요소에 해당하는 Fibre 노드의 구조는 다음과 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n    stateNode<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ClickCounter</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token operator\">:</span> ClickCounter<span class=\"token punctuation\">,</span>\n    updateQueue<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n         baseState<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span>\n         firstUpdate<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n             next<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                 <span class=\"token function-variable function\">payload</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>count<span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n             <span class=\"token punctuation\">}</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n         <span class=\"token operator\">...</span>\n     <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>보시다시피 <code class=\"language-text\">updateQueue.firstUpdate.next.payload</code>의 함수는 <code class=\"language-text\">ClickCounter</code> 구성 요소의 <code class=\"language-text\">setState</code>에 전달한 콜백함수입니다. <code class=\"language-text\">렌더링 단계</code>에서 처리해야하는 첫 번째 업데이트를 나타냅니다.</p>\n<h3 id=\"processing-updates-for-the-clickcounter-fiber-node\" style=\"position:relative;\"><a href=\"#processing-updates-for-the-clickcounter-fiber-node\" aria-label=\"processing updates for the clickcounter fiber node permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Processing updates for the ClickCounter Fiber node</h3>\n<p><a href=\"https://medium.com/react-in-depth/inside-fiber-in-depth-overview-of-the-new-reconciliation-algorithm-in-react-e1c04700ef6e\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이전 기사의 작업 루프 장</a>에서는 <code class=\"language-text\">nextUnitOfWork</code> 전역 변수의 역할에 대해 설명했습니다. 특히, 이 변수는해야 할 일이있는 <code class=\"language-text\">workInProgress</code> 트리에서 Fibre 노드에 대한 참조를 보유하고 있음을 나타냅니다. React 가 Fibers 트리를 탐색하면서이 변수를 사용하여 완료되지 않은 다른 Fiber 노드가 있는지 확인합니다.</p>\n<p><code class=\"language-text\">setState</code> 메소드가 호출되었다고 가정 해 보겠습니다. React 는 <code class=\"language-text\">setState</code>의 콜백을 <code class=\"language-text\">ClickCounter</code> fiber 노드의 <code class=\"language-text\">updateQueue</code> 프로퍼티에 추가하고 작업 일정을 조정합니다. React 는 <code class=\"language-text\">렌더링 단계</code>에 들어갑니다. <a href=\"https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js?source=post_page---------------------------#L1132\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">renderRoot</a> 함수를 사용하여 최상위 <code class=\"language-text\">HostRoot</code> Fibre 노드에서부터 이동을 시작합니다. 그러나 작업이 완료되지 않은 노드를 찾을 때까지 이미 처리 된 fiber 노드를 벗어납니다 (건너 뜁니다). 이 시점에서 해야 할 작업이 하나만있는 Fibre 노드가 있습니다. 그것은 <code class=\"language-text\">ClickCounter</code> Fiber 노드입니다.</p>\n<p>모든 작업은 <code class=\"language-text\">alternate</code> 필드에 저장되는 이 Fiber 노드의 복제본에서 수행됩니다. alternate 노드가 아직 작성되지 않은 경우 React 는 갱신을 처리하기 전에 <code class=\"language-text\">createWorkInProgress</code> 함수에서 사본을 생성합니다. 변수 nextUnitOfWork 가 alternate <code class=\"language-text\">ClickCounter</code> Fibre 노드에 대한 참조를 보유한다고 가정 해 봅시다.</p>\n<h3 id=\"beginwork\" style=\"position:relative;\"><a href=\"#beginwork\" aria-label=\"beginwork permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>beginWork</h3>\n<p>첫째, 우리의 Fiber 는 <a href=\"https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberBeginWork.js?source=post_page---------------------------#L1489\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">beginWork</a> 함수에 들어갑니다.</p>\n<blockquote>\n<p>이 함수는 트리의 모든 Fiber 노드에 대해 실행되기 때문에 <code class=\"language-text\">렌더링 단계</code>를 디버그하려는 경우 중단 점을 넣는 것이 좋습니다. 나는 이것을 자주하고 fiber 노드의 타입을 점검하여 필요한 곳에 중단점을 고정시킵니다.</p>\n</blockquote>\n<p><code class=\"language-text\">beginWork</code> 함수는 기본적으로 tag 에 의해 Fibre 노드에 대해 수행해야하는 작업 유형을 결정한 다음 해당 함수를 실행하여 작업을 수행하는 큰 <code class=\"language-text\">switch</code> 문입니다. <code class=\"language-text\">CountClicks</code>의 경우 클래스 구성 요소이므로 이 분기가 수행됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">beginWork</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">current$$<span class=\"token number\">1</span><span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">.</span>tag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>\n        <span class=\"token keyword\">case</span> FunctionalComponent<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">case</span> ClassComponent<span class=\"token operator\">:</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token operator\">...</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">updateClassComponent</span><span class=\"token punctuation\">(</span>current$$<span class=\"token number\">1</span><span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">case</span> HostComponent<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">case</span> <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>우리는 <code class=\"language-text\">updateClassComponent</code> 함수를 사용합니다. component, 작업 재개 중 첫 번째 렌더링인지 또는 React 업데이트 인지 여부에 따라 React 는 인스턴스를 만들고 해당 component 를 mount 하거나 단순히 업데이트합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">updateClassComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> Component<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token keyword\">const</span> instance <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>stateNode<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> shouldUpdate<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>instance <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>\n        <span class=\"token comment\">// In the initial pass we might need to construct the instance.</span>\n        <span class=\"token function\">constructClassInstance</span><span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">,</span> Component<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">mountClassInstance</span><span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">,</span> Component<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        shouldUpdate <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>current <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// In a resume, we'll already have an instance we can reuse.</span>\n        shouldUpdate <span class=\"token operator\">=</span> <span class=\"token function\">resumeMountClassInstance</span><span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">,</span> Component<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        shouldUpdate <span class=\"token operator\">=</span> <span class=\"token function\">updateClassInstance</span><span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">finishClassComponent</span><span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> Component<span class=\"token punctuation\">,</span> shouldUpdate<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"processing-updates-for-the-clickcounter-fiber\" style=\"position:relative;\"><a href=\"#processing-updates-for-the-clickcounter-fiber\" aria-label=\"processing updates for the clickcounter fiber permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Processing updates for the ClickCounter Fiber</h3>\n<p>우리는 이미 <code class=\"language-text\">ClickCounter</code> 컴포넌트의 인스턴스를 가지고 있으므로 <a href=\"https://github.com/facebook/react/blob/6938dcaacbffb901df27782b7821836961a5b68d/packages/react-reconciler/src/ReactFiberClassComponent.js?source=post_page---------------------------#L976\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">updateClassInstance</code></a>로 들어갑니다. 그곳이 React 가 클래스 component 에 대한 대부분의 작업을 수행하는 곳입니다. 다음은 실행 순서대로 함수에서 수행 된 가장 중요한 연산입니다.</p>\n<ul>\n<li><code class=\"language-text\">UNSAFE_componentWillReceiveProps()</code> hook (더 이상 사용되지 않음) 호출</li>\n<li><code class=\"language-text\">updateQueue</code>에서 업데이트를 처리하고 새 상태를 생성합니다. <code class=\"language-text\">updateQueue.firstUpdate.next.payload</code> 에 들어가있는 콜백함수</li>\n<li>이 새로운 상태로 <code class=\"language-text\">getDerivedStateFromProps</code>를 호출하고 결과를 얻습니다.</li>\n<li><code class=\"language-text\">shouldComponentUpdate</code>를 호출하여 component 가 업데이트하려고하는지 확인합니다. <code class=\"language-text\">false</code>의 경우,이 컴퍼넌트와 그 아이의 렌더링을 호출하는 것을 포함 해, 모든 렌더링 처리를 스킵합니다. 그렇지 않으면 업데이트 진행합니다.</li>\n<li><code class=\"language-text\">UNSAFE_componentWillUpdate</code> 호출 (더 이상 사용되지 않음)</li>\n<li>\n<p><code class=\"language-text\">componentDidUpdate</code> 라이프 사이클 hook 트리거를 effect 에 추가합니다.</p>\n<ul>\n<li><code class=\"language-text\">componentDidUpdate</code>를 호출하는 효과는 <code class=\"language-text\">렌더링 단계</code>에서 추가되지만 메서드는 다음 <code class=\"language-text\">커밋 단계</code>에서 실행됩니다.</li>\n</ul>\n</li>\n<li>\n<p>component 인스턴스에서 <code class=\"language-text\">state</code> 및 <code class=\"language-text\">props</code> 을 업데이트합니다.</p>\n<ul>\n<li><code class=\"language-text\">render</code> 메서드 output 은 대개 <code class=\"language-text\">state</code> 및 <code class=\"language-text\">props</code>에 따라 다르기 때문에 <code class=\"language-text\">state</code> 및 <code class=\"language-text\">props</code> 는 <code class=\"language-text\">render</code> 메서드가 호출되기 전에 component 인스턴스에서 업데이트해야합니다. 우리가 그렇게하지 않으면, 매번 동일한 출력을 반환 할 것입니다.</li>\n</ul>\n</li>\n</ul>\n<p>다음은 함수로 단순화 시킨 버전입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">updateClassInstance</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> ctor<span class=\"token punctuation\">,</span> newProps<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> instance <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>stateNode<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> oldProps <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>memoizedProps<span class=\"token punctuation\">;</span>\n    instance<span class=\"token punctuation\">.</span>props <span class=\"token operator\">=</span> oldProps<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>oldProps <span class=\"token operator\">!==</span> newProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">callComponentWillReceiveProps</span><span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">,</span> instance<span class=\"token punctuation\">,</span> newProps<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// updateQueue.firstUpdate.next.payload</span>\n    <span class=\"token keyword\">let</span> updateQueue <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>updateQueue<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>updateQueue <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">processUpdateQueue</span><span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">,</span> updateQueue<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        newState <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>memoizedState<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">applyDerivedStateFromProps</span><span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    newState <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>memoizedState<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> shouldUpdate <span class=\"token operator\">=</span> <span class=\"token function\">checkShouldComponentUpdate</span><span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">,</span> ctor<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>shouldUpdate<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        instance<span class=\"token punctuation\">.</span><span class=\"token function\">componentWillUpdate</span><span class=\"token punctuation\">(</span>newProps<span class=\"token punctuation\">,</span> newState<span class=\"token punctuation\">,</span> nextContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        workInProgress<span class=\"token punctuation\">.</span>effectTag <span class=\"token operator\">|=</span> Update<span class=\"token punctuation\">;</span>\n        workInProgress<span class=\"token punctuation\">.</span>effectTag <span class=\"token operator\">|=</span> Snapshot<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    instance<span class=\"token punctuation\">.</span>props <span class=\"token operator\">=</span> newProps<span class=\"token punctuation\">;</span>\n    instance<span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> newState<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> shouldUpdate<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위의 스니펫에서 일부 보조 코드를 제거했습니다.\n예를 들어 lifecycle 메서드를 호출하거나 트리거하기 위해 effect 에 추가하기 전에 React 는 <code class=\"language-text\">typeof</code> 연산자를 사용하여 component 가 메서드를 구현되었는지 확인합니다.\n예를 들어, React 가 effect 를 추가하기 전에 <code class=\"language-text\">componentDidUpdate</code> 메소드를 검사하는 방법은 다음과 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> instance<span class=\"token punctuation\">.</span>componentDidUpdate <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  workInProgress<span class=\"token punctuation\">.</span>effectTag <span class=\"token operator\">|=</span> Update\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이제는 <code class=\"language-text\">렌더링 단계</code>에서 <code class=\"language-text\">ClickCounter</code> Fiber 노드에 대해 어떤 작업이 수행되는지 알았습니다.\n이제 이러한 작업이 fiber 노드에서 값을 변경하는 방법을 살펴 보겠습니다.\nReact 가 시작되면 <code class=\"language-text\">ClickCounter</code> component 의 Fibre 노드는 다음과 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n    effectTag<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    elementType<span class=\"token operator\">:</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ClickCounter</span><span class=\"token punctuation\">,</span>\n    firstEffect<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n    memoizedState<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token operator\">:</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ClickCounter</span><span class=\"token punctuation\">,</span>\n    stateNode<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// instance</span>\n        state<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    updateQueue<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        baseState<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        firstUpdate<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            next<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function-variable function\">payload</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>…<span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>작업이 완료되면 다음과 같은 Fiber 노드가 생깁니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n    effectTag<span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 변경 Update</span>\n    elementType<span class=\"token operator\">:</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ClickCounter</span><span class=\"token punctuation\">,</span>\n    firstEffect<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n    memoizedState<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 변경</span>\n    type<span class=\"token operator\">:</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ClickCounter</span><span class=\"token punctuation\">,</span>\n    stateNode<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// instance</span>\n        state<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span> <span class=\"token comment\">// 변경</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    updateQueue<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        baseState<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 변경</span>\n        firstUpdate<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n        <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>잠시 시간을내어 프로퍼티 값의 차이점을 관찰하십시오.</strong></p>\n<p>업데이트가 적용되면 <code class=\"language-text\">memoizedState</code> 및 <code class=\"language-text\">updateQueue</code>의 <code class=\"language-text\">baseState</code>에서 속성 수의 값이 1 로 변경됩니다. React 는 또한 <code class=\"language-text\">ClickCounter</code> component 인스턴스의 상태를 업데이트했습니다.\n이 시점에서 큐에 더 이상 업데이트가 없으므로 <code class=\"language-text\">firstUpdate</code>는 null 입니다.</p>\n<p>그리고 중요하게도 우리는 <code class=\"language-text\">effectTag</code> 속성을 변경했습니다. 그것은 더 이상 <code class=\"language-text\">0</code>이 아니며, 값은 <code class=\"language-text\">4</code>입니다. 이진수에서는 <code class=\"language-text\">100</code>입니다. 이는 세 번째 비트가 설정됨을 의미합니다. 이는 <code class=\"language-text\">Update</code> <a href=\"https://github.com/facebook/react/blob/b87aabdfe1b7461e7331abb3601d9e6bb27544bc/packages/shared/ReactSideEffectTags.js?source=post_page---------------------------\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">side-effect tag</code></a>의 비트입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> Update <span class=\"token operator\">=</span> <span class=\"token number\">0b00000000100</span></code></pre></div>\n<p>결론적으로 부모 <code class=\"language-text\">ClickCounter</code> Fibre 노드에서 작업 할 때 React 는 사전 변이(pre-mutation) 생명주기 메소드를 호출하고 state 를 업데이트하고 관련 부작용(side-effects)을 정의합니다.</p>\n<h3 id=\"reconciling-children-for-the-clickcounter-fiber\" style=\"position:relative;\"><a href=\"#reconciling-children-for-the-clickcounter-fiber\" aria-label=\"reconciling children for the clickcounter fiber permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reconciling children for the ClickCounter Fiber</h3>\n<p>완료되면 React 가 <a href=\"https://github.com/facebook/react/blob/340bfd9393e8173adca5380e6587e1ea1a23cefa/packages/react-reconciler/src/ReactFiberBeginWork.js?source=post_page---------------------------#L355\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">finishClassComponent</code></a>로 들어갑니다. 여기서 React 는 컴포넌트 인스턴스의 <code class=\"language-text\">render</code> 메소드를 호출하고 해당 diffing 알고리즘을 component 가 리턴 한 children 에 적용합니다. 고급 개요는 문서에 설명되어 있습니다. <a href=\"https://reactjs.org/docs/reconciliation.html?source=post_page---------------------------#the-diffing-algorithm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">다음</a>은 관련 부분입니다.</p>\n<blockquote>\n<p>같은 유형의 두 개의 React DOM 요소를 비교할 때 React 는 두 속성을 보고 동일한 기본 DOM 노드를 유지하고 변경된 속성 만 업데이트합니다.</p>\n</blockquote>\n<p>그러나 우리가 더 깊이 파고 들면 실제로 Fiber 노드와 React elements 를 비교한다는 것을 알 수 있습니다. 그러나 프로세스가 매우 정교하기 때문에 지금은 자세하게 설명하지 않겠습니다. 나는 child reconciliation 의 과정에 초점을 둔 별도의 글을 쓸 것입니다.</p>\n<blockquote>\n<p>스스로 세부 사항을 배우고 싶다면 <a href=\"https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactChildFiber.js?source=post_page---------------------------#L732\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">reconcileChildrenArray</a> 함수를 확인하십시오. 우리의 어플리케이션에서는 <code class=\"language-text\">render</code> 메소드가 React 요소의 배열을 반환하기 때문에 <code class=\"language-text\">reconcileChildrenArray</code> 함수를 확인하십시오.</p>\n</blockquote>\n<p>이 시점에서 이해해야 할 중요한 두 가지가 있습니다. <strong>먼저</strong>, React 가 child reconciliation 를 진행할 때 <code class=\"language-text\">render</code> 메소드에서 반환 된 <strong>child React elements 에 대한 Fibre 노드를 만들거나 업데이트 해야합니다.</strong> <code class=\"language-text\">finishClassComponent</code> 함수는 현재 Fibre 노드의 <code class=\"language-text\">첫 번째 자식에 대한 참조</code>를 반환합니다. <code class=\"language-text\">nextUnitOfWork</code>에 할당되고 나중에 작업 루프(work loop)에서 처리됩니다. <strong>둘째</strong>, React 는 parent 에 대한 수행 한 작업의 일부로 <strong>children 의 props 을 업데이트</strong>합니다. 이를 위해 <code class=\"language-text\">render</code> 메소드에서 반환 된 React 요소의 데이터를 사용합니다.</p>\n<p>예를 들어, React 가 <code class=\"language-text\">ClickCounter</code> fiber 에 대한 children 을 reconciles 하기 전에 <code class=\"language-text\">span</code> 요소에 해당하는 Fibre 노드가 다음과 같이 표시됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n    stateNode<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HTMLSpanElement</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token operator\">:</span> <span class=\"token string\">\"span\"</span><span class=\"token punctuation\">,</span>\n    key<span class=\"token operator\">:</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span>\n    memoizedProps<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>children<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    pendingProps<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>children<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>보시다시피, <code class=\"language-text\">memoizedProps</code> 및 <code class=\"language-text\">pendingProps</code>의 <code class=\"language-text\">children</code> 속성은 모두 <code class=\"language-text\">0</code>입니다. 여기에 <code class=\"language-text\">span</code> 요소에 대한 <code class=\"language-text\">render</code> 에서 반환 된 React 요소의 구조가 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ClickCounter 의 render 메서드 호출 후에 리턴된 span element</span>\n<span class=\"token punctuation\">{</span>\n  $$<span class=\"token keyword\">typeof</span><span class=\"token operator\">:</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span>react<span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">)</span>\n  key<span class=\"token operator\">:</span> <span class=\"token string\">'2'</span>\n  props<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    children<span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token punctuation\">}</span>\n  ref<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span>\n  type<span class=\"token operator\">:</span> <span class=\"token string\">'span'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>보시다시피, <strong>Fibre 노드의 props 과 반환 된 React element 에는 차이점이 있습니다.</strong> alternate fiber 노드를 만드는 데 사용되는 <code class=\"language-text\">createWorkInProgress</code> 함수에서 <strong>React 는 React element 에서 업데이트 된 프로퍼티를 fiber 노드로 복사합니다.</strong></p>\n<p>따라서 React 가 <code class=\"language-text\">ClickCounter</code> component 에 대한 children 을 reconciling 한 후에는 <code class=\"language-text\">span</code> Fiber 노드에 <code class=\"language-text\">pendingProps</code>가 업데이트됩니다. 그들은 React 요소의 값과 일치합니다 :</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n    stateNode<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HTMLSpanElement</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token operator\">:</span> <span class=\"token string\">\"span\"</span><span class=\"token punctuation\">,</span>\n    key<span class=\"token operator\">:</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span>\n    memoizedProps<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>children<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    pendingProps<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>children<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 업데이트</span>\n    <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>나중에 React 가 <code class=\"language-text\">span</code> fiber 노드에 대한 작업을 수행 할 때 그것들을 <code class=\"language-text\">memoizedProps</code>에 복사하고 DOM 을 업데이트하기 위해 effects 를 추가합니다.</p>\n<p>React 가 렌더링 단계에서 <code class=\"language-text\">ClickCounter</code> fiber 노드에 대해 수행하는 모든 작업이 그것입니다. 버튼은 <code class=\"language-text\">ClickCounter</code> component 의 첫 번째 자식이므로 <code class=\"language-text\">nextUnitOfWork</code> 변수에 할당됩니다. 그걸로 끝내야 할 것이 없으므로, React 는 Fibre 노드의 형제로 이동할 것입니다. <a href=\"https://medium.com/react-in-depth/inside-fiber-in-depth-overview-of-the-new-reconciliation-algorithm-in-react-e1c04700ef6e?source=post_page---------------------------\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">여기</a>에 설명 된 알고리즘에 따르면 노드의 형제 이동 로직은 <code class=\"language-text\">completeUnitOfWork</code> 함수에서 발생합니다.</p>\n<p>여기서 <code class=\"language-text\">button</code> 컴포넌트는 <code class=\"language-text\">beginWork()</code> 수행 후 별도의 자식이 없으므로 null 이 리턴될 것이다.\nnull 이 리턴되면 곧바로 <code class=\"language-text\">completeUnitOfWork</code> 메서드로 들어가서 <code class=\"language-text\">completeWork</code> 메서드를 진행하게 된다.\n그 후에 <code class=\"language-text\">sibling</code> 을 리턴하는데 그것이 <code class=\"language-text\">span</code> 태그이다.</p>\n<h3 id=\"processing-updates-for-the-span-fiber\" style=\"position:relative;\"><a href=\"#processing-updates-for-the-span-fiber\" aria-label=\"processing updates for the span fiber permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Processing updates for the Span fiber</h3>\n<p>그래서 변수 <code class=\"language-text\">nextUnitOfWork</code>는 <code class=\"language-text\">span</code> fiber 의 alternate 을 가리키고 React 가 작업을 시작합니다. <code class=\"language-text\">ClickCounter</code>에 대해 수행 된 단계와 유사하게 <code class=\"language-text\">beginWork</code> 함수로 시작합니다.</p>\n<p><code class=\"language-text\">span</code> 노드가 <code class=\"language-text\">HostComponent</code> 타입이기 때문에, 이번에는 switch 문에서 React 가이 분기를 취합니다 :</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">beginWork</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">current$$<span class=\"token number\">1</span><span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">.</span>tag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">case</span> FunctionalComponent<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">case</span> ClassComponent<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">case</span> HostComponent<span class=\"token operator\">:</span>\n          <span class=\"token keyword\">return</span> <span class=\"token function\">updateHostComponent</span><span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">case</span> <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberBeginWork.js?source=post_page---------------------------#L686\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">updateHostComponent</code></a> 함수에서 끝납니다. 클래스 구성 요소에 대해 호출 된 <code class=\"language-text\">updateClassComponent</code> 함수와의 병렬을 볼 수 있습니다. functional component 의 경우 <code class=\"language-text\">updateFunctionComponent</code> 가됩니다. 이러한 모든 기능은 <a href=\"https://github.com/facebook/react/blob/1034e26fe5e42ba07492a736da7bdf5bf2108bc6/packages/react-reconciler/src/ReactFiberBeginWork.js?source=post_page---------------------------\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">ReactFiberBeginWork.js</code></a> 파일에서 찾을 수 있습니다.</p>\n<h3 id=\"reconciling-children-for-the-span-fiber\" style=\"position:relative;\"><a href=\"#reconciling-children-for-the-span-fiber\" aria-label=\"reconciling children for the span fiber permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reconciling children for the span fiber</h3>\n<p>여기서는 <code class=\"language-text\">updateHostComponent</code>의 <code class=\"language-text\">span</code> 노드에 아무런 중요한 일도 일어나지 않습니다.</p>\n<h3 id=\"completing-work-for-the-span-fiber-node\" style=\"position:relative;\"><a href=\"#completing-work-for-the-span-fiber-node\" aria-label=\"completing work for the span fiber node permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Completing work for the Span Fiber node</h3>\n<p><code class=\"language-text\">beginWork</code> 가 끝나면 노드는 <code class=\"language-text\">completeWork</code> 함수로 들어갑니다. 하지만 그 전에 React 는 span fiber 에 <code class=\"language-text\">memoizedProps</code>을 업데이트 해야합니다. <code class=\"language-text\">ClickCounter</code> 구성 요소에 대해 자식을 reconciling 할 때 React span fibre 노드의 <code class=\"language-text\">pendingProps</code>가 업데이트 되었음을 ​​ 기억할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n    stateNode<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HTMLSpanElement</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token operator\">:</span> <span class=\"token string\">\"span\"</span><span class=\"token punctuation\">,</span>\n    key<span class=\"token operator\">:</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span>\n    memoizedProps<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>children<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    pendingProps<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>children<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>따라서 <code class=\"language-text\">beginWork</code> 가 span fiber 에 대해 완료되면 React <code class=\"language-text\">pendingProps</code> 가 <code class=\"language-text\">memoizedProps</code> 와 일치합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">performUnitOfWork</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">workInProgress</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n    next <span class=\"token operator\">=</span> <span class=\"token function\">beginWork</span><span class=\"token punctuation\">(</span>current$$<span class=\"token number\">1</span><span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> nextRenderExpirationTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    workInProgress<span class=\"token punctuation\">.</span>memoizedProps <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>pendingProps<span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그런 다음 기본적으로 <code class=\"language-text\">beginWork</code> 에서 본 것과 비슷한 switch 문인 <code class=\"language-text\">completeWork</code> 함수를 호출합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">completeWork</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">.</span>tag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">case</span> FunctionComponent<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">case</span> ClassComponent<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">case</span> HostComponent<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token operator\">...</span>\n            <span class=\"token function\">updateHostComponent</span><span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">case</span> <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>우리의 span Fibre 노드는 HostComponent 이므로 <code class=\"language-text\">updateHostComponent</code> 함수를 실행합니다. 이 함수에서 React 는 기본적으로 다음을 수행합니다.</p>\n<ul>\n<li>DOM 업데이트를 준비합니다.</li>\n<li>span fiber 의 updateQueue 에 그것들을 추가한다.</li>\n<li>DOM 을 업데이트하는 effect 추가</li>\n</ul>\n<p>이러한 작업을 수행하기 전에 span fiber 노드는 다음과 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n    stateNode<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HTMLSpanElement</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token operator\">:</span> <span class=\"token string\">\"span\"</span><span class=\"token punctuation\">,</span>\n    effectTag<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n    updateQueue<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span>\n    <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>작업이 완료되면 다음과 같이 보입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n    stateNode<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HTMLSpanElement</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token operator\">:</span> <span class=\"token string\">\"span\"</span><span class=\"token punctuation\">,</span>\n    effectTag<span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// update</span>\n    updateQueue<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"children\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">effectTag</code> 및 <code class=\"language-text\">updateQueue</code> 필드의 차이점을 확인하십시오. 그것은 더 이상 <code class=\"language-text\">0</code>이 아니며, 값은 <code class=\"language-text\">4</code>입니다. 이진수에서는 <code class=\"language-text\">100</code>입니다. 이는 세 번째 비트가 설정됨을 의미합니다. 이는 업데이트 side-effect tag 의 비트입니다. 이것은 다음 <code class=\"language-text\">커밋 단계</code>에서 React 가 이 노드에 대해 수행해야하는 유일한 작업입니다. <code class=\"language-text\">updateQueue</code> 필드는 업데이트에 사용될 페이로드를 보유합니다.</p>\n<p>React 가 <code class=\"language-text\">ClickCounter</code> 와 그 children 을 처리하면 <code class=\"language-text\">렌더링 단계</code>가 완료됩니다. 완성 된 대체 트리를 <code class=\"language-text\">FiberRoot</code> 의 <code class=\"language-text\">finishedWork</code> 속성에 할당 할 수 있습니다. 이것은 새로운 tree 가 화면에 뿌려져야 합니다. <code class=\"language-text\">렌더링 단계</code> 직후에 바로 처리하거나 나중에 React 가 브라우저에 의해 주어진 시간에 선택 될 수 있습니다.</p>\n<h3 id=\"effects-list\" style=\"position:relative;\"><a href=\"#effects-list\" aria-label=\"effects list permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Effects list</h3>\n<p>우리의 경우 <code class=\"language-text\">span</code> 노드와 <code class=\"language-text\">ClickCounter</code> 컴포넌트는 side effects 가 있으므로 React 는 <code class=\"language-text\">Span</code> Fiber 노드에 대한 링크를 <code class=\"language-text\">HostFiber</code> 의 <code class=\"language-text\">firstEffect</code> 속성에 추가합니다.\nReact 는 <a href=\"https://github.com/facebook/react/blob/d5e1bf07d086e4fc1998653331adecddcd0f5274/packages/react-reconciler/src/ReactFiberScheduler.js?source=post_page---------------------------#L999\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">completeUnitOfWork</code></a> 함수에서 effects list 을 작성합니다. 다음은 <code class=\"language-text\">span</code> 노드의 텍스트를 업데이트의 effect 를 가진 Fiber tree 와 <code class=\"language-text\">ClickCounter</code>에서 hooks 를 호출하는 트리의 예입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 460px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/ho_blog/static/8b614849fb0fcdb5b5102ac4b5e27bf5/d5727/effect-linearList01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.91304347826086%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAAB4klEQVQoz31Sz2sTQRTev0AEr94E8e7Ziyii0IuHqqUHLxEPXgxVEamFeJCKaKka1BoQLx4MHjzUHtocNNJg7S1tMdo0SePuNia72Zmd3dkf7z1ntw3YQ/N4vBl4873H932jvV/avvOyOlnY+Nl2iSgEjJCQDg7EJNPQJvLVs9ny6Zvl+cU1rjeNesOsN3YaDbAN7JsobAwEBl6SoU//j0XUPlfMmQ+/X3zcbBmMUILHKHANvasu6DnIu+QYKrFvgPUHrDb0tsHZQSkS8N4YiFWR80/dR+fF88v9Jxfd2VHx+IJYeqPIMA/8iIAojkKKQvR5MqXb0nYpYBwpsMhf7WcOOxPHefYYu3WCZQ5Zr64zIE9IiwUA+6UIvMFmVHMpWivJhdmg9DoozclPD+XCDGxWLEEt012t2etNpnd9GAiGvKcdqGoUxNxS52Rh/Uy2PPZgZeTu8ujUd+6FCTIKoFPfD1b7FXmVKYvY0kmYuXe1kdtfMtMrV6aWx3MV7qkWxp0tlK42xNCkWG2l/EaHvtVkVYemTXEcwd8tZUTiMw2LlNuPIn2dY4sFKL+l1SKYv5Tzu92h4NQ/5VlvTHPunbSvHbFvHE2cHwg8FJy+8Iv3ee6Umx/n0+fEs0vK5L1PSvQP6O+F/yCtUyYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"effect-linearList01\"\n        title=\"effect-linearList01\"\n        src=\"/ho_blog/static/8b614849fb0fcdb5b5102ac4b5e27bf5/d5727/effect-linearList01.png\"\n        srcset=\"/ho_blog/static/8b614849fb0fcdb5b5102ac4b5e27bf5/00d96/effect-linearList01.png 148w,\n/ho_blog/static/8b614849fb0fcdb5b5102ac4b5e27bf5/0b23c/effect-linearList01.png 295w,\n/ho_blog/static/8b614849fb0fcdb5b5102ac4b5e27bf5/d5727/effect-linearList01.png 460w\"\n        sizes=\"(max-width: 460px) 100vw, 460px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>다음은 효과가있는 노드의 선형 목록입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 529px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/ho_blog/static/def4fa8ffdc9665b60f924eb7b3f0aa5/d78a9/effect-linearList02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.76937618147448%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAA7UlEQVQI12P4////79+/799/cPnK5Rs3bn769Bko8u/fPzj55s3rG9evX758+dGjR/9RAcOxK2+vPfj088f3z58+fvvx89fbp7+v7ft9/cDvK3uB5J+bh358fv/py7cvX799/fTx941Dv6/u/X11H5jcy2Cffyip4+z3n/++fP315f//TweXvg9l+Jgp+qlM80Myz4d4tj93T/7/8/P/zy9/X97+kCbwqUjlU4n6xwKFT8WqDIVTLvWtugN0w98/v0FeuLb/c5vz18nhX2clfekL+NLr9/f1A4gj/315+2Vi6NepUV+nx36dFgNEAGJ7xAftZoqqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"effect-linearList02\"\n        title=\"effect-linearList02\"\n        src=\"/ho_blog/static/def4fa8ffdc9665b60f924eb7b3f0aa5/d78a9/effect-linearList02.png\"\n        srcset=\"/ho_blog/static/def4fa8ffdc9665b60f924eb7b3f0aa5/00d96/effect-linearList02.png 148w,\n/ho_blog/static/def4fa8ffdc9665b60f924eb7b3f0aa5/0b23c/effect-linearList02.png 295w,\n/ho_blog/static/def4fa8ffdc9665b60f924eb7b3f0aa5/d78a9/effect-linearList02.png 529w\"\n        sizes=\"(max-width: 529px) 100vw, 529px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"commit-phase\" style=\"position:relative;\"><a href=\"#commit-phase\" aria-label=\"commit phase permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Commit phase</h2>\n<p>이 단계는 <a href=\"https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js?source=post_page---------------------------#L2306\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">completeRoot</code></a> 함수로 시작합니다. 작업을하기 전에 <code class=\"language-text\">FiberRoot</code> 의 <code class=\"language-text\">finishedWork</code> 속성을 <code class=\"language-text\">null</code> 로 설정합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">root.finishedWork = null;</code></pre></div>\n<p>첫 번째 <code class=\"language-text\">렌더링 단계</code>와 달리 <code class=\"language-text\">커밋 단계</code>는 항상 동기식이므로 <code class=\"language-text\">HostRoot</code>를 안전하게 업데이트하여 커밋 작업이 시작되었음을 나타낼 수 있습니다.</p>\n<p>커밋 단계에서는 React 가 DOM 을 업데이트하고 post mutation lifecycle 메서드 인 <code class=\"language-text\">componentDidUpdate</code> 를 호출합니다. 이를 위해 이전 <code class=\"language-text\">렌더링 단계</code>에서 생성 한 effects list 을 검토하고 적용합니다.</p>\n<p>우리는 <code class=\"language-text\">span</code> 및 <code class=\"language-text\">ClickCounter</code> 노드의 <code class=\"language-text\">렌더링 단계</code>에서 다음과 같은 effect 를 정의했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> ClickCounter<span class=\"token punctuation\">,</span> effectTag<span class=\"token operator\">:</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'span'</span><span class=\"token punctuation\">,</span> effectTag<span class=\"token operator\">:</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">ClickCounter</code> 의 효과 태그 값은 <code class=\"language-text\">5</code> 또는 2 진수로 <code class=\"language-text\">101</code>이며 클래스 구성 요소의 경우 기본적으로 <code class=\"language-text\">componentDidUpdate</code> 라이프 사이클 메소드로 변환되는 업데이트 작업을 정의합니다. 또한 최하위 비트는 렌더링 단계에서이 fiber 노드에 대한 모든 작업이 완료되었음을 알리기 위해 설정됩니다.\n<code class=\"language-text\">span</code> 에 대한 효과 태그의 값은 <code class=\"language-text\">4</code> 또는 2 진수로 <code class=\"language-text\">100</code>이며 host component DOM 업데이트의 <code class=\"language-text\">update</code> 작업을 정의합니다. <code class=\"language-text\">span</code> 요소의 경우, React 는 요소의 <code class=\"language-text\">textContent</code>를 업데이트해야합니다.</p>\n<h3 id=\"applying-effects\" style=\"position:relative;\"><a href=\"#applying-effects\" aria-label=\"applying effects permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Applying effects</h3>\n<p>React 가 어떻게 그 effects 를 적용하는지 봅시다. effects 를 적용하는 데 사용되는 <code class=\"language-text\">commitRoot</code> 함수는 세 가지 하위 함수로 구성됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">commitRoot</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">root<span class=\"token punctuation\">,</span> finishedWork</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">commitBeforeMutationLifecycles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">commitAllHostEffects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  root<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> finishedWork\n  <span class=\"token function\">commitAllLifeCycles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>각 하위 함수는 effects list 을 반복하고 effects 타입을 확인하는 루프를 구현합니다. 함수의 목적과 관련된 effect 를 발견하면 적용합니다. 여기서는 <code class=\"language-text\">ClickCounter</code> 구성 요소에서 <code class=\"language-text\">componentDidUpdate</code> 라이프 사이클 메서드를 호출하고 <code class=\"language-text\">span</code> 요소의 텍스트를 업데이트합니다.\n첫 번째 함수 인 <a href=\"https://github.com/facebook/react/blob/fefa1269e2a67fa5ef0992d5cc1d6114b7948b7e/packages/react-reconciler/src/ReactFiberCommitWork.js?source=post_page---------------------------#L183\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">commitBeforeMutationLifeCycles</code></a> 는 <code class=\"language-text\">Snapshot</code> effect 를 찾고 <code class=\"language-text\">getSnapshotBeforeUpdate</code> 메서드를 호출합니다. 그러나 <code class=\"language-text\">ClickCounter</code> 구성 요소에 이 메서드를 구현하지 않았으므로 React 는 렌더링 단계에서 effect 를 추가하지 않았습니다. 그래서 우리의 경우이 함수는 아무 것도하지 않습니다.</p>\n<h3 id=\"dom-updates\" style=\"position:relative;\"><a href=\"#dom-updates\" aria-label=\"dom updates permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DOM updates</h3>\n<p>다음 React 는 <code class=\"language-text\">commitAllHostEffects</code> 함수로 이동한다. 여기서 React 가 <code class=\"language-text\">span</code> 요소의 텍스트를 <code class=\"language-text\">0</code>에서 <code class=\"language-text\">1</code>로 변경합니다. 클래스 구성 요소에 해당하는 노드에 DOM 업데이트가 없으므로 <code class=\"language-text\">ClickCounter</code> fiber 에는 아무 작업도 수행되지 않습니다.\n함수의 요지는 올바른 effect 의 타입를 선택하고 해당 작업을 적용한다는 것입니다. 여기서는 <code class=\"language-text\">span</code> 요소의 텍스트를 업데이트 해야하므로 여기에서 <code class=\"language-text\">Update</code> 분기를 가져옵니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">updateHostEffects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>primaryEffectTag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">case</span> Placement<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">case</span> PlacementAndUpdate<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">case</span> Update<span class=\"token operator\">:</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">var</span> current <span class=\"token operator\">=</span> nextEffect<span class=\"token punctuation\">.</span>alternate<span class=\"token punctuation\">;</span>\n          <span class=\"token function\">commitWork</span><span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">,</span> nextEffect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">case</span> Deletion<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">commitWork</code> 로 이동하면 결국 <code class=\"language-text\">updateDOMProperties</code> 함수로 들어간다. 렌더 단계 동안 Fibre 노드에 추가 된 <code class=\"language-text\">updateQueue</code> 페이로드를 가져 와서 <code class=\"language-text\">span</code> 요소의 <code class=\"language-text\">textContent</code> 속성을 업데이트합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">updateDOMProperties</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">domElement<span class=\"token punctuation\">,</span> updatePayload<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> updatePayload<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// updateQueue: [\"children\", \"1\"],</span>\n    <span class=\"token keyword\">const</span> propKey <span class=\"token operator\">=</span> updatePayload<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> propValue <span class=\"token operator\">=</span> updatePayload<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>propKey <span class=\"token operator\">===</span> <span class=\"token constant\">STYLE</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>propKey <span class=\"token operator\">===</span> <span class=\"token constant\">DANGEROUSLY_SET_INNER_HTML</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>propKey <span class=\"token operator\">===</span> <span class=\"token constant\">CHILDREN</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setTextContent</span><span class=\"token punctuation\">(</span>domElement<span class=\"token punctuation\">,</span> propValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>DOM 업데이트가 적용된 후 React 는 <code class=\"language-text\">finishedWork</code> 트리를 <code class=\"language-text\">HostRoot</code> 에 할당합니다. alternate 트리를 현재(current)로 설정합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">root<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> finishedWork</code></pre></div>\n<h3 id=\"calling-post-mutation-lifecycle-hooks\" style=\"position:relative;\"><a href=\"#calling-post-mutation-lifecycle-hooks\" aria-label=\"calling post mutation lifecycle hooks permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Calling post mutation lifecycle hooks</h3>\n<p>마지막 남은 기능은 <a href=\"https://github.com/facebook/react/blob/d5e1bf07d086e4fc1998653331adecddcd0f5274/packages/react-reconciler/src/ReactFiberScheduler.js?source=post_page---------------------------#L479\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">commitAllLifecycles</code></a> 입니다. 여기서 React 는 post mutational lifecycle methods 를 호출합니다. 렌더링 단계에서 React 는 <code class=\"language-text\">Update</code> effect 를 ClickCounter 구성 요소에 추가했습니다. 이것은 <code class=\"language-text\">commitAllLifecycles</code> 함수가 찾고 <code class=\"language-text\">componentDidUpdate</code> 메서드를 호출하는 effects 중 하나입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">commitAllLifeCycles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">finishedRoot<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>nextEffect <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> effectTag <span class=\"token operator\">=</span> nextEffect<span class=\"token punctuation\">.</span>effectTag<span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effectTag <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>Update <span class=\"token operator\">|</span> Callback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">const</span> current <span class=\"token operator\">=</span> nextEffect<span class=\"token punctuation\">.</span>alternate<span class=\"token punctuation\">;</span>\n            <span class=\"token function\">commitLifeCycles</span><span class=\"token punctuation\">(</span>finishedRoot<span class=\"token punctuation\">,</span> current<span class=\"token punctuation\">,</span> nextEffect<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effectTag <span class=\"token operator\">&amp;</span> Ref<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">commitAttachRef</span><span class=\"token punctuation\">(</span>nextEffect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        nextEffect <span class=\"token operator\">=</span> nextEffect<span class=\"token punctuation\">.</span>nextEffect<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>함수는 또한 <a href=\"https://reactjs.org/docs/refs-and-the-dom.html?source=post_page---------------------------\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">refs</a>를 업데이트하지만, 우리는 이 기능을 가지고 있지 않기 때문에 사용되지 않을 것이다. 이 메소드는 <a href=\"https://github.com/facebook/react/blob/e58ecda9a2381735f2c326ee99a1ffa6486321ab/packages/react-reconciler/src/ReactFiberCommitWork.js?source=post_page---------------------------#L351\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">commitLifeCycles</code></a> 함수에서 호출됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">commitLifeCycles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">finishedRoot<span class=\"token punctuation\">,</span> current<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>finishedWork<span class=\"token punctuation\">.</span>tag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> FunctionComponent<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">case</span> ClassComponent<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> instance <span class=\"token operator\">=</span> finishedWork<span class=\"token punctuation\">.</span>stateNode<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>finishedWork<span class=\"token punctuation\">.</span>effectTag <span class=\"token operator\">&amp;</span> Update<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>current <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          instance<span class=\"token punctuation\">.</span><span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token operator\">...</span>\n          instance<span class=\"token punctuation\">.</span><span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">,</span> prevState<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">case</span> HostComponent<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">case</span> <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>React 가 처음 렌더링 된 구성 요소에 대해 <code class=\"language-text\">componentDidMount</code> 메소드를 호출하는 함수임을 알 수 있습니다.\n그리고 그게 다야!</p>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<h3 id=\"render-phase-1\" style=\"position:relative;\"><a href=\"#render-phase-1\" aria-label=\"render phase 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Render Phase</h3>\n<ul>\n<li>commit phase 작업을 해야할 effect 목록(선형)을 만들기 위해 fiber node를 작업한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">performUnitOfWork</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">workInProgress</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// children에 대한 포인터 또는 null</span>\n  <span class=\"token keyword\">let</span> next <span class=\"token operator\">=</span> <span class=\"token function\">beginWork</span><span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>next <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 더 이상의 자식이 없을때 completeUnitOfWork -> completeWork를 수행</span>\n    <span class=\"token comment\">// completeUnitOfWork는 sibling이 있을때 return sibling 후 다시 beginWork 진행</span>\n    <span class=\"token comment\">// sibling도 없을 시에 부모로 올라가서 completeUnitOfWork 내부에 있는 completeWork를 수행</span>\n    next <span class=\"token operator\">=</span> <span class=\"token function\">completeUnitOfWork</span><span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> next\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>위 <code class=\"language-text\">performUnitOfWork</code> 를 while 하면서 fiber를 순차적으로 적용한다. </li>\n<li>\n<p><code class=\"language-text\">beginWork()</code> 부터 시작. 여기선 컴포넌트의 타입에 따라 component를 update 진행한다. </p>\n<ul>\n<li>클래스 컴포넌트의 경우에는 <code class=\"language-text\">updateClassComponent()</code> 다음 메서드 실행, 인스턴스를 create 또는 update를 진행한다. 특히 update시 fiber node를 가지고 instance를 update한다.</li>\n<li><code class=\"language-text\">finishClassComponent()</code> 여기서는 children들의 reconciliation을 진행한다. 즉, 부모의 render 이후 React element와 이전의 fiber node를 비교 후 fiber node를 업데이트 한다. </li>\n<li><code class=\"language-text\">finishClassComponent()</code> 이후에 <code class=\"language-text\">beginWork()</code> 리턴으로는 child가 있을 경우 첫번째 child 가 리턴 아닐 경우 null 이 리턴</li>\n</ul>\n</li>\n<li>첫번째 child인 button 을 다시 <code class=\"language-text\">beginWork()</code> -> child가 없기 때문에 바로 null 리턴,  <code class=\"language-text\">completeUnitOfWork()</code> 진행 후 completeWork() 진행. </li>\n<li><code class=\"language-text\">span</code> 태그의 sibling 확인 (<code class=\"language-text\">completeUnitOfWork()</code> 메서드에서 수행)</li>\n<li><code class=\"language-text\">span</code> 태그의 <code class=\"language-text\">beginWork()</code> 수행 후, null 리턴, <code class=\"language-text\">completeUnitOfWork()</code> 진행 후 <code class=\"language-text\">completeWork()</code> 진행. </li>\n<li><code class=\"language-text\">span</code> 태그의 <code class=\"language-text\">completeWork()</code> 진행 시, <code class=\"language-text\">span</code> fiber의 <code class=\"language-text\">effectTag</code> 와 <code class=\"language-text\">updateQueue</code> 를 업데이트 진행. </li>\n<li>effects list를 구성해서 <code class=\"language-text\">commit phase</code>로 넘김 ( root -> span -> ClickCounter )</li>\n</ul>","excerpt":"이글을 번역 및 분석 한 글입니다. 잘못된 번역 및 생략된 번역이 있을 수 있습니다. In-depth explanation of state and props update in React 이전 기사 인 Inside Fiber: in-depth…","tableOfContents":"<ul>\n<li>\n<p><a href=\"/ho_blog/react-fiber03/#in-depth-explanation-of-state-and-props-update-in-react\">In-depth explanation of state and props update in React</a></p>\n<ul>\n<li>\n<p><a href=\"/ho_blog/react-fiber03/#render-phase\">Render phase</a></p>\n<ul>\n<li><a href=\"/ho_blog/react-fiber03/#scheduling-updates\">Scheduling updates</a></li>\n<li><a href=\"/ho_blog/react-fiber03/#processing-updates-for-the-clickcounter-fiber-node\">Processing updates for the ClickCounter Fiber node</a></li>\n<li><a href=\"/ho_blog/react-fiber03/#beginwork\">beginWork</a></li>\n<li><a href=\"/ho_blog/react-fiber03/#processing-updates-for-the-clickcounter-fiber\">Processing updates for the ClickCounter Fiber</a></li>\n<li><a href=\"/ho_blog/react-fiber03/#reconciling-children-for-the-clickcounter-fiber\">Reconciling children for the ClickCounter Fiber</a></li>\n<li><a href=\"/ho_blog/react-fiber03/#processing-updates-for-the-span-fiber\">Processing updates for the Span fiber</a></li>\n<li><a href=\"/ho_blog/react-fiber03/#reconciling-children-for-the-span-fiber\">Reconciling children for the span fiber</a></li>\n<li><a href=\"/ho_blog/react-fiber03/#completing-work-for-the-span-fiber-node\">Completing work for the Span Fiber node</a></li>\n<li><a href=\"/ho_blog/react-fiber03/#effects-list\">Effects list</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/ho_blog/react-fiber03/#commit-phase\">Commit phase</a></p>\n<ul>\n<li><a href=\"/ho_blog/react-fiber03/#applying-effects\">Applying effects</a></li>\n<li><a href=\"/ho_blog/react-fiber03/#dom-updates\">DOM updates</a></li>\n<li><a href=\"/ho_blog/react-fiber03/#calling-post-mutation-lifecycle-hooks\">Calling post mutation lifecycle hooks</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/ho_blog/react-fiber03/#%EC%A0%95%EB%A6%AC\">정리</a></p>\n<ul>\n<li><a href=\"/ho_blog/react-fiber03/#render-phase-1\">Render Phase</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/react-fiber03/"},"frontmatter":{"title":"React Fiber part3","date":"Jul 22, 2019","tags":["undefined"],"keywords":["Merlin Tech Blog","Merlin.ho"],"update":"Jan 01, 0001"}}},"pageContext":{"slug":"/react-fiber03/","series":[],"lastmod":"0001-01-01"}}}