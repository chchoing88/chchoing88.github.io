{"componentChunkName":"component---src-templates-post-tsx","path":"/hello-docker.md/","result":{"data":{"markdownRemark":{"html":"<h2 id=\"docker-term\" style=\"position:relative;\"><a href=\"#docker-term\" aria-label=\"docker term permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker term</h2>\n<h3 id=\"what-is-docker\" style=\"position:relative;\"><a href=\"#what-is-docker\" aria-label=\"what is docker permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is Docker?</h3>\n<ul>\n<li>소프트웨어를 containerization(컨테이너화) 한 플랫폼. ( 웹서비스 컨테이너 , 디비 컨테이너 따로 담는다고 하면 서로 isolation 화 할수 있고 서로 독립적인 공간을 가질수 있다. 서로에게 영향을 주지 않을수 있다. )</li>\n<li>containerization 란 컨테이너를 매체로 한 수송체계, 즉. 컨테이너 규격을 맞춰 놓으면 차 , 배 , 비행기등 더 쉽고 빠르게 대량 수송과 시간을 단축 시킬수 있다. 라는 장점을 지니고 있음.</li>\n<li>이걸로 유추해볼 때 도커는 다양한 SW 들을 컨테이너에 담아 이동하기가 쉽게하고 포터블하게 만들수있는 플랫폼.</li>\n<li>리눅스의 응용프로그램들을 소프트웨어 컨테이너 안에 배치시키는 일을 자동화 하는 오픈소스</li>\n</ul>\n<h3 id=\"what-is-container\" style=\"position:relative;\"><a href=\"#what-is-container\" aria-label=\"what is container permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is Container?</h3>\n<ul>\n<li>개발 , 배포 , 운용 등을 위해 표준화된 단위로 구성된 소프트웨어 패키지화</li>\n<li>호스트 pc 의 커널을 공유하면서 SW 가 돌아갈수 있는 모든 구성들이 들어가있다. 대신, 불필요한 것들은 들어있지 않다.</li>\n<li>해당 도커 이미지를 run 시키면 해당 SW 가 돌아가는데 그 상태를 컨테이너 라고 한다.\n일종의 프로세스와 유사한 개념이다.</li>\n<li>이 해당 컨테이너 내부 환경을 정의하는 파일은 dockerfile 이다.</li>\n<li>나머지 시스템으로 부터 완전히 독립된 공간을 갖는다. 그래서 밖으로 통신하기 위해선 포트를 맵핑해야 한다.</li>\n</ul>\n<h3 id=\"what-is-service\" style=\"position:relative;\"><a href=\"#what-is-service\" aria-label=\"what is service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is Service?</h3>\n<ul>\n<li>서비스는 app 의 한 부분이다. 예를 들어 비디오를 공유하는 사이트는 데이타 베이스에 app data 를 저장하는 서비스, 비디오 업로드 후 transcoding 하는 서비스 등등..</li>\n<li>서비스들은 실제로 production 의 컨테이너들로 구성된다.</li>\n<li>하나의 서비스는 하나의 이미지만 실행하지만 그 이미지를 실행하는 방법을 쳬계화 할 수 있습니다. 그 체계화는 docker-compose.yml 파일에서 설정 할 수 있다.</li>\n<li>docker-compose.yml 파일에서는 어떤 포트를 사용해야하는지, 서비스가 가져가야 할 필요한 용량에 따라 얼마나 많은 복제 컨테이너를 실행시켜야 하는지, 서비스를 위해 얼마나 컴퓨팅 리소스를 할당할지를 설정 할 수 있다.</li>\n<li>docker-compose.yml 을 이용 하면 이미지를 일일이 다 run 시키지 않아도 된다.</li>\n</ul>\n<h3 id=\"what-is-image\" style=\"position:relative;\"><a href=\"#what-is-image\" aria-label=\"what is image permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is Image?</h3>\n<ul>\n<li>도커 이미지란 서비스의 필요한 프로그램 , 라이브러리, 소스등을 설치한 뒤에 이를 파일로 만든 것이다. 쉽게 실행파일이라고 생각하면 된다.</li>\n<li>이미지를 만들기위해 dockerfile 에 필요한 명령들을 설정해 놓는다.</li>\n<li>이미지는 base image 와 parent image 로 나뉜다.</li>\n<li>base image 는 parent image 가 없는 이미지를 말한다.</li>\n<li>parent image 는 사용하는 이미지의 Dockerfile 내에 FROM 으로 지시되는 이미지이다. 만약 Dockerfile 내에 FROM 이 지시되어있지 않다면 부모 이미지가 없는것이고 이는 곧 base image 가 된다.</li>\n<li>Dockerfile 로 이미지를 만들때는 전에 만들었던 이미지 캐시를 잘 이용해야 한다. 기존 방식은 한줄 한줄 실행하면서 <br><b>임시 컨테이너 생성 > 명령어 수행 > 이미지 저장 > 임시 컨테이너 삭제 > 새로 만든 이미지 기반 임시 컨테이너 생성 > 명령어 수행 > 이미지로 저장 > 임시 컨테이너 삭제...</b> 이런식으로 수행....</li>\n</ul>\n<p>----> {해쉬아이디} : 이미지 저장 <br>\n----> Running in {해쉬아이디} : 명령어를 수행하기 위해 그 전 이미지 기반으로 임시 컨테이너 생성</p>\n<p>&#x3C; 처음 Dockerfile 돌렸을때 ></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 461px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/ho_blog/static/746f6243da40bcdfd0dea81cd38cb1fe/793c2/img_build_init.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 108.45986984815619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAADlklEQVQ4y41V2XLiVhSUl7GN2cGAkNCONiSBDXgSZ5K85CH//0Wd7oPtpCpTNfOgEpLu7dunu8/BWXVzrNoZor9ThH/FcL+tMQsW2PgJyrJAWVVwVyuk2wJpmmA0GmFX77DZBKjrmvcNoijCcDDAzc0NnObWwal3g7dvv+F0PiJOU2RZivlshv1+j00YEaDC09MCbbfn7xq73Q5pliEIQlRVjaZtEccJEl5OPh3j2V3i5eWImh+rukEYBNjwarlw7flkEHJzhOPxiHyb20E1WbquyypKPh/s3Xw+J+CuQdl2PHGL1XKJMEqMQVFUyIvCTvZ9H0+LhW24u7sn2ycsFkvc3t7i4eEB0+kMS+51HAeOap9OJsYoSVKCtWRyQsdTA+pzf3+Puy9fLot/5lqRtu9L2NjEF/BuV7OkCk3TYpvnyKhrzru+eZ5nErjuGh0rk27SV8ZovzMn/fXaQ0x2YRiiKCsD1wKJfTqdTfj94dk07fVU4tTK/7jL+aurK7vIcG3W50VpjJ5pTkMNj6cTIh7Q7/cxmUxts7tyMRgOP6OyIiPpK1KfJUvs5XJl+qUsTQwPZCP35KKAhgTxCTIcDn6s4Xg8MYdUpsKapJk5G/B3nhd4ff1KTRv8/sefqHiINn2U91nmfwEV3MW7jgIQ04yhlQQBTQiDi64ZYyWW+v6xThV4NLRiN3nrta1xMn6UHmZIXpJdxMXMIvUsmMOQzBUlVRDrPdnWfBao9Ct5mNpTGT6dv8KRuxdxN4xHxrJ9O6CqdhaVIIyZyRfqmyHbbrFn+7XdwYACktDBOkR7X19/gVOUl8xF1C1NMnRdZ4aIWUmG6lf19ePjozk+Ho0x5fNgMGSEejRqxBRMLDoLGuzkbDG1mk5K3kuSJsqgTFCQl6zApUbSVI4vrEVje5beBvRhioKp3pTIGkeaKIfDwaLjrpbs3Tv0yG7AFh2Nhta7Yqt09PsD+6b2/NdlOieHQ+q2JgvPD8xVsb24XZhRmi4V56M2qzyf6/oE+18OxU7BloZZurVRJDCPDqpjMo4rAcpllf/DYMsxzbLuHUi9ez6/XnqaLnpkr2n009OmZDzkrLTTuBLDNZnUTWuxEXDTNN8v73uXMieggp2hIL9wFqoFBaznjhWIaUo5WgIXdF6BViNonTIcW+QSG3XO9fW1ObylVjJGjNq2MTBpVtGMkGGvqaeAdZAqyvintaVp2vf265vNR8XtH2gPQKn6zAVOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"처음 Dockerfile 돌렸을때\"\n        title=\"처음 Dockerfile 돌렸을때\"\n        src=\"/ho_blog/static/746f6243da40bcdfd0dea81cd38cb1fe/793c2/img_build_init.png\"\n        srcset=\"/ho_blog/static/746f6243da40bcdfd0dea81cd38cb1fe/00d96/img_build_init.png 148w,\n/ho_blog/static/746f6243da40bcdfd0dea81cd38cb1fe/0b23c/img_build_init.png 295w,\n/ho_blog/static/746f6243da40bcdfd0dea81cd38cb1fe/793c2/img_build_init.png 461w\"\n        sizes=\"(max-width: 461px) 100vw, 461px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>&#x3C; 기존 Dockerfile 을 2 번째 돌렸을때 ></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 461px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/ho_blog/static/7f2e4d4e319728eb8656bacb2419016f/793c2/img_build_before.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100.43383947939262%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADCElEQVQ4y5VVW1PaUBDmJjAqVRIIMeR2yA0SCCJSp086tT9C+2Qda0WL1al1pv3zX3fX1nHaGdGHMycJZ/d8l92lsPh5jbW4AbUfwHnvQh0G0BIdPdXHcDRCFMfwPQ++CpD0+6iUS9jastBut+H5vuyG0UG9VkWhUEDh+8UpfHrYySPsHb6D3/cRDELoehthGCCmJL2egmluIY4TJEmCEV0UhiF8XyEMQnrPoZSSiwp3X87Ro4R7gxST7SmSMEEURnSzgcFgQMgUPEJodW0JzMdjDIcjWkPYtkOXBcjzMcbjbXS7XUp4f4+u6yGjw67rwnYcocaJ0jQlJBFcx5XbPc/FxuYmOqZJiXpYX2+g0WjIb4y4XC6jMJ/PUavWYFldouDDoeCdnSkh2ZYgDtjY2KDDpQeNlq2rq68SwAJ7vodOxxSN2JCclk0XmJ2OoGL0rVYLis4a9I0ZBHSpYRjyblmk4fHRsWTusOhJH1EUIwgedNG0ptBYWVmRvVKpoEyrVquhWq1idXUV9Xpdfq8SS94L88tLSlgUHdI0Q5aNMJvNkGZD0syXAA5m6mtra8spn5+fo7nZfHCTqGzSc48Q9vsDocDuNptNKRHbtlEsFp9P+PH4gbKm6YJw9naPSiLD9mRK2hkvM+Lpur29hdbU4BI9pXxouv6nQxISX9F3D7qmUY05ZIB6pG5Zthj0X8KjR1NMMYVXQMU6pLrktvprBuvIZpRKJfnG72LCvwnPzj7LIa5DppyQdlz1XIfcZhz4KsqLxYJovBFHubCZRo/6c0LFbRJqNuRVCT+dnMgDTwxGyF3CfcoIbe5NPrTM2afr5uYGLb0lpeJTpzAi1m+6O5OxxcgrlbIcLr4k8enpqTy0qX3YWW4nHkWMUCfHX102FxcXKJFrDk2aQZZSh2SII5px1HqO3ZWJwom5XHhfqumPu3vYlovpZBexijCIM5gtgwp7Qt3SF9dns13pnDzPSR7t+YTXv75hNVyXvwD/Qw/uvkIradGQTXFwsE/6rcgQqNXqUofLKP8GCFj7k1ZmGmYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"기존 Dockerfile을 2번째 돌렸을때\"\n        title=\"기존 Dockerfile을 2번째 돌렸을때\"\n        src=\"/ho_blog/static/7f2e4d4e319728eb8656bacb2419016f/793c2/img_build_before.png\"\n        srcset=\"/ho_blog/static/7f2e4d4e319728eb8656bacb2419016f/00d96/img_build_before.png 148w,\n/ho_blog/static/7f2e4d4e319728eb8656bacb2419016f/0b23c/img_build_before.png 295w,\n/ho_blog/static/7f2e4d4e319728eb8656bacb2419016f/793c2/img_build_before.png 461w\"\n        sizes=\"(max-width: 461px) 100vw, 461px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>&#x3C; 기존 Dockerfile 에서 EXPOSE 80 에서 EXPOSE 81 로 변경했을 때 ></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 455px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/ho_blog/static/8a6555902ada49113c4af2e4c616e516/8a1eb/img_build_after.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 110.76923076923077%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAADlElEQVQ4y42UWVMiWRCFEQRF9qXYigKqqA2oYlNQY2IiZrpdIkQlbMcHp6P9Cf3/386cTKeJ6R7D7ocbdblUnZt58stMbL9skfOzaJ+1YX7swTgxUHaraDRMdC0L4WiEWq0Oq9eDbds4zGZhdbvo9wfo8axjmrCsLgqFAhKJBBKfN5eYpxJYTkOcffgdA6+HMBqh2WjA9TxMogi24/BjC54XII5jRJMJ//P1Atf1MJvN+I6LbtdC4nlzg0kmheNJhHi6hMc/fL5sGIYK2vYAJiOSaIJwhDiKMRqFGI0nFOhiMLAxnfKSeKa/E59fXuBNYk2t1++j1Wrpy74f8GyMIPA1RdO00Ol0UC6XUa/X4dgO8vkCskdHerkIHxxkkNjc3CCfy79GxPB79G2xPNbU+rwgl8vpUn9+ZT09PaHZbGm4PRotwnE8xUzTiDEcDhmZqT72mXar1caQe8vqMdUZwiDgtyaaPJd94urqSpWlkmOmGtGjwWCAxWKJYrGo/+3t7e0ikH0ymdRnOp1GKpXSvawUzyl4rSUX7ybiJY1fHq80ZSlEPp+nNweoVKoolUrfib+5NptbMtfUlCUt2TtDV9OWS9rtNiMtKXftdkuje1fw4uJCN9VqlczFWK3WxCNklMeo12q/Xoxva7vdKpAaIVEQkXi2IIueoiCVFlTkKQSUyyUcERXByCA+b0YoxtbrBvwgVHilgvP5QqPe39/XJT4eHh7qXtJOpzNalP8J3t7eIZs9QovoxMRgPB6zwidYnZxoa/2sCN8qvDu7vLxW8iVt2xm+As4uEf5MNr7DM0m5xeLU30rxx/X4+Ber19Fo/GDEAeArOr7vs+1CwjtVG05Pz7Akm81mkwhV+P4QA/oq3eWQjp3g3d2dsiYdMJvPVUCqfbpeM0qH/iaRpMf/9TKTyeg30pJ5Miz7neDDwwOrZSjEQ/LX4NgaE3AZSVJ5ORORNEVE6Kcp39/fo0SPLCLh+6HC7bq+igmP6/WpFmrF53Kx0Igksmq1pt5WSII8d4KfHh91OIig+69/I46t8/NztmKEMtutwJ42jAb7vaaXi486mZiVsCq9/x3YxVJZJ4kOUPawAC6TxuT8KxSK6q8sGfcyE99N+fn5bzi8LY4jeMTFJS6VckXBDoJAPZQpFDJ9GVsyIN4VfPn6gs5v9OuaY/1ThOAmRH9lc9Qv8eHPPzRCEZFRViy++ieTWibUj0so+AfpzTT853i5jwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"기존 Dockerfile 에서 EXPOSE 80 에서 EXPOSE 81로 변경했을 때\"\n        title=\"기존 Dockerfile 에서 EXPOSE 80 에서 EXPOSE 81로 변경했을 때\"\n        src=\"/ho_blog/static/8a6555902ada49113c4af2e4c616e516/8a1eb/img_build_after.png\"\n        srcset=\"/ho_blog/static/8a6555902ada49113c4af2e4c616e516/00d96/img_build_after.png 148w,\n/ho_blog/static/8a6555902ada49113c4af2e4c616e516/0b23c/img_build_after.png 295w,\n/ho_blog/static/8a6555902ada49113c4af2e4c616e516/8a1eb/img_build_after.png 455w\"\n        sizes=\"(max-width: 455px) 100vw, 455px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>이미지 생성시 FROM 에 적어둔 parent image 기반으로 변경사항만 따로 저장되는게 장점. vm 처럼 용량을 많이 먹지 않음. <br>\n따라서 parent image 기반으로 새로운 이미지를 만들고 parent image 를 삭제하려고 했을때 에러 뜸.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/ho_blog/static/62aa45154c39e50055992029e5ace308/e44fa/img_parent_error.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.587301587301587%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAg0lEQVQI1x2NQQ6DIAAEPRjFSqJgrRVssApiTOux///ZlHjamcts1s6K7rhjfpbnZ6QbBpZlxTmHMSN9/0BKSZ7nFGVJXdcURYGoKoQQlzdNQ9sqquTZ6+1Yd88SV8IRCXFLIYNfPTHuF29pQ9jSyYz3ATtNfM8Ta20KSrTWKKW5pfgfyswzLMTUIKAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"error\"\n        title=\"error\"\n        src=\"/ho_blog/static/62aa45154c39e50055992029e5ace308/799d3/img_parent_error.png\"\n        srcset=\"/ho_blog/static/62aa45154c39e50055992029e5ace308/00d96/img_parent_error.png 148w,\n/ho_blog/static/62aa45154c39e50055992029e5ace308/0b23c/img_parent_error.png 295w,\n/ho_blog/static/62aa45154c39e50055992029e5ace308/799d3/img_parent_error.png 590w,\n/ho_blog/static/62aa45154c39e50055992029e5ace308/e44fa/img_parent_error.png 630w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"what-is-stack\" style=\"position:relative;\"><a href=\"#what-is-stack\" aria-label=\"what is stack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is Stack?</h3>\n<hr>\n<h2 id=\"docker-structure\" style=\"position:relative;\"><a href=\"#docker-structure\" aria-label=\"docker structure permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker Structure</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/ho_blog/static/d38f16b7e2191f33734175d73efd4938/983e0/img_structure.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.41013824884792%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADPUlEQVQozy2S309bZRjH++eYqFfGOy80XqhLdE5ddjExmrkLY4xRL2YmsAIbcSDbnAGZUBooDAbtVmjpQCiUYrXD9rSlQCml5RxKfxxOz2kLGz+K+vHFePHN++RN3s/7fZ7vYwq4V1h0xpH8CrIU4SjYwYEcgGKMwZib1uAAY8k5VjWZk4NDZK1M3VyBD+dVzs8W+Nin8tZUnhfGtnnRvo0pE5FRwluoySLl7S2eJSfRsyvksylG4kHuhuewL/+O7485jg0dzShzcTbHezOF/3Rxrsi5X/NcEB+86sljimp7uJQKjpTGgGuNk6c1looHvOvVOed/xmu+Yz7z79I14WVe0QlX/2Zgo8qDdZ3hRIn6YJGGJZXW6QzeWA5TV0zjnRmVs5N5PuqOMLWSR9pW+W5Bpm9kGsewG7tjBueEj4eOWVyD43RORxjarBJQSnyysMulxV2+cqSYCe1gcmcqXH2icWOpgFkq0SzpBNIy5kAS24gHz6ATt32aSaeX8dFJXNZhbnkkeuJZJHmHb54YXBCz/Dyo8/WSjsmVq3G5a5Qzb77B23WXaY9oxNSnDKQP6c1Bj1Cn8g93Nk+wZE+4HVSxbhzhTBuElAKfLpZ4+VGWM4/zmEMCOFn4i7r2Pl56/jleP3uetpCKZBwz7/ESu9NG7Oef8NmGuCdm/MCfYWAohs29yZRsENzaoT5c5kbEoFmoRTIwjWeqXFnM0jy7SsN8ipuSxkq1xg89bq5caqTxi1YaWvqwpPdxRHexjq0xuLCDR9knJGdp8mW4bl2m6f4azWHh0LlZ5suggTm6J+ZQpimkEddr2B47sXZfxWZpwjLagzV9wMOohtWe4H5ghynF4M8tBbM/S8NwgkYRSsspcDxd5oPZIq+MZ3lf7FVbtESocEg07Wd3o5dc0sbqhov+LQEUIItFYngqhVdRCcoq34YrtC+XMUfKIlDR8iPh8FrYoOP0Upw3owZSvkL3+gG/JGv0pmp0Jo64Ha9gSe7Rn6xyb32f0fQev2WrWNYMcnqVlWKFH5cFcEI4rA8Z3Pof2BEzCAvgdbE+30d04VgXdYlrIsFTB6du6kV9ClrKVbgbN7AmyvQLtYu3/wIi9gl7h7to6QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Docker Structure\"\n        title=\"Docker Structure\"\n        src=\"/ho_blog/static/d38f16b7e2191f33734175d73efd4938/799d3/img_structure.png\"\n        srcset=\"/ho_blog/static/d38f16b7e2191f33734175d73efd4938/00d96/img_structure.png 148w,\n/ho_blog/static/d38f16b7e2191f33734175d73efd4938/0b23c/img_structure.png 295w,\n/ho_blog/static/d38f16b7e2191f33734175d73efd4938/799d3/img_structure.png 590w,\n/ho_blog/static/d38f16b7e2191f33734175d73efd4938/983e0/img_structure.png 868w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><em>출처 : <a href=\"http://www.leafcats.com/146\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://www.leafcats.com/146</a></em></p>\n<hr>\n<h2 id=\"docker-install\" style=\"position:relative;\"><a href=\"#docker-install\" aria-label=\"docker install permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker Install</h2>\n<p><a href=\"https://docs.docker.com/engine/installation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">공식 홈페이지 참조</a></p>\n<hr>\n<h2 id=\"docker-use\" style=\"position:relative;\"><a href=\"#docker-use\" aria-label=\"docker use permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker use</h2>\n<p>도커 허브에서 원하는 이미지를 다운 받을 수 있다.\n<a href=\"https://hub.docker.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">도커 허브</a></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker --help</code></pre></div>\n<p>도커의 명령어를 살펴볼 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker pull nginx:latest\nor\n$ docker run -d -it <span class=\"token punctuation\">\\</span>\n--name merlin-nginx <span class=\"token punctuation\">\\</span>\n-p <span class=\"token number\">8080</span>:80 <span class=\"token punctuation\">\\</span>\nnginx:latest</code></pre></div>\n<p>pull 을 하면 해당 이미지만 받는것이다 <br>\nrun 을 실행하게 되면 local 에 nginx:latest 라는 이미지가 없으면 자동으로 hub 에서 다운받아서 run 을 시킨다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker images\n$ docker <span class=\"token function\">ps</span>\n$ docker <span class=\"token function\">ps</span> <span class=\"token punctuation\">[</span>-a<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-l<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-n number<span class=\"token punctuation\">]</span></code></pre></div>\n<p>images 는 도커 이미지 리스트를 살펴볼 수 있다. <br>\nps 는 실행중인 컨테이너 리스트를 볼 수 있다. <br>\n-a 옵션을 붙이면 종료된 목록까지 볼 수 있다.<br>\n-l 옵션은 마지막 실행했던 목록 , -n 은 리눅스의 tail 명령어와 동일하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker commit -a <span class=\"token string\">\"merlin &lt;merlin@kakaocrop.com>\"</span> -m olympic-search-pc naughty_torvalds search.daum.pc:olypic</code></pre></div>\n<p>현재 돌아가고 있는 컨테이너를 이미지로 만들 수 있다.<br>\n-a 옵션 : author , -m : 커밋 메세지 , &#x3C;naughty_torvalds> 들어가는 부분 : 지금 동작하고 있는 컨테이너 이름 , &#x3C;search.daum.pc:olypic> 새로운 이미지 네임과 태그</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker <span class=\"token function\">rm</span> <span class=\"token operator\">&lt;</span>컨테이너 이름<span class=\"token operator\">></span>\n$ docker rmi <span class=\"token operator\">&lt;</span>이미지<span class=\"token operator\">></span>\n<span class=\"token comment\"># 한번에 처리.</span>\n$ docker <span class=\"token function\">rm</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>docker <span class=\"token function\">ps</span> -a -q<span class=\"token variable\">)</span></span></code></pre></div>\n<p>도커 이미지와 컨테이너 삭제</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker start <span class=\"token operator\">&lt;</span>컨테이너 이름<span class=\"token operator\">></span>\n$ docker stop  <span class=\"token operator\">&lt;</span>컨테이너 이름<span class=\"token operator\">></span>\n$ docker restart <span class=\"token operator\">&lt;</span>컨테이너 이름<span class=\"token operator\">></span></code></pre></div>\n<p>도커 컨테이너 실행 , 중지 , 재부팅</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker attach <span class=\"token operator\">&lt;</span>실행중인 컨테이너 이름<span class=\"token operator\">></span>\n$ docker <span class=\"token builtin class-name\">exec</span> -it <span class=\"token operator\">&lt;</span>실행중인 컨테이너 이름<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>컨테이너 안에서 실행할 명령<span class=\"token operator\">></span>\n$ docker <span class=\"token builtin class-name\">exec</span> -it merlin-nginx /bin/bash</code></pre></div>\n<p>attach 는 실행중인 도커 컨테이너에 접속한다. 단, ps 쳤을때 command 에 /bin/bash 라고 쳐져있어야 자유롭게 입력할 수 있다. 그렇지 않으면 입력은 할 수 없고 출력만 보인다. <br>\nexec 는 컨테이너 안에서 수행할 명령을 날려줍니다. -it 옵션을 주면 실행된 bash 쉘에서 입력 및 출력을 할 수가 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker inspect <span class=\"token operator\">&lt;</span>컨테이너 이름 or 이미지:태그<span class=\"token operator\">></span></code></pre></div>\n<p>이미지 또는 컨테이너의 세부정보를 출력합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker <span class=\"token function\">history</span> <span class=\"token operator\">&lt;</span>이미지:태그<span class=\"token operator\">></span></code></pre></div>\n<p>이미지의 히스토리를 조회</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker <span class=\"token function\">diff</span> <span class=\"token operator\">&lt;</span>실행중인 컨테이너 이름<span class=\"token operator\">></span></code></pre></div>\n<p>컨테이너가 실행되면서 변경된 파일 목록을 출력합니다. 비교 기준은 컨테이너를 생성한 이미지 내용입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker <span class=\"token function\">cp</span> <span class=\"token operator\">&lt;</span>컨테이너 이름<span class=\"token operator\">></span>:<span class=\"token operator\">&lt;</span>경로<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>호스트 경로<span class=\"token operator\">></span></code></pre></div>\n<p>컨테이너에서 파일을 꺼내기.</p>\n<hr>\n<h2 id=\"docker-build\" style=\"position:relative;\"><a href=\"#docker-build\" aria-label=\"docker build permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker build</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker <span class=\"token punctuation\">[</span>OPTIONS<span class=\"token punctuation\">]</span> <span class=\"token environment constant\">PATH</span> <span class=\"token operator\">|</span> URL <span class=\"token operator\">|</span> -\n$ docker build -t app <span class=\"token builtin class-name\">.</span></code></pre></div>\n<p>-t 옵션은 생성할 이미지 이름을 지정합니다. <br>\n-f 옵션은 파일명을 custom 하게 지었을때 사용하거나 Dockerfile 경로가 루트에 없을때 이용. <br>\nPATH 는 도커 이미지 빌드 할때 전송되는 context 를 가리킨다. <br></p>\n<h3 id=\"dockerfile\" style=\"position:relative;\"><a href=\"#dockerfile\" aria-label=\"dockerfile permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dockerfile</h3>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token comment\"># 어떤 이미지로부터 새로운 이미지를 생성할지를 작성</span>\n<span class=\"token comment\"># 베이스를 지정</span>\n<span class=\"token keyword\">FROM</span> node<span class=\"token punctuation\">:</span>argon\n\n<span class=\"token comment\"># Dockerfile 을 관리하는 사람의 이름</span>\n<span class=\"token keyword\">MAINTAINER</span> &lt; merlin.ho <span class=\"token punctuation\">></span> merlin@merlin.com\n<span class=\"token comment\"># /app directory 생성</span>\n<span class=\"token keyword\">RUN</span> mkdir /app\n\n<span class=\"token comment\"># /app directory를 WORKDIR로 설정</span>\n<span class=\"token keyword\">WORKDIR</span> /app\n\n<span class=\"token comment\"># 현재 경로에 있는 package.json을 /app에 복사</span>\n<span class=\"token comment\"># ADD와 기본적으로 동일하나 차이점은 URL을 지정할수 없고 압축파일을 자동으로 풀어주지 않는다. </span>\n<span class=\"token keyword\">COPY</span> package.json /app\n\n<span class=\"token comment\"># 파일과 디렉토리를 호스트에서 docker image로 copy한다.</span>\n<span class=\"token comment\"># src에 파일 대신 url을 입력할수 있고 압축 파일의 경우 압축을 해제하면서 복사</span>\n<span class=\"token comment\"># 호스트에 있는 . 경로에 있는걸 /usr/src/app 에 복사.</span>\n<span class=\"token keyword\">ADD</span> &lt; src <span class=\"token punctuation\">></span> &lt; dest <span class=\"token punctuation\">></span>\n<span class=\"token keyword\">ADD</span> . /usr/src/app\n\n<span class=\"token comment\"># 내부적으로 /bin/sh -c 실행 뒤 npm install 을 실행</span>\n<span class=\"token keyword\">RUN</span> npm install\n\n<span class=\"token comment\"># 현재 Dockerfile 이 있는 경로의 모든 파일을 /app 에 복사함</span>\n<span class=\"token keyword\">COPY</span> . /app\n\n<span class=\"token comment\"># 가상머신에 오픈할 포트넘버</span>\n<span class=\"token keyword\">EXPOSE</span> 3000\n\n<span class=\"token comment\"># 도커 컨테이너가 실행 되었을때 실행되는 명령 지정, 빌드할때는 실행되지 않으며 여러개의 CMD가 존재할 경우 가장 마지막 것만 실행 됩니다.</span>\n<span class=\"token comment\"># 한꺼번에 여러 개의 프로그램을 실행하고 싶은 경우에는 run.sh파일을 작성하여 데몬으로 실행하거나 supervisord나 forego와 같은 여러 개의 프로그램을 실행하는 프로그램을 사용합니다.</span>\n<span class=\"token keyword\">CMD</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"npm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"start\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h3 id=\"recommendation-dockerfile\" style=\"position:relative;\"><a href=\"#recommendation-dockerfile\" aria-label=\"recommendation dockerfile permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>recommendation Dockerfile</h3>\n<ol>\n<li>\n<p>Containers should be ephemeral</p>\n<ul>\n<li>Ephemeral environments are also sometimes called “Dynamic environments”, “Temporary environments”, “on-demand environments” or “short-lived environments”.</li>\n<li>static environments 와 반대되는 개념이다.</li>\n<li>이것이 의미하는 바는 이 컨테이너를 우리가 stop and destroy 할 수 있고 새롭게 built 할 수 있으며 최소한의 셋팅과 설정으로 원하는 장소에 올려 놓을수 있다 라는것을 뜻함.</li>\n<li>그래서 항상 production 환경과 같은 환경에서 test 를 진행할 수 있다. test 도 하나의 이미지를 공유 함으로써 병렬로 진행 할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>Use a .dockerignore file</p>\n<ul>\n<li>우리는 docker build 커멘드를 치는 장소를 build context 라고 부른다.</li>\n<li>디폴트로 현재 디렉토리라고 가정하지만 구체적인 다른 디렉토리를 가리키려면 -f flag 를 사용해야한다.</li>\n<li>현재 디렉토리의 파일과 여러 디렉토리들을 docker deamon 에게 build context 로 보내지게 되는데 이 이것은 무심코 이미지 결과로 보내지게 되어 이미지 파일이 커지게 된다.</li>\n<li>따라서 .gitignore 와 비슷하게 .dockerignore 파일을 사용해서 관계없는 파일들을 exclude 시킬수 있다.</li>\n</ul>\n</li>\n<li>\n<p>Use multi-stage builds</p>\n<ul>\n<li>Docker 17.05 버전 이상에서는 multi-stage builds 로 최종 이미지 사이즈를 줄일 수 있다.</li>\n<li>multi-stage builds 란 Dockerfile 안에서 multiple FROM 구문을 사용하면 각각의 새로운 stage 가 빌드 되고 한 stage 에서 나온 결과 산출물을 또다른 stage 로 카피를 할 수 있다. 따라서 중간 산출물을 위해 Dockerfile 을 여러개 만들어서 중간 이미지를 만들고 하는 복잡한 과정을 거치지 않아도 된다.</li>\n<li>dockerfile 을 작성할때 자주 바뀌지 않은 것부터 자주 바뀌는 순으로 작성을 한다.</li>\n</ul>\n</li>\n<li>\n<p>Avoid installing unnecessary packages</p>\n<ul>\n<li>불필요한 패키지는 인스톨을 피해라.</li>\n<li>예를 들면 데이타베이스 이미지에 text editor 를 추가시킬 필요는 없다.</li>\n</ul>\n</li>\n<li>\n<p>Each container should have only one concern</p>\n<ul>\n<li>하나의 컨테이너는 오직 하나의 일만하게 시켜라.</li>\n<li>응용 프로그램을 여러 컨테이너로 분리하면 가로로 확장하고 컨테이너를 다시 사용하는 것이 훨씬 쉬워집니다.</li>\n<li>컨테이너를 깨끗하고 가능한 모듈화 시킬 수 있는 최고의 판단을 해라.</li>\n<li>만약 컨테이너 각각이 의존성을 띄고 있다면 Docker network 를 사용하면 컨테이너끼리의 커뮤니케이션을 할 수 있다.</li>\n</ul>\n</li>\n<li>Minimize the number of layers</li>\n<li>Sort multi-line arguments</li>\n<li>Build cache</li>\n</ol>\n<hr>\n<h2 id=\"10-things-to-avoid-in-docker-containers\" style=\"position:relative;\"><a href=\"#10-things-to-avoid-in-docker-containers\" aria-label=\"10 things to avoid in docker containers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>10 things to avoid in docker containers</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1. Don’t store data in containers\n2. Don’t ship your application in two pieces\n3. Don’t create large images\n4. Don’t use a single layer image\n5. Don’t create images from running containers\n6. Don’t use only the “latest” tag\n7. Don’t run more than one process in a single container\n8. Don’t store credentials in the image. Use environment variables\n9. Don’t run processes as a root user\n10. Don’t rely on IP addresses</code></pre></div>\n<p><em>출처 : <a href=\"https://developers.redhat.com/blog/2016/02/24/10-things-to-avoid-in-docker-containers/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://developers.redhat.com/blog/2016/02/24/10-things-to-avoid-in-docker-containers/</a></em></p>\n<hr>\n<h2 id=\"docker-app-data-관리법\" style=\"position:relative;\"><a href=\"#docker-app-data-%EA%B4%80%EB%A6%AC%EB%B2%95\" aria-label=\"docker app data 관리법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker app data 관리법</h2>\n<h3 id=\"호스트의-지정된-폴더를-컨테이너에-다이렉트로-마운트\" style=\"position:relative;\"><a href=\"#%ED%98%B8%EC%8A%A4%ED%8A%B8%EC%9D%98-%EC%A7%80%EC%A0%95%EB%90%9C-%ED%8F%B4%EB%8D%94%EB%A5%BC-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%97%90-%EB%8B%A4%EC%9D%B4%EB%A0%89%ED%8A%B8%EB%A1%9C-%EB%A7%88%EC%9A%B4%ED%8A%B8\" aria-label=\"호스트의 지정된 폴더를 컨테이너에 다이렉트로 마운트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>호스트의 지정된 폴더를 컨테이너에 다이렉트로 마운트</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker run --name merlin_ubuntu -d -v <span class=\"token operator\">&lt;</span>호스트 폴더경로<span class=\"token operator\">></span>:<span class=\"token operator\">&lt;</span>마운트될 컨테이너 폴더경로<span class=\"token operator\">></span> -it ubuntu:14.04</code></pre></div>\n<h3 id=\"volume-container-사용\" style=\"position:relative;\"><a href=\"#volume-container-%EC%82%AC%EC%9A%A9\" aria-label=\"volume container 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>volume container 사용</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 볼륨 컨테이너를 만든다. busybox 기반 정말 리눅스의 최소 기반만 가지고 있다. 1.14MB</span>\n$ docker run -v /dbdata --name dbdata busybox\n\n<span class=\"token comment\"># 볼륨 컨테이너를 우분투 컨테이너에 연결</span>\n$ docker run --volumes-from<span class=\"token operator\">=</span>dbdata -it ubuntu:14.04 /bin/bash\n\n<span class=\"token comment\"># 빽업도 진행할 수 있다.</span>\n$ docker run —volumes-from dbdata -v <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">pwd</span><span class=\"token variable\">)</span></span>:/backup ubuntu <span class=\"token function\">tar</span> cvf /backup/backup.tar /dbdata</code></pre></div>\n<h3 id=\"volume-으로-사용\" style=\"position:relative;\"><a href=\"#volume-%EC%9C%BC%EB%A1%9C-%EC%82%AC%EC%9A%A9\" aria-label=\"volume 으로 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>volume 으로 사용</h3>\n<ul>\n<li>보통 standalone 컨테이너에는 -v 또는 --volume 옵션을 사용했고, swarm service 에는 --mount 옵션을 사용해 왔지만 17.06 이후 버젼부터는 standalone 컨테이너에서 모두 사용이 가능하다.</li>\n<li>만약 볼륨드라이버의 구체적인 옵션을 셋팅해야 한다면 --mount 옵션을 사용해라.</li>\n<li>-v 또는 --volume 옵션은 도커 호스트에 파일 또는 디렉토리가 없을 경우 자동으로 생성해주지만 --mount 옵션은 자동으로 생성해주지 않는다 대신 에러를 뿜는다.</li>\n<li>-v 또는 --volume 은 세가지 field 를 가질수 있다 첫번째는 호스트 머신의 볼륨 이름이고 랜덤한 볼륨을 생성하고 싶다면 생략해도 된다. 두번째는 컨테이너 안에 생성될 디렉토리 또는 파일 path 이다. 세번째는 옵션으로 콤마(:)로 옵션을 나열할 수 있다. 예를 들면 ro(readonly) 옵션등이 있다.</li>\n<li>--mount 는 key=value 로 구성을 하고 key 에는 type, src or source , dst or target , volume-opt 등이 있다.</li>\n<li>type 의 경우에는 bind , volume , tmpfs 가 있다. 올바른 타입으로 선택하자.</li>\n<li>Voloumn 타입, volumn 은 도커에 의해 관리되는 host 쪽에 있는 파일시스템으로 저장이 된다. 여기서 volumn 은 \"~/Library/Containers/com.docker.docker/Data/com.docker.driver.amd64-linux/tty\" 해당 경로에 있는 리눅스 안에 \"/var/lib/docker/volumes/\" 쪽에 저장이 된다. 도커가 아닌 프로세스가 이 파일은 수정하지 못하고 volumnes 는 도커 안에서 데이터를 유지하기 최고의 방법이다.</li>\n<li>bind 타입, 이 bind 타입은 host 어디에나 저장이 될 수 있다. 여기서 중요한 시스템 파일이나 디렉토리들에 사용이 될수있고 언제든지 도커가 아닌 프로세스나 도커 컨테이너에서 수정될수 있다.</li>\n<li>tmpfs 타입, 이 타입은 hosts 의 메모리에 저장이 된다. 그리고 host 파일시스템에 쓸수가 없다. 휘발성이 강하다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker volume create my-vol\n$ docker volume <span class=\"token function\">ls</span>\n<span class=\"token comment\">## Remove a volume:</span>\n$ docker volume <span class=\"token function\">rm</span> my-vol</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">## 컨테이너 연결</span>\n<span class=\"token comment\">## mount 방법</span>\n$ docker run -d <span class=\"token punctuation\">\\</span>\n  -it <span class=\"token punctuation\">\\</span>\n  --name devtest <span class=\"token punctuation\">\\</span>\n  --mount <span class=\"token assign-left variable\">source</span><span class=\"token operator\">=</span>myvol2,target<span class=\"token operator\">=</span>/app <span class=\"token punctuation\">\\</span>\n  nginx:latest\n\n  $ docker run -d <span class=\"token punctuation\">\\</span>\n  -it <span class=\"token punctuation\">\\</span>\n  --name<span class=\"token operator\">=</span>nginxtest <span class=\"token punctuation\">\\</span>\n  --mount <span class=\"token assign-left variable\">source</span><span class=\"token operator\">=</span>nginx-vol,destination<span class=\"token operator\">=</span>/usr/share/nginx/html <span class=\"token punctuation\">\\</span>\n  nginx:latest\n\n<span class=\"token comment\"># -v 방법</span>\n $ docker run -d <span class=\"token punctuation\">\\</span>\n  -it <span class=\"token punctuation\">\\</span>\n  --name devtest <span class=\"token punctuation\">\\</span>\n  -v myvol2:/app <span class=\"token punctuation\">\\</span>\n  nginx:latest\n\n\n  $ docker run -d <span class=\"token punctuation\">\\</span>\n  -it <span class=\"token punctuation\">\\</span>\n  --name<span class=\"token operator\">=</span>nginxtest <span class=\"token punctuation\">\\</span>\n  -v nginx-vol:/usr/share/nginx/html <span class=\"token punctuation\">\\</span>\n  nginx:latest</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/ho_blog/static/4a20af0d205541a77e55e0cf58b015dc/3eaa1/img_busybox.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 3.985932004689331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAANElEQVQI12NgYGD4j4xFRcX+S0lKoojx8fH/19LS/q+jq/tfQUERLq6srPxfXV3jvySSegB1Qhc0E8E1eQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img_busybox 용량\"\n        title=\"img_busybox 용량\"\n        src=\"/ho_blog/static/4a20af0d205541a77e55e0cf58b015dc/799d3/img_busybox.png\"\n        srcset=\"/ho_blog/static/4a20af0d205541a77e55e0cf58b015dc/00d96/img_busybox.png 148w,\n/ho_blog/static/4a20af0d205541a77e55e0cf58b015dc/0b23c/img_busybox.png 295w,\n/ho_blog/static/4a20af0d205541a77e55e0cf58b015dc/799d3/img_busybox.png 590w,\n/ho_blog/static/4a20af0d205541a77e55e0cf58b015dc/3eaa1/img_busybox.png 853w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>마운트 된 경로는 inspect 명령어로 알아 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/ho_blog/static/832c2b5fee3133b85cfa73b7f72f28a6/bd86c/img_mount.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.55358807082945%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAkklEQVQY06VQWwrDMAzLC5qmyaAU8tE8Bk229f4X1GIPdoF8CAnZlrHFcRzQWkMIASkl8xQopPWOWp/43Deuq7E+z4RcCkqtKKWyl3NhJi/GCO89QngMBNbrukIopdFf7xFwMupo3vcdzjlu+g3RQMC2+b9H9WVZYK3lINIEobVBax0pJS5On0z/M8bwFqXUdOAXX6xt8IkhKWIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"마운트 경로\"\n        title=\"마운트 경로\"\n        src=\"/ho_blog/static/832c2b5fee3133b85cfa73b7f72f28a6/799d3/img_mount.png\"\n        srcset=\"/ho_blog/static/832c2b5fee3133b85cfa73b7f72f28a6/00d96/img_mount.png 148w,\n/ho_blog/static/832c2b5fee3133b85cfa73b7f72f28a6/0b23c/img_mount.png 295w,\n/ho_blog/static/832c2b5fee3133b85cfa73b7f72f28a6/799d3/img_mount.png 590w,\n/ho_blog/static/832c2b5fee3133b85cfa73b7f72f28a6/2a3d6/img_mount.png 885w,\n/ho_blog/static/832c2b5fee3133b85cfa73b7f72f28a6/bd86c/img_mount.png 1073w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>결론은 어찌되었건 호스트에 데이타를 연동 시킨다. <br>\nvolume container 를 사용했을 떄 데이터도 컨테이너로 관리를 할 수 있다. 그럼..컨테이너의 장점을 다 이용할 수 있지 않을까...</p>\n<hr>\n<h2 id=\"docker-compose\" style=\"position:relative;\"><a href=\"#docker-compose\" aria-label=\"docker compose permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker compose</h2>\n<p>여러 컨테이너의 Docker application 을 running 하고 defining 하기 위한 툴이 Compose 이다. Compose 를 사용하기 위해서 YAML 파일에 config 를 app service 별로 설정하면 되고 한 커맨드 라인으로 서비스를 만들고 시작할수 있다. 해당 서비스는 YAML 파일에 적혀있는 그대로를 실행시킨다.</p>\n<p>docker compose install\n<a href=\"https://docs.docker.com/compose/install/#install-compose\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">docker compose install</a></p>\n<p>공식문서 <a href=\"https://docs.docker.com/compose/compose-file/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.docker.com/compose/compose-file/</a></p>\n<h3 id=\"docker-compose-를-사용하는-방법\" style=\"position:relative;\"><a href=\"#docker-compose-%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"docker compose 를 사용하는 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker compose 를 사용하는 방법</h3>\n<ol>\n<li>Define your app’s environment with a <code class=\"language-text\">Dockerfile</code> so it can be reproduced anywhere.</li>\n<li>Define the services that make up your app in <code class=\"language-text\">docker-compose.yml</code> so they can be run together in an isolated environment.</li>\n<li>Run <code class=\"language-text\">docker-compose up</code> and Compose starts and runs your entire app.</li>\n</ol>\n<h3 id=\"docker-compose-config\" style=\"position:relative;\"><a href=\"#docker-compose-config\" aria-label=\"docker compose config permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker compose config</h3>\n<p>version 3</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token comment\"># compose 버젼 3을 이용하겠다. 대소문자 주의</span>\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3'</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">webapp</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> ./dir <span class=\"token comment\"># 구체적인 빌드 컨텍스트의 경로를 지정할 수 있다. 도커 파일을 포함하는 디렉토리나 깃 레파지토리 url,</span>\n        <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 또는 구체적인 옵션들을 설정할 수 있다.</span>\n            <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./dir\n            <span class=\"token key atrule\">dockerfile</span><span class=\"token punctuation\">:</span> Dockerfile<span class=\"token punctuation\">-</span>alternate\n            <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 빌드 프로세스 진행중에 사용할 환경 변수들을 지정할 수 있다.</span>\n                <span class=\"token key atrule\">buildno</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n            <span class=\"token key atrule\">cache_from</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># v3.2지원 엔진이 캐시로 사용할 이미지들</span>\n                <span class=\"token punctuation\">-</span> alpine<span class=\"token punctuation\">:</span>latest\n                <span class=\"token punctuation\">-</span> corp/web_app<span class=\"token punctuation\">:</span><span class=\"token number\">3.14</span>\n        <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> bundle exec thin <span class=\"token punctuation\">-</span>p 3000  <span class=\"token comment\"># 디폴트 커멘드를 오버라이딩</span>\n        <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>web<span class=\"token punctuation\">-</span>container <span class=\"token comment\"># 컨테이너 이름</span>\n        <span class=\"token comment\"># 버전 3부터는 depend_on 안에 condition은 지원하지 않는다.</span>\n        <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 서비스들 간에 의존성을 표현, 이것은 db, redis 이후에 webapp 이 실행하게 된다.(compose up시)</span>\n            <span class=\"token punctuation\">-</span> db\n            <span class=\"token punctuation\">-</span> redis\n        <span class=\"token key atrule\">tmpfs</span><span class=\"token punctuation\">:</span> /run <span class=\"token comment\"># 컨테이너에 임시 파일 시스템을 마운트 , 리스트로 작성해도 된다.</span>\n        <span class=\"token key atrule\">entrypoint</span><span class=\"token punctuation\">:</span> /code/entrypoint.sh <span class=\"token comment\"># 도커 파일의 엔트리 포인트를 오버라이딩 , 리스트로 작성해도 된다.</span>\n        <span class=\"token key atrule\">env_file</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 환경변수들을 파일로 받는다. 이 환경 변수 파일들은 각각 라인마다 VAR=VAL 포멧으로 작성한다. #은 주석</span>\n            <span class=\"token punctuation\">-</span> ./common.env\n            <span class=\"token punctuation\">-</span> ./apps/web.env\n            <span class=\"token punctuation\">-</span> /opt/secrets.env\n        <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 환경변수 추가. 어떤 boolen 값들은 quotes로 감싼다.</span>\n            <span class=\"token key atrule\">RACK_ENV</span><span class=\"token punctuation\">:</span> development\n            <span class=\"token key atrule\">SHOW</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'true'</span>\n            <span class=\"token key atrule\">SESSION_SECRET</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">expose</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 포트 노출</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token string\">\"3000\"</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token string\">\"8000\"</span>\n        <span class=\"token key atrule\">external_links</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 링크 컨테이너 docker-compose.yml 외부에 있는 컨테이너 , CONTAINER:ALIAS</span>\n            <span class=\"token punctuation\">-</span> redis_1\n            <span class=\"token punctuation\">-</span> project_db_1<span class=\"token punctuation\">:</span>mysql\n            <span class=\"token punctuation\">-</span> project_db_1<span class=\"token punctuation\">:</span>postgresql\n        <span class=\"token key atrule\">extra_hosts</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># /etc/hosts 에 추가</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token string\">\"somehost:162.242.195.82\"</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token string\">\"otherhost:50.31.209.229\"</span>\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> redis <span class=\"token comment\"># 특별한 이미지로 부터 런 , 이미지가 없으면 pull 한다.</span>\n        <span class=\"token key atrule\">healthcheck</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 이 서비스를 위해 건강한지 체크 , 이미지로 부터 어떤 디폴트 헬스체크를 disable 하려면 disable: true 추가</span>\n            <span class=\"token key atrule\">test</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"CMD\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"curl\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-f\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"http://localhost\"</span><span class=\"token punctuation\">]</span>\n            <span class=\"token key atrule\">interval</span><span class=\"token punctuation\">:</span> 1m30s\n            <span class=\"token key atrule\">timeout</span><span class=\"token punctuation\">:</span> 10s\n            <span class=\"token key atrule\">retries</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n        <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 라벨 추가.</span>\n            <span class=\"token key atrule\">com.example.description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Accounting webapp\"</span>\n            <span class=\"token key atrule\">com.example.department</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Finance\"</span>\n            <span class=\"token key atrule\">com.example.label-with-empty-value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n        <span class=\"token key atrule\">links</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 다른 서비스들의 컨테이너 들과 연결고리를 형성, SERVICE:ALIAS , 주의!! --links 플래그는 레거시 이다. --links 사용을 대신해서 사용자가 정의하는 네트워크 설정을 이용하길 권장한다.</span>\n            <span class=\"token punctuation\">-</span> db\n            <span class=\"token punctuation\">-</span> db<span class=\"token punctuation\">:</span>database\n            <span class=\"token punctuation\">-</span> redis\n        <span class=\"token key atrule\">logging</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 서비스의 로깅 config</span>\n            <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> syslog <span class=\"token comment\"># json-file , syslog , none</span>\n            <span class=\"token key atrule\">options</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">syslog-address</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"tcp://192.168.0.42:123\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token key atrule\">max-size</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"200k\"</span> <span class=\"token comment\"># json-file 의 경우 로그 저장을 제한할 수 있다. 오래된 파일은 지워진다.</span>\n                <span class=\"token key atrule\">max-file</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"10\"</span>\n        <span class=\"token key atrule\">network_mode</span><span class=\"token punctuation\">:</span> bridge <span class=\"token comment\"># 네트워크 모드 설정 , host , none , service:[service name] , container:[container name/id] //// host 모드는 links랑 같이 사용할 수 없다.</span>\n        <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># top level 에서 지정한 네트워크 설정 , 알리아스를 사용할 수 도 있다. 이 알리아스 네임으로 서비스를 연결 할 수 있다.</span>\n            <span class=\"token punctuation\">-</span> some<span class=\"token punctuation\">-</span>network\n            <span class=\"token punctuation\">-</span> other<span class=\"token punctuation\">-</span>network\n            <span class=\"token key atrule\">new</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">aliases</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token punctuation\">-</span> database\n        <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># HOST:CONTAINER</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token string\">\"8000:8000\"</span>\n        <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 호스트 경로 또는 생성된 볼륨을 마운트 시킨다.</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> volume\n            <span class=\"token key atrule\">source</span><span class=\"token punctuation\">:</span> mydata\n            <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> /data\n            <span class=\"token key atrule\">volume</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">nocopy</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> bind\n            <span class=\"token key atrule\">source</span><span class=\"token punctuation\">:</span> ./static\n            <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> /opt/app/static\n\n\n<span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">mydata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">external</span> <span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true </span><span class=\"token comment\"># 컴포즈 밖에 volume이 존재했을때, 없으면 'docker volume create --name=' 으로 만들라고 에러뜸.</span>\n    <span class=\"token key atrule\">name</span> <span class=\"token punctuation\">:</span> actual<span class=\"token punctuation\">-</span>name<span class=\"token punctuation\">-</span>of<span class=\"token punctuation\">-</span>volume <span class=\"token comment\"># 이름을 지정할 수도 있다.</span>\n  <span class=\"token key atrule\">dbdata</span><span class=\"token punctuation\">:</span>\n\nnetworks<span class=\"token punctuation\">:</span></code></pre></div>\n<ul>\n<li>직접 했던 예제</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.2'</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">app_blue</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> blog_express<span class=\"token punctuation\">:</span>v1\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> nginx<span class=\"token punctuation\">-</span>proxy\n      <span class=\"token punctuation\">-</span> mongo<span class=\"token punctuation\">-</span>db\n    <span class=\"token key atrule\">working_dir</span><span class=\"token punctuation\">:</span> /app/\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> dbconnection\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> VIRTUAL_HOST=nodeapp.local\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> bind\n        <span class=\"token key atrule\">source</span><span class=\"token punctuation\">:</span> ./server\n        <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> /app/server\n    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> npm start\n\n  <span class=\"token key atrule\">app_green</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> blog_express<span class=\"token punctuation\">:</span>v1\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> nginx<span class=\"token punctuation\">-</span>proxy\n      <span class=\"token punctuation\">-</span> mongo<span class=\"token punctuation\">-</span>db\n    <span class=\"token key atrule\">working_dir</span><span class=\"token punctuation\">:</span> /app/\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> dbconnection\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> VIRTUAL_HOST=nodeapp.local\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> bind\n        <span class=\"token key atrule\">source</span><span class=\"token punctuation\">:</span> ./server\n        <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> /app/server\n    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> npm start\n\n  <span class=\"token key atrule\">nginx-proxy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> jwilder/nginx<span class=\"token punctuation\">-</span>proxy\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> 8081<span class=\"token punctuation\">:</span><span class=\"token number\">80</span>\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> dbconnection\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/tmp/docker.sock<span class=\"token punctuation\">:</span>ro\n\n  <span class=\"token key atrule\">mongo-db</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mongo\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> nginx<span class=\"token punctuation\">-</span>proxy\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> db<span class=\"token punctuation\">-</span>data<span class=\"token punctuation\">:</span>/data/db\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> dbconnection\n    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> mongod <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>dbpath \"/data/db\"\n\n<span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">db-data</span><span class=\"token punctuation\">:</span>\n\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n  dbconnection<span class=\"token punctuation\">:</span></code></pre></div>\n<hr>\n<h2 id=\"docker-network\" style=\"position:relative;\"><a href=\"#docker-network\" aria-label=\"docker network permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker network</h2>\n<p>출처 : <a href=\"http://bluese05.tistory.com/15\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://bluese05.tistory.com/15</a></p>\n<h3 id=\"network-구성\" style=\"position:relative;\"><a href=\"#network-%EA%B5%AC%EC%84%B1\" aria-label=\"network 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>network 구성</h3>\n<ul>\n<li>도커를 설치 하면 docker host 쪽에 보면 <strong>docker0</strong> 이라는 virtual ethernet bridge 를 확인할 수 있다. ( $ ifconfig 로 확인가능, 난 172.17.0.1 로 셋팅되어 있다.)</li>\n<li>docker0 는 container 가 통신하기 위한 가상 linux bridge 이다. bridge 는 기본적으로 L2 통신 기반이다.</li>\n<li>컨테이너가 하나씩 생성되면 이 bridge 에 하나씩 바인딩 된다. ( $ brctl show docker0 )</li>\n<li>이렇게 연결된 컨테이너와 host 는 케이블로 연결한 두대의 pc 라고 보면 된다.</li>\n<li>컨테이너 내부의 eth0 인터페이스는 내부로 격리되어있어서 이 내부와 host 를 이어줄 vethxxxx 형태의 인터페이스가 하나 더 존재한다. 이 인터페이스가 host 와 컨테이너 사이를 연결해준다.</li>\n<li>컨테이너 내부의 아이피를 확인하려면 ifconfig eth0 라고 치면 되는데 ifconfig 가 잘 안먹는다. 그럴땐 도커 inspect 로 확인하자.</li>\n</ul>\n<h3 id=\"network-확인\" style=\"position:relative;\"><a href=\"#network-%ED%99%95%EC%9D%B8\" aria-label=\"network 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>network 확인</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">ip</span> addr show\nor\n$ <span class=\"token function\">ifconfig</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker attach nonenetcontainer\n<span class=\"token comment\"># 접속후</span>\n$ <span class=\"token function\">cat</span> /etc/hosts\n$ <span class=\"token function\">ip</span> -4 addr</code></pre></div>\n<p>attach 했던걸 detach 하기 위해선 CTRL-p CTRL-q 를 입력하면 된다.</p>\n<h3 id=\"network-방식\" style=\"position:relative;\"><a href=\"#network-%EB%B0%A9%EC%8B%9D\" aria-label=\"network 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>network 방식</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 네트워크 방식 확인하기 ( 드라이버 ) bridge , host , none ( 네임 기준 )</span>\n$ docker network <span class=\"token function\">ls</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 기본 네트워크는 bridge 방식이다.</span>\n<span class=\"token comment\"># 다른방식으로 컨테이너를 생성하고 싶다면</span>\n$ docker run --new<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>네트워크 타입<span class=\"token punctuation\">}</span></code></pre></div>\n<ol>\n<li>\n<p>birdge</p>\n<ul>\n<li>네트워크에서 브릿지란 호스트 서버의 네트워크를 연결하여 가상화된 머신들도 동일한 네트워크를 사용하도록 하는 것이다.</li>\n<li>docker network inspect bridge 로 브릿지 모드의 자세한 내용을 확인 할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>host</p>\n<ul>\n<li>이 방식은 컨테이너가 독립적인 네트워크 영역을 갖지 않고 host 와 네트워크를 함께 사용한다.</li>\n<li>따라서 해당 컨테이너는 host 의 네트워크 정보와 동일시 하게 가져가게 된다.</li>\n<li>따라서 docker0 에 바인딩 되지 않는다.</li>\n</ul>\n</li>\n<li>\n<p>container</p>\n<ul>\n<li>다른 컨테이너의 네트워크 환경을 가져온다. 즉, ip 와 mac 주소를 동일시 하게 구성한다.</li>\n<li>docker run --name web03 --net=container:{컨테이너 id} -d nginx:alpine</li>\n</ul>\n</li>\n<li>\n<p>none</p>\n<ul>\n<li>이 옵션은 격리된 네트워크 환경은 갖지만, 인터페이스가 없는 상태로 컨테이너를 생성하게 된다.</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"container-외부-통신\" style=\"position:relative;\"><a href=\"#container-%EC%99%B8%EB%B6%80-%ED%86%B5%EC%8B%A0\" aria-label=\"container 외부 통신 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>container 외부 통신</h3>\n<ul>\n<li>각 컨테이너는 격리된 환경에서 각각의 mac 주소와 ip 주소를 부여 받는다.</li>\n<li>각 컨테이너들은 host 와 통신하기 위해 bridge 방식으로 바인딩 되어있는데 각 부여받은 ip 로 자유롭게 통신 가능.</li>\n<li>예를 들면 web 서비스를 하는 container 는 80 번 포트에서 리스닝을 하고있다. 이 포트는 외부와 통신이 되어야 하는데 이때 포트를 외부로 지정한다. -p 8080:80 으로 옵션을 주게 되면 docker host 의 8080 포트로 요청이 들어오면 컨테이너의 80 포트로 해당 요청을 forwarding 하겠다는 의미이다.</li>\n<li>docker ps -a or netstat -nlp | grep 8080 로 확인</li>\n</ul>\n<h3 id=\"link-방식의-한계\" style=\"position:relative;\"><a href=\"#link-%EB%B0%A9%EC%8B%9D%EC%9D%98-%ED%95%9C%EA%B3%84\" aria-label=\"link 방식의 한계 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>link 방식의 한계</h3>\n<ul>\n<li>link 방식은 하나의 호스트 사이에서 실행되는 컨테이너 사이에서만 연결이 가능하다.</li>\n<li>다수의 host 가 존재했을때, 다른 host 의 컨테이너에는 접근할 수가 없다.</li>\n<li>이 경우 docker swarm 같은 orchestration 툴을 사용하거나 dynamic DNS 를 구축해야한다.</li>\n</ul>\n<blockquote>\n<p>Warning: >The --link flag is a legacy feature of Docker. It may eventually be removed. Unless you absolutely need to continue using it, we recommend that you use user-defined networks to facilitate communication between two containers instead of using --link. One feature that user-defined networks do not support that you can do with --link is sharing environmental variables between containers. However, you can use other mechanisms such as volumes to share environment variables between containers in a more controlled way.</p>\n</blockquote>\n<p>** dynamic DNS 란? - 간단하게 ip 가 바뀌면 그걸 알아채서 외부 DNS 서버에 알려준다. 그러면 ip 가 동적으로 바뀌는 환경에서도 사용자는 바뀐 ip 를 알 필요 없이 domain name 만 알면 동일하게 접속 할 수 있다.</p>","excerpt":"Docker term What is Docker? 소프트웨어를 containerization(컨테이너화) 한 플랫폼. ( 웹서비스 컨테이너 , 디비 컨테이너 따로 담는다고 하면 서로 isolation…","tableOfContents":"<ul>\n<li>\n<p><a href=\"/ho_blog/hello-docker.md/#docker-term\">Docker term</a></p>\n<ul>\n<li><a href=\"/ho_blog/hello-docker.md/#what-is-docker\">What is Docker?</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#what-is-container\">What is Container?</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#what-is-service\">What is Service?</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#what-is-image\">What is Image?</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#what-is-stack\">What is Stack?</a></li>\n</ul>\n</li>\n<li><a href=\"/ho_blog/hello-docker.md/#docker-structure\">Docker Structure</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#docker-install\">Docker Install</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#docker-use\">Docker use</a></li>\n<li>\n<p><a href=\"/ho_blog/hello-docker.md/#docker-build\">Docker build</a></p>\n<ul>\n<li><a href=\"/ho_blog/hello-docker.md/#dockerfile\">Dockerfile</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#recommendation-dockerfile\">recommendation Dockerfile</a></li>\n</ul>\n</li>\n<li><a href=\"/ho_blog/hello-docker.md/#10-things-to-avoid-in-docker-containers\">10 things to avoid in docker containers</a></li>\n<li>\n<p><a href=\"/ho_blog/hello-docker.md/#docker-app-data-%EA%B4%80%EB%A6%AC%EB%B2%95\">Docker app data 관리법</a></p>\n<ul>\n<li><a href=\"/ho_blog/hello-docker.md/#%ED%98%B8%EC%8A%A4%ED%8A%B8%EC%9D%98-%EC%A7%80%EC%A0%95%EB%90%9C-%ED%8F%B4%EB%8D%94%EB%A5%BC-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%97%90-%EB%8B%A4%EC%9D%B4%EB%A0%89%ED%8A%B8%EB%A1%9C-%EB%A7%88%EC%9A%B4%ED%8A%B8\">호스트의 지정된 폴더를 컨테이너에 다이렉트로 마운트</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#volume-container-%EC%82%AC%EC%9A%A9\">volume container 사용</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#volume-%EC%9C%BC%EB%A1%9C-%EC%82%AC%EC%9A%A9\">volume 으로 사용</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/ho_blog/hello-docker.md/#docker-compose\">Docker compose</a></p>\n<ul>\n<li><a href=\"/ho_blog/hello-docker.md/#docker-compose-%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\">Docker compose 를 사용하는 방법</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#docker-compose-config\">Docker compose config</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/ho_blog/hello-docker.md/#docker-network\">Docker network</a></p>\n<ul>\n<li><a href=\"/ho_blog/hello-docker.md/#network-%EA%B5%AC%EC%84%B1\">network 구성</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#network-%ED%99%95%EC%9D%B8\">network 확인</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#network-%EB%B0%A9%EC%8B%9D\">network 방식</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#container-%EC%99%B8%EB%B6%80-%ED%86%B5%EC%8B%A0\">container 외부 통신</a></li>\n<li><a href=\"/ho_blog/hello-docker.md/#link-%EB%B0%A9%EC%8B%9D%EC%9D%98-%ED%95%9C%EA%B3%84\">link 방식의 한계</a></li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/hello-docker.md/"},"frontmatter":{"title":"Hello Docker","date":"Jan 09, 2018","tags":["undefined"],"keywords":["Merlin Tech Blog","Merlin.ho"],"update":"Jan 01, 0001"}}},"pageContext":{"slug":"/hello-docker.md/","series":[],"lastmod":"0001-01-01"}}}