<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/ho_blog/component---src-layouts-index-js-60e98b905b7a1c56256e.js" as="script"/><link rel="preload" href="/ho_blog/component---src-templates-blog-post-js-dabe65ee189101b630a0.js" as="script"/><link rel="preload" href="/ho_blog/path---build-react-8fe160cba69ecb4070e4.js" as="script"/><link rel="preload" href="/ho_blog/app-00a132d46dd380b9cb63.js" as="script"/><link rel="preload" href="/ho_blog/commons-241c3561f1c9cf4619a9.js" as="script"/><style id="glamor-styles"></style><script id="glamor-ids">
        // <![CDATA[
        window._glamor = []
        // ]]>
        </script><link rel="alternate" type="application/rss+xml" href="/ho_blog/rss.xml"/><title data-react-helmet="true">build-react | Merlin Tec Blog</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:106.25%/1.53 'Source Sans Pro',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Source Sans Pro',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;color:inherit;font-family:'Merriweather',serif;font-weight:700;text-rendering:optimizeLegibility;font-size:2rem;line-height:2.295rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;color:inherit;font-family:'Merriweather',serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:2.295rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;color:inherit;font-family:'Merriweather',serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.1487rem;line-height:1.53rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;color:inherit;font-family:'Merriweather',serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.53rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;color:inherit;font-family:'Merriweather',serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.917rem;line-height:1.53rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;color:inherit;font-family:Source Sans Pro,sans-serif;font-weight:400;text-rendering:optimizeLegibility;font-size:0.8409rem;line-height:1.53rem;text-transform:uppercase;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}ul{margin-left:1.53rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.53rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;font-size:0.85rem;line-height:1.42;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.53rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;font-size:1rem;line-height:1.53rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}blockquote{margin-left:1.53rem;margin-right:1.53rem;margin-top:0;padding-bottom:0.51rem;padding-left:1.02rem;padding-right:1.02rem;padding-top:0.51rem;margin-bottom:1.53rem;font-size:1.18921rem;line-height:1.53rem;border-left:0.255rem solid;border-color:hsla(0,0%,0%,0.07);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.53rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.53rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.53rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.53rem;margin-bottom:calc(1.53rem / 2);margin-top:calc(1.53rem / 2);}li > ul{margin-left:1.53rem;margin-bottom:calc(1.53rem / 2);margin-top:calc(1.53rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.53rem / 2);}code{font-size:0.85rem;line-height:1.53rem;}kbd{font-size:0.85rem;line-height:1.53rem;}samp{font-size:0.85rem;line-height:1.53rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.02rem;padding-right:1.02rem;padding-top:0.765rem;padding-bottom:calc(0.765rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;}pre code{background:none;line-height:1.42;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:"Â ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:none;}a{color:#0071bc;text-decoration:none;}a:visited{color:#4c2c92;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.53rem;color:hsla(204,5.275997423999999%,0%,0.46);font-weight:400;font-style:normal;}div.gatsby-highlight{margin-bottom:20px;}</style><link href="//fonts.googleapis.com/css?family=Merriweather:700|Source+Sans+Pro:400,400i,700" rel="stylesheet" type="text/css"/><style id="gatsby-inlined-css">.editor .wrap-guide{background:hsla(0,0%,100%,.1)}.editor .indent-guide{color:hsla(0,0%,100%,.15)}.editor,.editor .gutter{background-color:#282828;color:#f8f8f2}.editor.is-focused .cursor{border-color:#f8f8f0}.editor.is-focused .line-number.cursor-line-no-selection,.editor.is-focused .selection .region{background-color:#49483e}.editor .invisible-character{color:hsla(0,0%,84%,.15)}.editor .comment{color:#75715e}.editor .string{color:#e6db74}.editor .constant.character,.editor .constant.language,.editor .constant.numeric,.editor .constant.other{color:#ae81ff}.editor .keyword,.editor .storage{color:#f92672}.editor .storage.type{font-style:italic;color:#66d9ef}.editor .entity.name.class,.editor .entity.other.inherited-class{text-decoration:underline;color:#a6e22e}.editor .entity.other.inherited-class{font-style:italic}.editor .entity.name.function{color:#a6e22e}.editor .entity.name.instance{color:#66d9ef}.editor .variable.parameter{font-style:italic;color:#fd971f}.editor .entity.name.tag{color:#f92672}.editor .entity.other.attribute-name{color:#a6e22e}.editor .support.constant,.editor .support.function{color:#66d9ef}.editor .support.class,.editor .support.type{font-style:italic;color:#66d9ef}.editor .invalid{color:#f8f8f0;background-color:#f92672}.editor .invalid.deprecated{color:#f8f8f0;background-color:#ae81ff}.editor .class.jade{color:#ae81ff}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/ho_blog/static/montserrat-latin-100.50d27986.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-100.5e334eff.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/ho_blog/static/montserrat-latin-100italic.8c070533.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-100italic.03e19243.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/ho_blog/static/montserrat-latin-200.4343d3d9.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-200.f2022ecd.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/ho_blog/static/montserrat-latin-200italic.116c4c4b.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-200italic.89614a60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/ho_blog/static/montserrat-latin-300.d2ad295b.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-300.3a371ee0.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/ho_blog/static/montserrat-latin-300italic.f6b6bf24.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-300italic.16521668.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/ho_blog/static/montserrat-latin-400.240a8444.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-400.b20cc131.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/ho_blog/static/montserrat-latin-400italic.86172bb8.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-400italic.9405e787.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/ho_blog/static/montserrat-latin-500.fb8d6b71.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-500.50825d47.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/ho_blog/static/montserrat-latin-500italic.c0a555a4.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-500italic.635de59c.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/ho_blog/static/montserrat-latin-600.d5615136.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-600.f300da4f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/ho_blog/static/montserrat-latin-600italic.10f29d13.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-600italic.2bc37d86.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/ho_blog/static/montserrat-latin-700.7d77e1f0.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-700.81826529.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/ho_blog/static/montserrat-latin-700italic.1dd2b53f.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-700italic.c162d257.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/ho_blog/static/montserrat-latin-800.d4e7bf86.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-800.895aadbf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/ho_blog/static/montserrat-latin-800italic.fc0cbe44.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-800italic.b3362875.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/ho_blog/static/montserrat-latin-900.c8bdd772.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-900.1b99ef78.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/ho_blog/static/montserrat-latin-900italic.cb72c1f9.woff2) format("woff2"),url(/ho_blog/static/montserrat-latin-900italic.b78bb9f8.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/ho_blog/static/merriweather-latin-300.f015f1e9.woff2) format("woff2"),url(/ho_blog/static/merriweather-latin-300.92dfe81b.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/ho_blog/static/merriweather-latin-300italic.7fd86b32.woff2) format("woff2"),url(/ho_blog/static/merriweather-latin-300italic.878b76f5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/ho_blog/static/merriweather-latin-400.12dbf4c0.woff2) format("woff2"),url(/ho_blog/static/merriweather-latin-400.1fffad22.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/ho_blog/static/merriweather-latin-400italic.1e0d3e81.woff2) format("woff2"),url(/ho_blog/static/merriweather-latin-400italic.de18d4c4.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/ho_blog/static/merriweather-latin-700.dc8fec81.woff2) format("woff2"),url(/ho_blog/static/merriweather-latin-700.d7d2ed8e.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/ho_blog/static/merriweather-latin-700italic.b7b7e5da.woff2) format("woff2"),url(/ho_blog/static/merriweather-latin-700italic.6210a5fc.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/ho_blog/static/merriweather-latin-900.43f870d5.woff2) format("woff2"),url(/ho_blog/static/merriweather-latin-900.8f3806df.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/ho_blog/static/merriweather-latin-900italic.168c1ab2.woff2) format("woff2"),url(/ho_blog/static/merriweather-latin-900italic.ae7778f0.woff) format("woff")}</style></head><body><div id="___gatsby"><div style="max-width:52.02rem;margin-left:auto;margin-right:auto;padding:2.295rem 1.1475rem;" data-reactroot="" data-reactid="1" data-react-checksum="-28292591"><h3 style="font-family:Montserrat, sans-serif;margin-top:0;" data-reactid="2"><a style="box-shadow:none;text-decoration:none;color:inherit;" href="/ho_blog/" data-reactid="3">Merlin Tec Blog</a></h3><div data-reactid="4"><!-- react-empty: 5 --><h1 data-reactid="6">build-react</h1><p style="font-size:0.87055rem;line-height:1.53rem;display:block;margin-bottom:1.53rem;margin-top:-1.53rem;" data-reactid="7">June 03, 2018</p><div data-reactid="8"><p>ì´ ê¸ì ìë ë§í¬ì ìë ê¸ì ì°¸ì¡° íìµëë¤.
<a href="https://engineering.hexacta.com/didact-learning-how-react-works-by-building-it-from-scratch-51007984e5c5">ì°¸ì¡°</a></p>
<h2>Rendering DOM element</h2>
<p>ì°ë¦¬ê° render í  ë íìíê² ë­ì§ ì¤ëªíë plain JS object ë¥¼ íë ë§ë¤ ê²ì´ë¤.
ì´ê²ì ì°ë¦¬ë element ë¼ê³  ë¶ë¥¼ ê²ì´ë¤. ì¬ê¸°ìë <code>type</code> ê³¼ <code>props</code>ë¼ë 2 ê°ì íë¡í¼í°ê° ìêµ¬ëë¤.
<code>type</code>ì ê¸°ë³¸ string ëë function ì´ ë  ì ìê³ , props ë ë¹ì´ìì ì ìë ê°ì²´ê° ë ê²ì´ë¤. null ì ì¤ì§ ìëë¤. ì¬ê¸°ì props ë children ì´ë¼ë íë¡í¼í°ë ê°ì§ ê²ì´ë¤. children ì ë°°ì´ë¡ êµ¬ì±ë  ê²ì´ë¤.</p>
<p>ìë¥¼ ë¤ë©´ ìëì ê°ë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>const&nbsp;element&nbsp;=&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;type:&nbsp;&#39;div&#39;,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;props:&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;id:&nbsp;&#39;container&#39;,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;children:&nbsp;[</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;type:&nbsp;&#39;input&#39;,&nbsp;props:&nbsp;{&nbsp;value:&nbsp;&#39;foo&#39;,&nbsp;type:&nbsp;&#39;text&#39;&nbsp;}&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;type:&nbsp;&#39;a&#39;,&nbsp;props:&nbsp;{&nbsp;href:&nbsp;&#39;/bar&#39;&nbsp;}&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;type:&nbsp;&#39;span&#39;,&nbsp;props:&nbsp;{}&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;],</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì ê°ì²´ë ìë dom ì ì¤ëªíë ê²ì´ ëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text html basic"><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag block any html"><span>div</span></span><span>&nbsp;</span><span class="meta attribute-with-value id html"><span class="entity other attribute-name id html"><span>id</span></span><span class="punctuation separator key-value html"><span>=</span></span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span class="meta toc-list id html"><span>container</span></span><span class="punctuation definition string end html"><span>&quot;</span></span></span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;</span><span class="meta tag inline any html"><span class="punctuation definition tag begin html"><span>&lt;</span></span><span class="entity name tag inline any html"><span>input</span></span><span>&nbsp;</span><span class="entity other attribute-name html"><span>value</span></span><span>=</span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span>foo</span><span class="punctuation definition string end html"><span>&quot;</span></span></span><span>&nbsp;</span><span class="entity other attribute-name html"><span>type</span></span><span>=</span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span>text</span><span class="punctuation definition string end html"><span>&quot;</span></span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;</span><span class="meta tag any html"><span class="punctuation definition tag html"><span>&lt;</span></span><span class="entity name tag html"><span>a</span></span><span>&nbsp;</span><span class="entity other attribute-name html"><span>href</span></span><span>=</span><span class="string quoted double html"><span class="punctuation definition string begin html"><span>&quot;</span></span><span>/bar</span><span class="punctuation definition string end html"><span>&quot;</span></span></span><span class="punctuation definition tag html"><span>&gt;</span><span class="meta scope between-tag-pair html"><span>&lt;</span></span><span>/</span></span><span class="entity name tag html"><span>a</span></span><span class="punctuation definition tag html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span>&nbsp;&nbsp;</span><span class="meta tag any html"><span class="punctuation definition tag html"><span>&lt;</span></span><span class="entity name tag html"><span>span</span></span><span class="punctuation definition tag html"><span>&gt;</span><span class="meta scope between-tag-pair html"><span>&lt;</span></span><span>/</span></span><span class="entity name tag html"><span>span</span></span><span class="punctuation definition tag html"><span>&gt;</span></span></span></span></div><div class="line"><span class="text html basic"><span class="meta tag block any html"><span class="punctuation definition tag begin html"><span>&lt;/</span></span><span class="entity name tag block any html"><span>div</span></span><span class="punctuation definition tag end html"><span>&gt;</span></span></span></span></div></pre>
<p>ë³´íµ element ë¥¼ ì ì²ë¼ ë§ë¤ì§ ìê³  <code>createElement</code>ë¥¼ ì¬ì©í´ì ë§ë¤ê¸°ì ì°ë¦¬ë íë ë§ë¤ì´ ë³¼ ê²ì´ë¤.
ê·¸ë¬ê¸° ì ì í´ë¹ element ë¥¼ ë°ììë ì¤ì  dom ì render íë í¨ìë¥¼ ë§ë¤ì´ ë³´ì.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;render(element,&nbsp;parentDom)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;{&nbsp;type,&nbsp;props&nbsp;}&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;dom&nbsp;=&nbsp;document.createElement(type)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childElement&nbsp;=&nbsp;props.children&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;childElement.forEach(childElement&nbsp;=&gt;&nbsp;render(childElement,&nbsp;dom))</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;parentDom.appendChild(dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>render(element,&nbsp;document.getElementById(&#39;root&#39;))</span></span></div></pre>
<p>ììì ë¹ ë¨ë¦° ë¶ë¶ì´ ìë¤ë©´ íë¡í¼í°ë¤ê³¼ ì´ë²¤í¸ ë¦¬ì¤ëì´ë¤. ë¹ ë¨ë¦° ë¶ë¶ë¤ì ë¤ì ìì±í´ ë³´ì.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;render(element,&nbsp;parentDom)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;{&nbsp;type,&nbsp;props&nbsp;}&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;dom&nbsp;=&nbsp;document.createElement(type)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;start</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isListener&nbsp;=&nbsp;name&nbsp;=&gt;&nbsp;name.startWith(&#39;on&#39;)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;Object.keys(props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(isListener)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.forEach(name&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;eventType&nbsp;=&nbsp;name.toLowerCase().substring(2)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom.addEventListener(eventType,&nbsp;props[name])</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isAttribute&nbsp;=&nbsp;name&nbsp;=&gt;&nbsp;!isListener(name)&nbsp;&amp;&amp;&nbsp;name&nbsp;!=&nbsp;&#39;children&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;Object.keys(props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(isAttribute)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.forEach(name&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom[name]&nbsp;=&nbsp;props[name]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;end</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childElement&nbsp;=&nbsp;props.children&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;childElement.forEach(childElement&nbsp;=&gt;&nbsp;render(childElement,&nbsp;dom))</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;parentDom.appendChild(dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ë¤ìì DOM ì Text Nodes ë¥¼ render íë ë°©ë²ì´ë¤.
ì¬ê¸°ì Text Node ë¥¼ íííë ë°©ë²ì children ë°°ì´ì element ê°ì²´ê° ìë plain text ê° ë¤ì´ê° ê²½ì°ê° ëê² ë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>const&nbsp;reactElement&nbsp;=&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;type:&nbsp;&#39;span&#39;,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;props:&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;children:&nbsp;[&#39;Foo&#39;],</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>íì§ë§ ì¬ê¸°ì children ë°°ì´ì type ê³¼ props ê° ë¤ì´ê° ê°ì²´ë§ ì¨ë¤ë ë£°ì ê°ì§ê³  ìì¼ë©´ ì°ë¦° ë ì ì if ë¬¸ì ë§ë¤ ì ìì ê²ì´ë¤. í´ì text íìì âTEXT ELEMENTâ ë¼ê³  props ìë nodeValue ë¼ë íë¡í¼í°ë¥¼ ê°ê² ë§ë¤ì.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>const&nbsp;textElement&nbsp;=&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;type:&nbsp;&#39;span&#39;,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;props:&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;children:&nbsp;[</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;&#39;TEXT_ELEMENT&#39;,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;props:&nbsp;{&nbsp;nodeValue:&nbsp;&#39;Foo&#39;&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;],</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì¬ê¸°ì ì°ë¦¬ê° ì ìí text element ëë¡ render íë í¨ìë¥¼ ë¤ì ìì í´ë³´ì. ì¬ê¸°ì ë¬ë¼ì§ë ì ì´ ìë¤ë©´ ì¼ë° dom type ì¼ ê²½ì°ìë <code>createElement</code> ì dom api ë¥¼ ì¼ìíë° text ë <code>createTextNode</code> ë¼ë dom api ë¥¼ ì¬ì©íì.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;render(element,&nbsp;parentDom)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;{&nbsp;type,&nbsp;props&nbsp;}&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Create&nbsp;DOM&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isTextElement&nbsp;=&nbsp;type&nbsp;===&nbsp;&#39;TEXT&nbsp;ELEMENT&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;dom&nbsp;=&nbsp;isTextElement</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;?&nbsp;document.createTextNode(&#39;&#39;)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;document.createElement(type)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Add&nbsp;event&nbsp;listeners</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isListener&nbsp;=&nbsp;name&nbsp;=&gt;&nbsp;name.startsWith(&#39;on&#39;)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;Object.keys(props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(isListener)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.forEach(name&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;eventType&nbsp;=&nbsp;name.toLowerCase().substring(2)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom.addEventListener(eventType,&nbsp;props[name])</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Set&nbsp;properties</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;ì¬ê¸°ì&nbsp;nodeValueë&nbsp;ìííë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isAttribute&nbsp;=&nbsp;name&nbsp;=&gt;&nbsp;!isListener(name)&nbsp;&amp;&amp;&nbsp;name&nbsp;!==&nbsp;&#39;children&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;Object.keys(props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(isAttribute)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.forEach(name&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom[name]&nbsp;=&nbsp;props[name]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Render&nbsp;children</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childElements&nbsp;=&nbsp;props.children&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;childElements.forEach(childElement&nbsp;=&gt;&nbsp;render(childElement,&nbsp;dom))</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Append&nbsp;to&nbsp;parent</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;parentDom.appendChild(dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<h2>Element creation and JSX</h2>
<p>ì Element ë¥¼ ì¢ ë ì½ê² ë§ë¤ê¸° ìí´ JSX ë¥¼ ì¬ì©íë©´ ì½ê² ì½íë©´ìë ì½ê² ííì´ ëë¤. ì¬ê¸°ì JSX ë ì°ë¦¬ê° DOM ì ë¬´ìì íííê³  ì¶ìì§ë¥¼ ì¤ëªí´ì£¼ë í ë°©ë²ì´ë¤.</p>
<p>ë°ë²¨ì ì¬ì©íë¤ë©´ JSX ííì ë¤ìê³¼ ê°ì´ ë³ê²½ëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>const&nbsp;element&nbsp;=&nbsp;(</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&lt;div&nbsp;id=&quot;container&quot;&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;value=&quot;foo&quot;&nbsp;type=&quot;text&quot;&nbsp;/&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;href=&quot;/bar&quot;&gt;bar&lt;/a&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;onClick={e&nbsp;=&gt;&nbsp;alert(&#39;Hi&#39;)}&gt;click&nbsp;me&lt;/span&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&lt;/div&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>)</span></span></div></pre>
<p><a href="https://babeljs.io/repl/#?babili=false&#x26;evaluate=true&#x26;lineWrap=false&#x26;presets=react&#x26;targets=&#x26;browsers=&#x26;builtIns=false&#x26;debug=false&#x26;code=%2F**%20%40jsx%20createElement%20*%2F%0A%0Aconst%20element%20%3D%20%28%0A%20%20%3Cdiv%20id%3D%22container%22%3E%0A%20%20%20%20%3Cinput%20value%3D%22foo%22%20type%3D%22text%22%20%2F%3E%0A%20%20%20%20%3Ca%20href%3D%22%2Fbar%22%3Ebar%3C%2Fa%3E%0A%20%20%20%20%3Cspan%20onClick%3D%7Be%20%3D%3E%20alert%28%22Hi%22%29%7D%3Eclick%20me%3C%2Fspan%3E%0A%20%20%3C%2Fdiv%3E%0A%29%3B">try it on babel REPL</a></p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>const&nbsp;element&nbsp;=&nbsp;createElement(</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&#39;div&#39;,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;{&nbsp;id:&nbsp;&#39;container&#39;&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;createElement(&#39;input&#39;,&nbsp;{&nbsp;value:&nbsp;&#39;foo&#39;,&nbsp;type:&nbsp;&#39;text&#39;&nbsp;}),</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;createElement(&#39;a&#39;,&nbsp;{&nbsp;href:&nbsp;&#39;/bar&#39;&nbsp;},&nbsp;&#39;bar&#39;),</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;createElement(&#39;span&#39;,&nbsp;{&nbsp;onClick:&nbsp;e&nbsp;=&gt;&nbsp;alert(&#39;Hi&#39;)&nbsp;},&nbsp;&#39;click&nbsp;me&#39;)</span></span></div><div class="line"><span class="text plain null-grammar"><span>)</span></span></div></pre>
<p>ê·¸ëì ì°ë¦° createElement í¨ìë¥¼ ë§ë¤ì´ ì¤ ê²ì´ë¤. ì²«ë²ì§¸ ì¸ìë type ì¸ìì´ê³  ëë²ì§¸ ì¸ìë props ì´ë¤. ê·¸ë¦¬ê³  ëë¨¸ì§ ì¸ìë¤ì children ì´ë¤.
createElement í¨ìë props ê°ì²´ë¥¼ ë§ë¤ì´ì£¼ê³  ëë²ì§¸ ì¸ìì ê°ë¤ì ì ë¶ í ë¹í´ ì£¼ì´ì¼ íë¤. ë, children íë¡í¼í°ë ëë²ì§¸ ì´íë¡ ì¤ë ì¸ìë¤ì ë°°ì´ë¡ ë§ë¤ì´ì props ì children ì ìíí´ì¤ë¤. ê·¸ë¦¬ê³  type ê³¼ props ë¥¼ ë°ííë©´ ëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;createElement(type,&nbsp;props,&nbsp;...args)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;props&nbsp;=&nbsp;Object.assign({},&nbsp;config)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;hasChildren&nbsp;=&nbsp;args.length&nbsp;&gt;&nbsp;0</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;props.children&nbsp;=&nbsp;hasChildren&nbsp;?&nbsp;[].concat(...args)&nbsp;:&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;{&nbsp;type,&nbsp;props&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì createElement í¨ììì text node ì í´ë¹íëê² íë ë¹ ì ¸ìë¤. ì í¨ìëë¡ ìëì íë¤ë©´ ìë span ì text node ì ê²½ì°ì ê·¸ë¥ string ê°ì´ ë¤ì´ê° ê²ì´ë¤.</p>
<p>ìê¹ ì°ë¦° ììì text node ë <code>{ type: TEXT_ELEMENT, props: {nodeValue: 'test'}}</code> ë¡ ë§ë¤ì´ ì£¼ê¸°ë¡ íìë¤. í´ì createElement ë¥¼ ìì í´ì¼ íë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>const&nbsp;spanElement&nbsp;=&nbsp;createElement(</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&#39;span&#39;,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;{&nbsp;onClick:&nbsp;e&nbsp;=&gt;&nbsp;alert(&#39;Hi&#39;)&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&#39;click&nbsp;me&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>spanElement&nbsp;=&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;type:&nbsp;&#39;span&#39;,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;props:&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;onClick:&nbsp;e&nbsp;=&gt;&nbsp;alert(&#39;Hi&#39;),</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;children:&nbsp;[&#39;click&nbsp;me&#39;],&nbsp;//&nbsp;[{type:&nbsp;TEXT_ELEMTN,&nbsp;props:&nbsp;{nodeValue:&nbsp;&#39;click&nbsp;me&#39;}}]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ìì í´ ë³´ì.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>const&nbsp;TEXT_ELEMENT&nbsp;=&nbsp;&#39;TEXT&nbsp;ELEMENT&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;createElement(type,&nbsp;config,&nbsp;...args)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;props&nbsp;=&nbsp;Object.assign({},&nbsp;config)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;hasChildren&nbsp;=&nbsp;args.length&nbsp;&gt;&nbsp;0</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;rawChildren&nbsp;=&nbsp;hasChildren&nbsp;?&nbsp;[].concat(...args)&nbsp;:&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;children&nbsp;ë°°ì´ì&nbsp;ëë©´ì&nbsp;textElementë&nbsp;TEXT&nbsp;ELEMENT&nbsp;íìì¼ë¡&nbsp;ë³íí´ì&nbsp;ë£ì´ì¤ë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;props.children&nbsp;=&nbsp;rawChildren</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(c&nbsp;=&gt;&nbsp;c&nbsp;!=&nbsp;null&nbsp;&amp;&amp;&nbsp;c&nbsp;!==&nbsp;false)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.map(c&nbsp;=&gt;&nbsp;(c&nbsp;instanceof&nbsp;Object&nbsp;?&nbsp;c&nbsp;:&nbsp;createTextElement(c)))</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;{&nbsp;type,&nbsp;props&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;createTextElement(value)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;createElement(TEXT_ELEMENT,&nbsp;{&nbsp;nodeValue:&nbsp;value&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<h2>Instances, reconciliation and virtual DOM</h2>
<p>ì´ë²ìë DOM ì ì´ë»ê² ìë°ì´í¸ ìí¤ëì§ì ëí´ì í¬ì»¤ì¤ë¥¼ ëì.
ì°ì  setState ë¥¼ ì¤ëªíê¸° ì ê¹ì§ dom update ë¥¼ í ì ìë ë°©ë²ì ë¬ë¼ì§ element ë¥¼ ê°ì§ê³  render í¨ìë¥¼ ë°ë³µí´ì ìí¤ë ë°©ë²ì´ë¤.</p>
<p>ê¸°ì¡´ render ë ì¤ì  DOM ì ë§ë¤ì´ì appendChild ë¥¼ íë ë°©ìì´ë¼ì update ì ì í©íì§ê° ìë¤.
ê·¸ëì ì²ìì¼ë¡ ë°ê¿ì¼ í  ë¶ë¶ì dom ì replace íë ììì´ê³ , render í¨ì ë§ì§ë§ ë¶ë¶ì parent dom ì´ child dom ì ê°ì§ê³  ìëì§ íì¸íë¤. ë§ì½ ê·¸ë ë¤ë©´ ìë¡ì´ element ë¡ ë§ë  dom ì replace í´ì¤ë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;render(element,&nbsp;parentDom)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;...</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Create&nbsp;dom&nbsp;from&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;...</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Append&nbsp;or&nbsp;replace&nbsp;dom</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(!parentDom.lastChild)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.appendChild(dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.replaceChild(dom,&nbsp;parentDom.lastChild)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>íì§ë§ ì¢ ë ë³µì¡í ì¼ì´ì¤ììë ëª¨ë  child node ë¤ì ì¬ ìì± íë í¼í¬ë¨¼ì¤ ë¹ì©ì´ ë§ì¡±ì¤ë½ì§ ìëë¤.
ê·¸ëì ì°ë¦° íì¬ ìë¡ ìì±í elements tree ì ì´ì  render ë¥¼ í¸ì¶íì ë ì¬ì©ëìë element tree ë¥¼ ë¹êµí´ì ë¬ë¼ì§ ê³³ë§ update ìì¼ì¼ íë¤.</p>
<h3>Virtual DOM and Reconciliation</h3>
<p>React ììë ììì ë§í ë¬ë¼ì§ ê³³ì ë¹êµíëê² ì´ âdiffingâ íë¡ì¸ì±ì <strong>reconciliation</strong> ì´ë¼ ë¶ë¦ëë¤. ì°ë¦¬ë ì´ìê°ì´ íê¸° ìí´ì ì´ì  render ì ì¬ì© ëìë element tree êµ¬ì¡°ë¥¼ ë³´ê´í  íìê° ìê³  ì´ê²ì ìë¡ì´ element tree êµ¬ì¡°ì ë¹êµí  ê²ìëë¤. ë¤ë¥¸ë§ë¡ íë©´ ì°ë¦¬ì virtual DOM ë²ì ¼ì ê³ì ì ì§í´ ëê° ê²ì´ë¤.</p>
<p>virtual DOM ìì ìë ë¸ëë¤ì ë¬´ìì í´ì¼ í ê¹ì? ì´ë¯¸ ê·¸ê²ì element ë¡ ì¬ì©ì íê³  ìê³  element ë¤ì <code>props.children</code> íë¡í¼í°ë¥¼ ì´ë¯¸ ê°ì§ê³  ìë¤. ì´ íë¡í¼í°ë tree êµ¬ì¡° ì²ë¼ element ë¤ íìì ê°ë¥íê² íë¤. íì§ë§ ì¬ê¸°ì 2 ê°ì§ ë¬¸ì ì ì´ ìëë°, íëë reconciliation ì ì¢ ë ì½ê² ì§ííê¸° ìí´ì ê° ë¸ëì virtual DOM ì ì¤ì  DOM reference ë¥¼ ê°ì§ê³  ìì´ì¼ íë¤ë ì ì´ê³ , element ë¤ì immutable íê² ì ì§í´ì¼ íë¤. ëë²ì§¸ ë¬¸ì ë ì°ë¦¬ë ëì¤ì ë³¸ì¸ë§ì state ë¥¼ ê°ê³  ìë Components ë¥¼ ì§ìí´ì¼íê³  element ë¤ì´ ê·¸ê²ì ë¤ë£¨ì§ ëª»íê² í´ì¼íë¤.</p>
<h3>Instances</h3>
<p>ê·¸ëì ì°ë¦¬ë ìë¡ì´ ì©ì´ì¸ Instances ë¥¼ ìê°íê² ë¤. instance ë DOM ì ë ëë§ ë element ë¥¼ ëíëëë¤. ëí element, dom, ê·¸ë¦¬ê³  childInstances ë¥¼ ì§ë plain ê°ì²´ ìëë¤. childInstances ë element children ì instancese ë¤ì ì§ë ë°°ì´ìëë¤.</p>
<p>ê° DOM ë¸ëë ë§¤ì¹­ë instance ë¥¼ ê°ì§ê³  ìì ê²ìëë¤. reconciliation ìê³ ë¦¬ì¦ì íê°ì§ ëª©íë ê°ë¥íí ë§ì´ instance ë¥¼ creating ëë removing ì í¼íë ê²ìëë¤.
ì¬ê¸°ì instance ë¥¼ creating ê·¸ë¦¬ê³  removing íë¤ë ê²ì DOM tree ë¥¼ ìì í´ì¼ íë¤ë ìë¯¸ ì¼ ê²ìëë¤.
instance ë¥¼ ì¬ì¬ì©í ìë¡ DOM í¸ë¦¬ë¥¼ ìì íë íìê° ì¤ì´ ë­ëë¤.</p>
<h3>Refactoring</h3>
<p>ì¬ê¸°ì ì°ë¦¬ render í¨ìë¥¼ reconciliation ìê³ ë¦¬ì¦ì ì ì©í´ë³´ê³ , element ë¥¼ ì£¼ì´ì§ë©´ instance ë¥¼ ìì±íë instantiate í¨ìë¥¼ ì¶ê°í´ë³´ì.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>let&nbsp;rootInstance&nbsp;=&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;render(element,&nbsp;container)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;prevInstance&nbsp;=&nbsp;rootInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;nextInstance&nbsp;=&nbsp;reconcile(container,&nbsp;prevInstance,&nbsp;element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;rootInstance&nbsp;=&nbsp;nextInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;reconcile(parentDom,&nbsp;instance,&nbsp;element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;ë¶ëª¨&nbsp;real&nbsp;DOM,&nbsp;ì´ì &nbsp;instance&nbsp;,&nbsp;ìë¡ì´&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(instance&nbsp;==&nbsp;null)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ì´ê¸°&nbsp;render&nbsp;ì</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newInstance&nbsp;=&nbsp;instantiate(element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.appendChild(newInstance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;update&nbsp;render&nbsp;ì</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newInstance&nbsp;=&nbsp;instantiate(element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.replaceChild(newInstance.dom,&nbsp;instance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;instantiate(element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;{&nbsp;type,&nbsp;props&nbsp;}&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Create&nbsp;DOM&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isTextElement&nbsp;=&nbsp;type&nbsp;===&nbsp;&#39;TEXT&nbsp;ELEMENT&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;dom&nbsp;=&nbsp;isTextElement</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;?&nbsp;document.createTextNode(&#39;&#39;)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;document.createElement(type)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Add&nbsp;event&nbsp;listeners</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isListener&nbsp;=&nbsp;name&nbsp;=&gt;&nbsp;name.startsWith(&#39;on&#39;)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;Object.keys(props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(isListener)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.forEach(name&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;eventType&nbsp;=&nbsp;name.toLowerCase().substring(2)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom.addEventListener(eventType,&nbsp;props[name])</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Set&nbsp;properties</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isAttribute&nbsp;=&nbsp;name&nbsp;=&gt;&nbsp;!isListener(name)&nbsp;&amp;&amp;&nbsp;name&nbsp;!=&nbsp;&#39;children&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;Object.keys(props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(isAttribute)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.forEach(name&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom[name]&nbsp;=&nbsp;props[name]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Instantiate&nbsp;and&nbsp;append&nbsp;children</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childElements&nbsp;=&nbsp;props.children&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childInstances&nbsp;=&nbsp;childElements.map(instantiate)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childDoms&nbsp;=&nbsp;childInstances.map(childInstance&nbsp;=&gt;&nbsp;childInstance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;childDoms.forEach(childDom&nbsp;=&gt;&nbsp;dom.appendChild(childDom))</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;instance&nbsp;=&nbsp;{&nbsp;dom,&nbsp;element,&nbsp;childInstances&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì´ì ê³¼ ì½ëë ê°ì§ë§, ì¬ê¸°ì ë¤ë¥¸ì ì ë§ì§ë§ì¼ë¡ í¸ì¶í render ìì ëì¨ instance ë¥¼ ì ì¥íê³  ìë¤ëì ì´ë¤.
dom nodes ë¥¼ ì¬ì¬ì©íê¸° ìí´ìë, dom íë¡í¼í°ë¤ì update í  ë°©ë²ì´ íìíë¤. ( className, style, onCLick, etcâ¦) ê·¸ëì dom íë¡í¼í°ë¥¼ update íë í¨ìë¥¼ ìì±í´ë³´ì.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;instantiate(element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;{&nbsp;type,&nbsp;props&nbsp;}&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Create&nbsp;DOM&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isTextElement&nbsp;=&nbsp;type&nbsp;===&nbsp;&#39;TEXT&nbsp;ELEMENT&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;dom&nbsp;=&nbsp;isTextElement</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;?&nbsp;document.createTextNode(&#39;&#39;)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;document.createElement(type)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;updateDomProperties(dom,&nbsp;[],&nbsp;props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Instantiate&nbsp;and&nbsp;append&nbsp;children</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childElements&nbsp;=&nbsp;props.children&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childInstances&nbsp;=&nbsp;childElements.map(instantiate)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childDoms&nbsp;=&nbsp;childInstances.map(childInstance&nbsp;=&gt;&nbsp;childInstance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;childDoms.forEach(childDom&nbsp;=&gt;&nbsp;dom.appendChild(childDom))</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;instance&nbsp;=&nbsp;{&nbsp;dom,&nbsp;element,&nbsp;childInstances&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;updateDomProperties(dom,&nbsp;prevProps,&nbsp;nextProps)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isEvent&nbsp;=&nbsp;name&nbsp;=&gt;&nbsp;name.startsWith(&#39;on&#39;)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isAttribute&nbsp;=&nbsp;name&nbsp;=&gt;&nbsp;!isEvent(name)&nbsp;&amp;&amp;&nbsp;name&nbsp;!=&nbsp;&#39;children&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Remove&nbsp;event&nbsp;listeners</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;Object.keys(prevProps)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(isEvent)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.forEach(name&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;eventType&nbsp;=&nbsp;name.toLowerCase().substring(2)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom.removeEventListener(eventType,&nbsp;prevProps[name])</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Remove&nbsp;attributes</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;Object.keys(prevProps)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(isAttribute)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.forEach(name&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom[name]&nbsp;=&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Set&nbsp;attributes</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;Object.keys(nextProps)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(isAttribute)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.forEach(name&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom[name]&nbsp;=&nbsp;nextProps[name]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Add&nbsp;event&nbsp;listeners</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;Object.keys(nextProps)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.filter(isEvent)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;.forEach(name&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;eventType&nbsp;=&nbsp;name.toLowerCase().substring(2)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom.addEventListener(eventType,&nbsp;nextProps[name])</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p><code>updateDomProperties</code> í¨ìë ì´ì  íë¡í¼í°ë¤ì ëª¨ë ì ê±°íê³  ìë¡ì´ ê²ë¤ì ì¶ê°íë¤. ë§ì½ íë¡í¼í°ê° ë°ëì§ ììë¤ë©´ ë°ê¾¸ì§ ìëë¤. ê·¸ëì ë§ì ë¶íìí ìë°ì´í¸ë¥¼ í  ê²ìëë¤. ê·¸ë¬ë ê°ë¨íê²íê¸° ìí´ ì§ê¸ì ê·¸ëë¡ ëê² ìµëë¤.</p>
<h3>Reusing DOM nodes</h3>
<p>reconciliation ìê³ ë¦¬ì¦ì DOM nodes ë¥¼ ê°ë¥íë©´ ì¬ ì¬ì©íë ê²ì´ë¼ê³  ë§íë¤. ê·¸ëì type ì´ ê°ë¤ë©´ í´ë¹ DOM node ë¥¼ ì¬ì¬ì©í  ê²ì´ë¤. ( íë¡í¼í°ë§ update í ê²ì´ë¤. )</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;reconcile(parentDom,&nbsp;instance,&nbsp;element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(instance&nbsp;==&nbsp;null)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Create&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newInstance&nbsp;=&nbsp;instantiate(element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.appendChild(newInstance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(instance.element.type&nbsp;===&nbsp;element.type)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Update&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ì¬ê¸°ì&nbsp;instance&nbsp;domì&nbsp;ê¸°ì¡´ì&nbsp;render&nbsp;ëìë&nbsp;Real&nbsp;dom&nbsp;ì´ë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;instanceì&nbsp;Real&nbsp;domì&nbsp;ì¬ì¬ì©í´ì&nbsp;íë¡í¼í°ë¤ë§&nbsp;update&nbsp;ìì¼ì¤ë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;updateDomProperties(instance.dom,&nbsp;instance.element.props,&nbsp;element.props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.element&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Replace&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newInstance&nbsp;=&nbsp;instantiate(element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.replaceChild(newInstance.dom,&nbsp;instance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<h3>Children Reconciliation</h3>
<p>reconcile í¨ììì ê°ì¥ ì¤ìí ììì ëì³¤ìµëë¤. children ì ì¤íìí¤ì§ ììë¤ë ì ì´ë¤.
Children reconciliation ì ì£¼ì ê¸°ì ì¤ íëì´ë¤. ì¬ê¸°ìë ì´ì ê³¼ íì¬ tree êµ¬ì¡°ìì children ì ë§¤ì¹­ íê¸° ìí´ key ë¼ë ì¶ê° íë¡í¼í°ê° ìêµ¬ë©ëë¤.
ì¬ê¸°ìë ì¤ì§ ê°ì children ë°°ì´ìì ê°ì ìì¹ì children ë¼ë¦¬ë§ ë¹êµíê² ìµëë¤. ì´ê²ì´ ìë¯¸íë ë°ë children ììê° ë¬ë¼ì§ë©´ DOM nodes ë¥¼ ì¬ì¬ì©íì§ ëª»íë¤ë ë¹ì©ì´ ë ë¤ë ì ìëë¤.</p>
<p>Children reconciliation ì ì¤ííê¸° ìí´ì  ì´ì  child instances ì¸ <code>instance.childInstances</code> ì ìë¡ì´ element ì children <code>element.props.children</code>ì ë§¤ì¹­ìí¬ ê²ìëë¤. ê·¸ë¦¬ê³¤ ì¬ê·ì ì¼ë¡ reconcil í¨ìë¥¼ í¸ì¶í  ê²ìëë¤. ëí reconcile ìì ë¦¬í´ë ëª¨ë  instances ë¤ì ì ì§í´ì childInstances ë¥¼ ìë°ì´í¸ í  ì ììµëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;reconcile(parentDom,&nbsp;instance,&nbsp;element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(instance&nbsp;==&nbsp;null)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Create&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newInstance&nbsp;=&nbsp;instantiate(element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.appendChild(newInstance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(instance.element.type&nbsp;===&nbsp;element.type)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Update&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;íìì´&nbsp;ê°ìë&nbsp;domì&nbsp;ì¬ì¬ì©íë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;updateDomProperties(instance.dom,&nbsp;instance.element.props,&nbsp;element.props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ê·¸ë¦¬ê³¤&nbsp;childrenì&nbsp;ëí´ì&nbsp;reconcileì&nbsp;ì ì©íë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;children&nbsp;ì&nbsp;ë°°ì´ì´ê¸°&nbsp;ëë¬¸ì&nbsp;ë°°ì´&nbsp;ì²ë¦¬ë¥¼&nbsp;ìí&nbsp;reconcileChildren&nbsp;í¨ìë¥¼&nbsp;íì©íë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.childInstances&nbsp;=&nbsp;reconcileChildren(instance,&nbsp;element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.element&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Replace&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ë¶ëª¨ê°&nbsp;ê¸°ì¡´&nbsp;ì¸ì¤í´ì¤ìì&nbsp;ìë¡ì´&nbsp;ì¸ì¤í´ì¤ë¡&nbsp;replace&nbsp;íë¤ë©´&nbsp;ê·¸&nbsp;ë¶ëª¨&nbsp;children&nbsp;ë¤ë&nbsp;ìë¡&nbsp;instanceë¥¼&nbsp;ìì±íë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newInstance&nbsp;=&nbsp;instantiate(element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.replaceChild(newInstance.dom,&nbsp;instance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;reconcileChildren(instance,&nbsp;element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;dom&nbsp;=&nbsp;instance.dom</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childInstances&nbsp;=&nbsp;instance.childInstances</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;nextChildElements&nbsp;=&nbsp;element.props.children&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;newChildInstances&nbsp;=&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;count&nbsp;=&nbsp;Math.max(childInstances.length,&nbsp;nextChildElements.length)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;for&nbsp;(let&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;count;&nbsp;i++)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childInstance&nbsp;=&nbsp;childInstances[i]&nbsp;//&nbsp;ì´ë¯¸&nbsp;ê·¸ë ¤ì ¸&nbsp;ìë&nbsp;children&nbsp;instanceë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childElement&nbsp;=&nbsp;nextChildElements[i]&nbsp;//&nbsp;ìë¡&nbsp;ê·¸ë ¤ì¼&nbsp;í &nbsp;children&nbsp;elementë¤</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newChildInstance&nbsp;=&nbsp;reconcile(dom,&nbsp;childInstance,&nbsp;childElement)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;newChildInstances.push(newChildInstance)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;newChildInstances</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì ì½ëìì reconcile í¨ì ììì instance ë¥¼ ìë¡ ìì±íë ê²½ì° ( ë§¨ ì²ì render ê° ëë¤ê±°ë type ì´ ë°ëë replace ì ê²½ì°) í´ë¹ ë¶ëª¨ì ìì(children) ë¤ë ìë¡ì´ instance ë¥¼ ìì±íë¤. ì¦, ë¶ëª¨ê° instance ê° ë§ë¤ì´ì§ë©´ ê·¸ ììë¤ë ìë¡­ê² instance ë¥¼ ë§ë ë¤. ììì´ type ì´ ê°ëë¼ë ë¶ëª¨ê° ë°ëìê¸° ëë¬¸ì ì¬ ì¬ì©íì§ ëª»íë¤. <br/></p>
<p>ëì ì ë¶ëª¨ element ì type ì´ ê°ìì dom ì ì¬ì¬ì© í ëë ììë¤ì íëíë reconcile ì²ë¦¬ í´ì¤ë¤. ì´ë, ììë type ì´ ê°ë¤ë©´ ì¬ì¬ì© ê°ë¥.</p>
<h3>Removing DOM nodes</h3>
<p>ë§ì½ì <code>nextChildElements</code>ê° <code>childInstances</code> ë³´ë¤ length ê° ë ê¸¸ë¤ë©´ reconcileChildren í¨ìë reconcile í¨ìë¥¼ í¸ì¶í  ë instance ë¥¼ <code>undifined</code>ë¡ í´ì í¸ì¶í  ê²ì´ë¤. ê·¸ë¬ë©´ <code>if(instance == null)</code> ì ê±¸ë ¤ì ìë¡ì´ instance ë¥¼ ìì±í  ê²ì´ë¤. ë°ë©´ì ë°ëê° ëë¤ë©´ ì´ë¨ê¹?</p>
<p><code>childInstances</code>ê° <code>nextChildElements</code> ë³´ë¤ length ê° ë ê¸¸ë¤ë©´ reconcile í¨ììì childElement ì¸ìë¥¼ <code>undefined</code>ë¥¼ ë³´ë¼ ê²ì´ë¤. ì´ë reconcile í¨ìììë <code>element.type</code> ì²´í¬ì ìë¬ê° ë°ìíê² ëë¤.</p>
<p>dom ì´ ì ê±°ëëê±¸ ê³ ë ¤íì§ ììê¸° ëë¬¸ì´ë¤. ê·¸ëì ëê°ì§ë¥¼ ì²´í¬ í  ê²ì´ë¤. íëë reconcile í¨ììì element ê° null ì¸ ê²½ì°ì reconcileChildren í¨ììì newChildInstance ê° null ì¸ ê²½ì°ë¥¼ íí°í´ì¤ ê²ì´ë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;reconcile(parentDom,&nbsp;instance,&nbsp;element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(instance&nbsp;==&nbsp;null)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Create&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newInstance&nbsp;=&nbsp;instantiate(element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.appendChild(newInstance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(element&nbsp;==&nbsp;null)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Remove&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;elementê°&nbsp;null&nbsp;ì´ë¼ëê±´&nbsp;ìë¡ì´&nbsp;ìì ì¬í­ì´&nbsp;domì&nbsp;ì­ì íë¤ë&nbsp;ê²ì´ë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ê·¸ëì&nbsp;ê·¸ì&nbsp;ë§¤ì¹­&nbsp;ëë&nbsp;instance.dom&nbsp;ì&nbsp;ì ê±°í´ì£¼ì.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.removeChild(instance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ì¬ê¸°ì&nbsp;null&nbsp;ì&nbsp;ë¦¬í´í´ì£¼ê¸°&nbsp;ëë¬¸ì&nbsp;reconcileChildren&nbsp;í¨ììì&nbsp;nullì&nbsp;filter&nbsp;ì²ë¦¬&nbsp;íë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(instance.element.type&nbsp;===&nbsp;element.type)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Update&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;updateDomProperties(instance.dom,&nbsp;instance.element.props,&nbsp;element.props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.childInstances&nbsp;=&nbsp;reconcileChildren(instance,&nbsp;element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.element&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Replace&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newInstance&nbsp;=&nbsp;instantiate(element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.replaceChild(newInstance.dom,&nbsp;instance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;ì¸ì¤í´ì¤ì&nbsp;childInstanceê°&nbsp;ë°°ì´ì´ê¸°&nbsp;ëë¬¸ì&nbsp;ì´&nbsp;ë°°ì´ì&nbsp;ëë©´ì&nbsp;reconcile&nbsp;ì²ë¦¬.</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;reconcileChildren(instance,&nbsp;element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;dom&nbsp;=&nbsp;instance.dom</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;childInstances&nbsp;=&nbsp;instance.childInstances</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;nextChildElements&nbsp;=&nbsp;element.props.children&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;newChildInstances&nbsp;=&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;count&nbsp;=&nbsp;Math.max(childInstances.length,&nbsp;nextChildElements.length)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;for&nbsp;(let&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;count;&nbsp;i++)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childInstance&nbsp;=&nbsp;childInstances[i]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childElement&nbsp;=&nbsp;nextChildElements[i]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newChildInstance&nbsp;=&nbsp;reconcile(dom,&nbsp;childInstance,&nbsp;childElement)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;newChildInstances.push(newChildInstance)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;reconcile&nbsp;í¨ììì&nbsp;childElementê°&nbsp;nullì¸&nbsp;ê²½ì°ì&nbsp;domì´&nbsp;ì ê±°ë¬ë¤ê³ &nbsp;ê°ì£¼íê³ &nbsp;null&nbsp;ì&nbsp;ë°íí &nbsp;ê²ì´ë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;newChildInstances.filter(instance&nbsp;=&gt;&nbsp;instance&nbsp;!=&nbsp;null)</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<h2>Components and State</h2>
<p>ì ì½ëììë ëªëª ê°ì§ ë¬¸ì ì¬í­ì´ ììë¤.</p>
<ul>
<li>ëª¨ë  ë³íì ì ì²´ virtual DOM tree ë¥¼ reconciliation ì ì§íí©ëë¤.</li>
<li>State ê° ê¸ë¡ë²íê² ì¡´ì¬í©ëë¤.</li>
<li>state ê° ë³í ë í render í¨ìë¥¼ ì¢ ë ëªìì ì¼ë¡ í¸ì¶í´ì¼ í©ëë¤.</li>
</ul>
<p>Components ë ì´ë¬í ì´ìë¥¼ í´ê²°íëë° ëìì ì¤ì ììµëë¤.</p>
<ul>
<li>JSX ë¥¼ ì´ì©í´ Custom tag ë¥¼ ì ì í  ì ììµëë¤.</li>
<li>lifecycle ì´ë²¤í¸ì Hook ì ê±¸ì ììµëë¤.</li>
</ul>
<p>ë¨¼ì í´ì¼ í  ì¼ì ì»´í¬ëí¸ê° íì¥ ë  Component ê¸°ë³¸ í´ëì¤ë¥¼ ì ê³µíë ê²ìëë¤. ì°ë¦¬ë êµ¬ì± ìì ìíë¥¼ ìë°ì´í¸íë ë° ì¬ì©í  <code>partialState</code>ë¥¼ ë°ë <code>setState</code> ë©ìëì props ë§¤ê° ë³ìê°ìë ìì±ìê° íìí©ëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>class&nbsp;Component&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;constructor(props)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;this.props&nbsp;=&nbsp;props</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;this.state&nbsp;=&nbsp;this.state&nbsp;||&nbsp;{}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;setState(partialState)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;this.state&nbsp;=&nbsp;Object.assign({},&nbsp;this.state,&nbsp;partialState)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì´íë¦¬ì¼ì´ì ì½ëììë ì´ í´ëì¤ë¥¼ ììë°ì ê²ìëë¤. ê·¸ íì div ì span ê°ì´ <code>&#x3C;MyComponent></code> ì²ë¼ ì¬ì©í  ê²ìëë¤.
ì¬ê¸°ì ì¤ìíê±´ ì°ë¦¬ê° ë§ë¤ìë <code>createElement</code> ìì ì´ íì ììµëë¤. element <code>type</code>ì¼ë¡ class ì»´í¬ëí¸ë¥¼ ë°ê³  <code>props</code>ë¥¼ ë¤ë£°ê²ìëë¤.
ê·¸ëì ì¬ê¸°ì  ì´ element ë¥¼ ë°ììë component instance( public instances ë¼ê³  ë¶ë¦ëë¤.)ë¥¼ ìì±í´ì£¼ë í¨ìë¥¼ ë§ë¤ íìê° ììµëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;createPublicInstance(element,&nbsp;internalInstance)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;{&nbsp;type,&nbsp;props&nbsp;}&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;publicInstance&nbsp;=&nbsp;new&nbsp;type(props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;publicInstance.__internalInstance&nbsp;=&nbsp;internalInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;publicInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>public instance ìì±ì íë©´ì internal instance(virtual DOM) ì ë í¼ë°ì¤ë¥¼ ì¶ê°ì ì¼ë¡ ê°ì§ê³  ììê²ìëë¤. ì´ê²ì ì¤ì§ public instance state ê° ë³ê²½ ëììë í´ë¹ instance sub-tree ìë°ì´í¸ íëë° íìí©ëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>class&nbsp;Component&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;constructor(props)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;this.props&nbsp;=&nbsp;props</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;this.state&nbsp;=&nbsp;this.state&nbsp;||&nbsp;{}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;setState(partialState)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;this.state&nbsp;=&nbsp;Object.assign({},&nbsp;this.state,&nbsp;partialState)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;updateInstance(this.__internalInstance)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;updateInstance(internalInstance)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;parentDom&nbsp;=&nbsp;internalInstance.dom.parentNode</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;element&nbsp;=&nbsp;internalInstance.element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;reconcile(parentDom,&nbsp;internalInstance,&nbsp;element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p><code>instantiate</code> í¨ìë update ê° íìí©ëë¤. components ë¤ì public instace ë¡ ìì±íê³  component ì <code>render</code> í¨ìë¥¼ child element ë¥¼ ì»ê¸° ìí´ í¸ì¶í´ì¤ë¤. ê·¸ë¦¬ê³¤ í´ë¹ element ë¥¼ ë¤ì <code>instantiate</code> í¨ìë¡ í¸ì¶í´ì¤ë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;instantiate(element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;{&nbsp;type,&nbsp;props&nbsp;}&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;isDomElement&nbsp;=&nbsp;typeof&nbsp;type&nbsp;===&nbsp;&#39;string&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(isDomElement)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Instantiate&nbsp;DOM&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;isTextElement&nbsp;=&nbsp;type&nbsp;===&nbsp;TEXT_ELEMENT</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;dom&nbsp;=&nbsp;isTextElement</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?&nbsp;document.createTextNode(&#39;&#39;)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;document.createElement(type)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;updateDomProperties(dom,&nbsp;[],&nbsp;props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childElements&nbsp;=&nbsp;props.children&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;childElements&nbsp;ë&nbsp;ë°°ì´ë¡&nbsp;ë¤ì´ì¤ê¸°&nbsp;ëë¬¸ì&nbsp;map&nbsp;ëë¦¬ë©´ì&nbsp;instantiate&nbsp;í¨ì&nbsp;í¸ì¶í´ì¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childInstances&nbsp;=&nbsp;childElements.map(instantiate)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childDoms&nbsp;=&nbsp;childInstances.map(childInstance&nbsp;=&gt;&nbsp;childInstance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;childDoms.forEach(childDom&nbsp;=&gt;&nbsp;dom.appendChild(childDom))</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;instance&nbsp;=&nbsp;{&nbsp;dom,&nbsp;element,&nbsp;childInstances&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;element.typeì´&nbsp;class&nbsp;ì¼&nbsp;ê²½ì°.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Instantiate&nbsp;component&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;instance&nbsp;=&nbsp;{}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;publicInstance&nbsp;=&nbsp;createPublicInstance(element,&nbsp;instance)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childElement&nbsp;=&nbsp;publicInstance.render()</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;child&nbsp;ì¸ì¤í´ì¤ê°&nbsp;íëì.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childInstance&nbsp;=&nbsp;instantiate(childElement)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;dom&nbsp;=&nbsp;childInstance.dom</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;Object.assign(instance,&nbsp;{&nbsp;dom,&nbsp;element,&nbsp;childInstance,&nbsp;publicInstance&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>component elements ì í´ë¹íë internal instance ê³¼ dom element ë¤ì ë¤ë¥´ë¤. Component internal instance ë¤ì ì¤ì§ íëì child(render í¨ììì ë¦¬í´ëë) ë§ ê°ì§ê³  ìë¤. ê·¸ëì internal instance ë¤ì dom instances ë¤ì´ ê°ì§ê³  ìë ë°°ì´ì¸ <code>childInstances</code> ëì ì childInstance íë¡í¼í° íëë¥¼ ê°ì§ê³  ìë¤. ëí, component internal instance ë¤ì public instance ë¥¼ ê°ì§ê³  ìì íìê° ìë¤. ê·¸ëì¼ render í¨ìê° reconciliation íë ëì ë¶ë ¤ì§ì ìê¸° ëë¬¸ì´ë¤.</p>
<p>íê°ì§ ëì¹ê²ì´ ìë¤ë©´ component instance ì reconciliation ë¥¼ ë¤ë£¨ë ê²ì´ë¤. ê·¸ëì ì°ë¦° reconciliation algorithm ì íê°ì§ ì¼ì´ì¤ë¥¼ ë ì¶ê°í  ê²ì´ë¤. children reconciliation ì ë¤ë£¨ì§ ììë ëë íê°ì§ child ë§ ê°ì§ê³  ìë component instance ê° ì£¼ì´ì¡ìë, ì°ë¦° public instance ì props ë¥¼ update ìí¤ê³  child ë¥¼ re-render ìì¼ì£¼ë©´ ëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;reconcile(parentDom,&nbsp;instance,&nbsp;element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(instance&nbsp;==&nbsp;null)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Create&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newInstance&nbsp;=&nbsp;instantiate(element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.appendChild(newInstance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(element&nbsp;==&nbsp;null)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Remove&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.removeChild(instance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(instance.element.type&nbsp;!==&nbsp;element.type)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Replace&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newInstance&nbsp;=&nbsp;instantiate(element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;parentDom.replaceChild(newInstance.dom,&nbsp;instance.dom)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(typeof&nbsp;element.type&nbsp;===&nbsp;&#39;string&#39;)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Update&nbsp;dom&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;updateDomProperties(instance.dom,&nbsp;instance.element.props,&nbsp;element.props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.childInstances&nbsp;=&nbsp;reconcileChildren(instance,&nbsp;element)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.element&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//Update&nbsp;composite&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.publicInstance.props&nbsp;=&nbsp;element.props</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childElement&nbsp;=&nbsp;instance.publicInstance.render()</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;oldChildInstance&nbsp;=&nbsp;instance.childInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childInstance&nbsp;=&nbsp;reconcile(parentDom,&nbsp;oldChildInstance,&nbsp;childElement)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.dom&nbsp;=&nbsp;childInstance.dom</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.childInstance&nbsp;=&nbsp;childInstance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance.element&nbsp;=&nbsp;element</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì´ê² ì ë¶ì´ë¤. ì´ ì½ëë¥¼ ì¬ì©í´ì íì©í ìì ì´ë¤. : <a href="https://codepen.io/pomber/pen/RVqBrx">codepen</a></p>
<h2>Fiber: Incremental reconciliation</h2>
<p>ë¦¬ì¡í¸ 16 ë²ì ¼ì´ ì¶ì ëìë¤. ê·¸ê²ì ë¦¬ì¡í¸ì ì½ë ëë¶ë¶ì ì¬ ìì±í´ì¼ í  íìê° ìê¸´ ìë¡ì´ ë´ë¶ì ì¸ ìí¤íì³ë¥¼ ê°ì§ê³  ìë¤.
ì´ê²ì ìì  ìí¤íì²ë¡ë ê°ë°íê¸° íë  ì¼ë¶ ê¸°ë¥ì´ ì ì ëììì ìë¯¸í©ëë¤. ëí ì´ ìë¦¬ì¦ìì ìì±í ëë¶ë¶ì ì½ëë íì¬ ê°ì¹ê° ìë¤ë ê²ì ìë¯¸í©ëë¤.</p>
<p>ì´ì ë 16 ìì ì¬ì©íë ìë¡ì´ ìí¤íì³ë¥¼ ì¬ì©í´ì ë¤ì ì½ëë¥¼ ìì±í´ë³¼ ìì ì´ë¤. í¹í, êµ¬ì¡°, ë³ìë¤, í¨ìì´ë¦ë¤ì ë¦¬ì¡í¸ ì½ëë² ì´ì¤ë¡ ë¶í° ê°ì ¸ìì ìì±í  ê²ìëë¤.
ì¬ê¸°ì ì°ë¦¬ê° ê±´ë¤ì§ ììë ëë API ë ë¤ìê³¼ ê°ìµëë¤.</p>
<ul>
<li>createElemetn()</li>
<li>render() (ì¤ì§ DOM ì rendering íë í¨ì)</li>
<li>Component ( setState() ë©ìëë¥¼ í¬í¨í. context ë life cycle ì ë¯¸í¬í¨)</li>
</ul>
<p>ì´ì  ì ì°ë¦¬ê° ìì  ì½ëë¥¼ ë¤ì ìì±í´ì¼ íëì§ë¥¼ ì¤ëªíê² ë¤.</p>
<h3>Why Fiber</h3>
<p>ë¸ë¼ì°ì ì ë©ì¸ ì°ë ëë ìê°ì ë§ì´ ì°ë ë¬´ìì¸ê°ë¡ ì¸í´ ë§¤ì° ë°ìê² ìì§ìë¤ê³  í ë, ë§¤ì° ì¤ìí task ë¤ì ëë ë ê¹ì§ ê¸°ë¤ë ¤ì¼ íë¤.</p>
<p>ì´ë° ë¬¸ì ë¥¼ ìí´ì ëªê°ì§ ë°ëª¨ë¥¼ ì¤ë¹íë¤. <a href="https://pomber.github.io/incremental-rendering-demo/react-sync.html">ë°ëª¨</a>ìì íìë¤ì´ ëëê±¸ ì ì§íê¸° ìí´ì ë©ì¸ ì°ë ëë ë§¤ 16ms ë§ë¤ ì¬ì©ê°ë¥ íëë¡ ì ì§ ìì¼ì£¼ì´ì¼ íë¤. ë§ì½ ì´ ë©ì¸ì°ë ëê° ë¤ë¥¸ ë¬´ìì¸ê°ë¡ blocked ë¹íë¤ê³  íë¤ë©´ ì¬ê¸°ì ë§¤ 200ms ë¼ê³  íì. ë©ì¸ ì°ë ëê° ë¤ì ìì ë¡ì ì§ë ê¹ì§ íì±ë¤ì´ ë©ì¶°ìê³  í´ë¹ íë ìì´ ì¬ë¼ì§ëê±¸ íì¸ í  ì ìì ê²ì´ë¤.</p>
<p>ë¬´ìì´ ë©ì¸ ì°ë ë ì¦, ëª ìëë©ì´ìì ë¶ëë½ê³  UI ìëµì ì ì§íê¸° ìí´ ìë¹ì ë§ì´í¬ë¡ ì´ë ëììê² ë°ìê² íëê°?</p>
<p>reconciliation ì½ëë¥¼ ê¸°ìµíëê°? íë² reconciliation ì½ëë¥¼ ì¤ííë©´ ë©ì¶ì§ ìëë¤. ë©ì¸ ì¤ë ëê° ë¤ë¥¸ ììì ìíí´ì¼íë ê²½ì° reconciliation ì½ëë ëê¸°í´ì¼í©ëë¤. ê·¸ë¦¬ê³  ì´ reconciliation ì½ëë ë§ì ì¬ê· í¸ì¶ë¡ ì¸í´ì ì§ì°ë  ì ìë ì½ëë¤. ì´ë°ì´ì ë¡ ì°ë¦¬ë í´ë¹ ì½ëë¥¼ ì¬ê· í¸ì¶ì ë£¨íë¡ êµì²´ê°ë¥í ìë¡ì´ ë°ì´í° êµ¬ì¡°ë¥¼ ì¬ì©íë reconciliation ì½ëë¥¼ ì¬ ìì±í´ì¼ í©ëë¤.</p>
<h3>Scheduling micro-tasks</h3>
<p>ì°ë¦° ì´ì  ììì ìì ë¨ìë¡ ëë íìê° ììµëë¤. ì§§ì ìê°ëì ëìíê¸° ìí´ì ì§§ì ë¨ìë¡ ëëë¤. ë©ì¸ ì¤ë ëê° ë ì°ì  ììê° ëì ììì ìííê²íê³  ë³´ë¥ì¤ì¸ ììì´ ìì¼ë©´ ììì ëë´ê¸° ìí´ ë¤ì ëììµëë¤.
ì´ ììì ëê¸° ìí´ì <code>requestIdelCallback()</code> í¨ìë¥¼ ì´ì© í  ê²ìëë¤. ì´ê²ì callback í¨ìë¥¼ íì ë£ì´ ëëë° ì´ê²ì ë¸ë¼ì°ì ê° idle íìì í¸ì¶ì´ ëê³ , ì¼ë§í¼ ì´ì©ê°ë¥í ìê°ì¸ì§ ì¤ëªí´ì£¼ë <code>deadline</code> íë¼ë¯¸í°ë¥¼ í¬í¨íê³  ìë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>const&nbsp;ENOUGH_TIME&nbsp;=&nbsp;1&nbsp;//&nbsp;milliseconds</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>let&nbsp;workQueue&nbsp;=&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>let&nbsp;nextUnitOfWork&nbsp;=&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;schedule(task)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;workQueue.push(task)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;requestIdleCallback(performWork)</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;requestIdleCallback&nbsp;ì¸ìë¡&nbsp;ë¤ì´ê°&nbsp;í¨ì</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;ì´&nbsp;í¨ìë&nbsp;ë¸ë¼ì°ì ê°&nbsp;idle&nbsp;ìì ì&nbsp;í¸ì¶ëê³ </span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;deadline&nbsp;íë¼ë¯¸í°ë¡&nbsp;ì ì í&nbsp;ìê°ì´&nbsp;ë¨ìëì§ë¥¼&nbsp;íì¸í´ì&nbsp;í´ë¹&nbsp;ë¡ì§ì&nbsp;ìííë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;performWork(deadline)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(!nextUnitOfWork)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;nextUnitOfWork&nbsp;=&nbsp;workQueue.shift()</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;while&nbsp;(nextUnitOfWork&nbsp;&amp;&amp;&nbsp;deadline.timeRemaining()&nbsp;&gt;&nbsp;ENOUGH_TIME)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;nextUnitOfWork&nbsp;=&nbsp;performUnitOfWork(nextUnitOfWork)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(nextUnitOfWork&nbsp;||&nbsp;workQueue.length&nbsp;&gt;&nbsp;0)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;requestIdleCallback(performWork)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì¤ì  ììì <code>performUnitOfWork</code> í¨ììì ì¼ì´ë©ëë¤. <code>performUnitOfWork</code> ìì ì°ë¦¬ì reconciliation code ë¥¼ ìì±í  íìê° ììµëë¤. <code>performUnitOfWork</code> í¨ìë ìì ì¡°ê°ì ëììì¼ì¼ í©ëë¤. ê·¸ë¦¬ê³¤ ë¤ìì ììì ë¤ì ììíë ë° íìí ëª¨ë  ì ë³´ë¥¼ ë°íí´ì¼ í¡ëë¤.
<br />
ì´ë° ììì ì¡°ê°ë¤ì ì¶ì íê¸°ìí´ fiber ë¤ì ì¬ì©í  ê²ìëë¤. ì¦, fiber ë ì¼ë ¨ì ììì ë¤ì ììíê¸° ìí´ ë§ë¤ì´ì¡ê³  ì´ê²ì ìì ì ë³´ ëªì¸ìë¼ê³  ìê°íë©´ ë ê±° ê°ë¤.</p>
<h3>The fiber data structure</h3>
<p>ì°ë¦¬ë render ë¥¼ ìíë ê° ì»´í¬ëí¸ì ëí´ fiber ë¥¼ ìì±í  ê²ìëë¤. <code>nextUnitOfWork</code> ë ì°ë¦¬ê° ìíë ë¤ì ììì¸ next fiber ë¥¼ ìí ì°¸ì¡° ê°ìëë¤. <code>performUnitOfWork</code> ë fiber ëí ìììíê³  ìë£ê° ëë©´ ìë¡ì´ fiber ë¥¼ ë¦¬í´í©ëë¤.
<br />
fiber ë ì´ë»ê² ìê²¼ëê°?</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>let&nbsp;fiber&nbsp;=&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;tag:&nbsp;HOST_COMPONENT,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;type:&nbsp;&#39;div&#39;,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;parent:&nbsp;parentFiber,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;child:&nbsp;childFiber,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;sibling:&nbsp;null,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;alternate:&nbsp;currentFiber,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;stateNode:&nbsp;document.createElement(&#39;div&#39;),</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;props:&nbsp;{&nbsp;children:&nbsp;[],&nbsp;className:&nbsp;&#39;foo&#39;&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;partialState:&nbsp;null,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;effectTag:&nbsp;PLACEMENT,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;effects:&nbsp;[],</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì´ê²ì ë³´íµì ìë°ì¤í¬ë¦½í¸ ê°ì²´ìëë¤.
<br />
ì°ë¦¬ë <code>parents</code>, <code>child</code> ê·¸ë¦¬ê³  <code>sibling</code> íë¡í¼í°ë¥¼ ì¬ì©íì¬ component ì tree ë¥¼ ì¤ëª íë fiber ë¤ì tree ë¥¼ êµ¬ì¶í©ëë¤.
<br />
<code>stateNode</code>ë component instance ì ëí ì°¸ì¡° ê°ì´ë¤. ì´ ê°ì¼ë¡  DOM element ëë ì ì ê° ì ìí class component ì instance ë¥¼ ê°ì§ ì ììµëë¤.
<br />
ìë¥¼ ë¤ë©´,</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber01-8a3af4245f4db32744bd10e2fe3f154c-d9514.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABB0lEQVQoz3WRy07EMAxF+//fhliwgwWPSqBOO43r2s7DSVrcMiCGoZalKLJvfK7TeBJyMqGK84QEADihcy6mtK7rO+j9K60H0cQYEfD00avqn1rS0kPoINS61rr8Iw4hLHVhmUstvwtfveOc2sGjJB+y6S0trsR2SORc8pV473kb5O4ZglYtNWqxZLt86zdxyUWCFIO7wQaK5LPmWsqlmnL1McsO0njv643sB7vD/NAycJoohrRNfupi6/K64S/N0PcTABGxyO0TosuZbVRhr/tAbYdwQt19LQ0zjXAeYRQRozAXGqNRHrEA6RmjOTcvDSIKC7N48fM8G4JuW8hHf/vY5xd3WdgnVxgOSWCdrrMAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber01.png"
        title=""
        src="/ho_blog/static/fiber01-8a3af4245f4db32744bd10e2fe3f154c-fb8a0.png"
        srcset="/ho_blog/static/fiber01-8a3af4245f4db32744bd10e2fe3f154c-1a291.png 148w,
/ho_blog/static/fiber01-8a3af4245f4db32744bd10e2fe3f154c-2bc4a.png 295w,
/ho_blog/static/fiber01-8a3af4245f4db32744bd10e2fe3f154c-fb8a0.png 590w,
/ho_blog/static/fiber01-8a3af4245f4db32744bd10e2fe3f154c-d9514.png 600w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>ì ìì ìì ì°ë¦¬ê° ì§ìí  ìë¡ ë¤ë¥¸ 3 ê°ì§ ì¢ë¥ì ì»´í¬ëí¸ë¤ì ë³¼ì ìë¤.</p>
<ul>
<li><code>b</code>,<code>p</code> ê·¸ë¦¬ê³  <code>i</code> ë¥¼ ìí fiber ë¤ì <strong>host components</strong> ëííë¤. ì´ë¤ì ìë³ìë tag ì <code>HOST_COMPONENT</code> ë¼ê³  ì§ì¹­ í ê²ì´ë¤. <code>type</code>ì string(html element ì íê·¸) ì´ ë ê²ì´ë¤. <code>props</code>ë ìì±ê°ê³¼ í´ë¹ element ì ì´ë²¤í¸ ë¦¬ì¤ëê° ëê² ë¤.</li>
<li><code>Foo</code> fiber ë <strong>class component</strong> ë¥¼ ëííë¤. ì´ê²ì <code>tag</code>ë <code>CLASS_COMPONENT</code> ê° ë  ê²ì´ê³ , <code>type</code>ì ì ì ê° ì ìí <code>Didact.Component</code>ë¥¼ ììí <code>class</code> ì ì°¸ì¡°ê°ì´ ë ê²ì´ë¤.</li>
<li><code>div</code>ë¥¼ ìí fiber ë <strong>host root</strong> ë¥¼ ëííë¤. ì´ê²ì ììì ì¸ê¸í host component ê³¼ ì ì¬íë° ê·¸ ì´ì ë DOM element ë¥¼ ì§ëê³  ìê¸° ëë¬¸ì´ë¤. ê·¸ë¬ë ì´ host root ë í¸ë¦¬ì root ê° ëì´ì í¹ë³íê² ë¤ë¤ì§ ê²ì´ë¤. <code>tag</code>ë <code>HOST_ROOT</code>ê° ë ê²ì´ë¤. ì´ fiber ì stateNod ë <code>Didact.render()</code>ë¡ ì ë¬ ë°ì DOM node ì´ë¤.</li>
</ul>
<p>ë¤ë¥¸ ì¤ìí íë¡í¼í°ë <code>alternate</code> ì´ë¤. ì´ <code>alternate</code> ê° íìí ì´ì ë ëë¶ë¶ì ìê°ëìì ëê°ì§ì fiber tree ë¥¼ ê°ì ¸ì¼ íê¸° ëë¬¸ìëë¤.
<strong>íê°ì§ tree ë ì°ë¦¬ê° ì´ë¯¸ render í DOM ì ê´í ê²ì´ê³ , ì´ê²ì ì°ë¦° current tree ëë old tree ë¼ê³  ë¶ë¥¼ ê²ì´ë¤. ë ë¤ë¥¸ íëë ì°ë¦¬ê° <code>setState()</code> ëë <code>Didact.render()</code> í¸ì¶ì íµí´ì ìë¡ì´ update ììì í ë ìì±ëë tree ì´ë¤. ì´ê²ì ì°ë¦° <em>work-in-progress tree</em> ë¼ê³  ë¶ë¥¼ ê²ìëë¤.</strong></p>
<p>work-in-progress tree ë old tree ì ì´ë¤ fiberë¥¼ ê³µì íì§ ììµëë¤. ì¼ë¨ work-in-progress tree ë¥¼ ìì±íê³ ëë©´ DOM ì ë³í ìí¤ê³ , ë¤ì ì´ work-in-progress tree ê° old tree ê°ë©ëë¤.</p>
<p>ë°ë¼ì <code>alternate</code>ë work-in-progress tree fiber ë¤ì old tree ì ììíë fiber ë¤ê³¼ ì°ê²°íê¸° ìí´ ì¬ì©í©ëë¤. fiber ì ê·¸ê²ì <code>alternate</code>ë ê°ì <code>tag</code>, <code>type</code> ê·¸ë¦¬ê³  <code>stateNode</code>ë¥¼ ê³µì í©ëë¤. ëë¡  ìë¡ì´ rendering ììì´ ììë fiber ë¤ì <code>alternate</code>ë¥¼ ìê°ì§ê³  ìì ì ìë¤.</p>
<p>ë§ì§ë§ì¼ë¡, <code>effects</code>ë¦¬ì¤í¸ì <code>effectTag</code>ë¥¼ ê°ìµëë¤. work-in-progress tree ììì DOM ì´ ë³íí  íìê° ìë fiber ë¥¼ ì°¾ììë <code>effectTag</code>ë¥¼ <code>PLACEMENT</code>, <code>UPDATE</code> ëë <code>DELETION</code>ì¼ë¡ ì¤ì í©ëë¤. ëª¨ë  DOM ë³íë¥¼ ìì½ê² ì²ë¦¬íê¸° ìí´ <code>effectTag</code>ë¥¼ ê°ì§ê³  ìë ëª¨ë  fiber ë¤ì ëª©ë¡(fiber íì í¸ë¦¬ë¡ë¶í° ëì¨ fiber ë¤)ì <code>effects</code>ì ì ì§í©ëë¤.</p>
<h3>Didact call hierarchy</h3>
<p>ì°ë¦¬ê° ìì±íë ¤ê³ íë ì½ëì íë¦ì ì´í´íë ¤ë©´ì´ ë¤ì´ì´ê·¸ë¨ì ì´í´ë³´ì­ìì¤.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber02-cb798eaf0c4d3390f2b386a01f152b71-6dadd.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 584px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 80.65068493150686%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAABpElEQVQoz42TD2+DIBDF/f7fcFvm1k5R/NeKAoKg+7U2jTHNsktL4I5373F3Jus/TClV17UQ4nK57P0Jf2unrrtqY7F9LISAZ1nXZVmMMX3fxxiP4EvXFuePMEGguPeMgSykDDH2w8CmKIpxHI/gUanq8609f7VSHgQHrVVRNOfzrJRzbp/6AVZ9Lz/T+uu7zvN9jItRqblpbFWtfT9ZOwzDEfyH+Xmu2lZIqaeH/QVe7rb3UKdKyoNzO75gJkCdvffwsLler1LKeZ55Mx42OF+DqXBVVbSUynOJxtLhPM+7rgNJRjxZluGkbUcwYfBIpTZQkQJY27b4NzaYh7txfCGbMOnD3UivtQb/fBI/kNaYF7IBIBud0HJk5cF4nsOnrc3LsrnPafIs0iYShVBtmjf9qGC91WlZkBHr2mTZJAQKk3WJQL1zZckIyjRNy7Lc5pR3kovj6XRiHY3xjMrPjxfCZxltuDFT+2HUId46BAkv3PqEMcwImZx7tMr7cffxJK5ObZWOxXvoxeR80zR0Aqkwk4U9nDTGTtOi9SylEYIVVYB/AW9hoM7D2JM/AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber02.png"
        title=""
        src="/ho_blog/static/fiber02-cb798eaf0c4d3390f2b386a01f152b71-6dadd.png"
        srcset="/ho_blog/static/fiber02-cb798eaf0c4d3390f2b386a01f152b71-97f41.png 148w,
/ho_blog/static/fiber02-cb798eaf0c4d3390f2b386a01f152b71-94c01.png 295w,
/ho_blog/static/fiber02-cb798eaf0c4d3390f2b386a01f152b71-6dadd.png 584w"
        sizes="(max-width: 584px) 100vw, 584px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p><code>render()</code> ë° <code>setState()</code> ìì ììíì¬ <code>commitAllWork()</code> ìì ëëë íë¦ì ë°ë¦ëë¤.</p>
<h3>Old code</h3>
<p>ëë¶ë¶ì ì½ëë¥¼ ì¬ ìì±í´ì¼ íë¤ê³  ì´ì¼ê¸° íììë¤. íì§ë§ ë¨¼ì  ìì íì§ ìì ì½ëê° ìëì§ ì´í´ë´ìë¤.</p>
<p>í¸ëì¤íì¼ë JSX ê° ì¬ì©íë í¨ìì¸ createElement í¨ìë¥¼ ìì±íìµëë¤. ì°ë¦¬ê° ìì±í <code>createElement()</code> í¨ìë ë³í  íìê° ìë¤. ì°ë¦° ê³ì ëì¼í element ë¤ì ì¬ì©í  ê²ì´ê¸° ëë¬¸ì´ë¤. ì¬ê¸°ì element ë <code>type</code>,<code>props</code> ê·¸ë¦¬ê³  <code>children</code>ì ê°ì§ íë²í ìë°ì¤í¬ë¦½í¸ ê°ì²´ìë¤.</p>
<p>ì°ë¦° ë¸ëì DOM íë¡í¼í°ë¥¼ ê°±ì  íê¸° ìí´ <code>updateDomProperties()</code> ë ìì±íìë¤. ë DOM element ë¤ì ìì±íê¸° ìí´ <code>createDomElement()</code> í¨ìë ì¶ì¶íìµëë¤. ì´ ë í¨ì ëª¨ë <a href="https://gist.github.com/pomber/c63bd22dbfa6c4af86ba2cae0a863064">ì´ê³³</a>ìì ë³¼ì ììµëë¤.</p>
<p>base class ì¸ <code>Component</code> ë ìì±íììµëë¤. ì¬ê¸°ì <code>setState()</code>ê° <code>scheduleUpdate()</code> ë¥¼ í¸ì¶íê² ë§ë¤ê³  <code>createInstance()</code> ê° instance ì fiber ë¥¼ ì°¸ì¡°íëë¡ ë§ë­ìë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>class&nbsp;Component&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;constructor(props)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;this.props&nbsp;=&nbsp;props&nbsp;||&nbsp;{}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;this.state&nbsp;=&nbsp;this.state&nbsp;||&nbsp;{}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;setState(partialState)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;scheduleUpdate(this,&nbsp;partialState)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;createInstance(fiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;instance&nbsp;=&nbsp;new&nbsp;fiber.type(fiber.props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;instance.__fiber&nbsp;=&nbsp;fiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;instance</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì´ ì½ëë¡ ììíê³  ëë¨¸ì§ë ì²ìë¶í° ë¤ì ìì±íì§ ììµëë¤.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber03-925fc0565fc5ec71cb75ccc91b85eb95-108ba.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 21.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAhUlEQVQI12WOwQoDIQxE9/8/0IuKoOtN0JVGG6O26dqWlp1DiGRmfNvj1Jzzd67lqlJKSqm1tp4b+7z3WmvnXM4ZAIjoGrsB3BFjSvu+I+I7PMYwxgghpJTWWm5RSrEjhLBaFgUhwnHkGGut48P1+plNTMKz9843Lm6n/uDZVgpxkuiL9gTP0+hEPHz+hQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber03.png"
        title=""
        src="/ho_blog/static/fiber03-925fc0565fc5ec71cb75ccc91b85eb95-fb8a0.png"
        srcset="/ho_blog/static/fiber03-925fc0565fc5ec71cb75ccc91b85eb95-1a291.png 148w,
/ho_blog/static/fiber03-925fc0565fc5ec71cb75ccc91b85eb95-2bc4a.png 295w,
/ho_blog/static/fiber03-925fc0565fc5ec71cb75ccc91b85eb95-fb8a0.png 590w,
/ho_blog/static/fiber03-925fc0565fc5ec71cb75ccc91b85eb95-108ba.png 700w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p><code>Component</code> í´ëì¤ì <code>createElement()</code> ì¸ìë <code>render()</code>ì <code>setState()</code>ë¼ë ë ê°ì ê³µì© í¨ìê° ìì¼ë©° <code>setState()</code>ê° <code>scheduleUpdate()</code>ë¥¼ í¸ì¶íë ê²ì ë³´ììµëë¤.
<code>render()</code> ë° <code>scheduleUpdate()</code> ë ë¹ì·í©ëë¤. ì´ ë í¨ìë¤ì ì ìë°ì´í¸ í ê²ì ë°ê³  ëê¸°ì´(í)ì ë£ìµëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>//&nbsp;Fiber&nbsp;tags</span></span></div><div class="line"><span class="text plain null-grammar"><span>const&nbsp;HOST_COMPONENT&nbsp;=&nbsp;&#39;host&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>const&nbsp;CLASS_COMPONENT&nbsp;=&nbsp;&#39;class&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>const&nbsp;HOST_ROOT&nbsp;=&nbsp;&#39;root&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;Global&nbsp;state</span></span></div><div class="line"><span class="text plain null-grammar"><span>const&nbsp;updateQueue&nbsp;=&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>let&nbsp;nextUnitOfWork&nbsp;=&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>let&nbsp;pendingCommit&nbsp;=&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;render&nbsp;í¨ì</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;ìëì&nbsp;render&nbsp;í¨ìë¼ëê±´&nbsp;ì´&nbsp;í¨ìë¥¼&nbsp;ê°ë¦¬í´</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;ì´&nbsp;renderë&nbsp;ì²ìì&nbsp;ë±&nbsp;íë²&nbsp;ì¤íí¨.</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;render(elements,&nbsp;containerDom)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;updateQueue.push({</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;from:&nbsp;HOST_ROOT,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;dom:&nbsp;containerDom,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;newProps:&nbsp;{&nbsp;children:&nbsp;elements&nbsp;},</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;requestIdleCallback(performWork)</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;scheduleUpdate(instance,&nbsp;partialState)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;updateQueue.push({</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;from:&nbsp;CLASS_COMPONENT,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance:&nbsp;instance,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;partialState:&nbsp;partialState,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;requestIdleCallback(performWork)</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p><code>updateQueue</code> ë°°ì´ì ì¬ì©í´ì ë³´ë¥ì¤ì¸ update ì¶ì í  ê²ìëë¤. ë§¤ <code>render()</code> ëë <code>scheduleUpdate()</code> í¸ì¶ì ìë¡ì´ ìë°ì´í¸ë¥¼ <code>updateQueue</code> íì ë£ëë¤.
ê° ìë°ì´í¸ë¤ì ìë°ì´í¸ ì ë³´ë ë¤ë¥´ê³  ì´ê²ì ì°ë¦¬ê° ëì¤ì <code>resetNextUnitOfWork()</code> ìì ì´ë»ê² ì¬ì©í ì§ ë³¼ì ììê²ìëë¤.</p>
<p>ìë°ì´í¸ë¥¼ íì ë£ê³  ëì, <code>performWork()</code>ì ëí ì§ì° í¸ì¶ì í¸ë¦¬ê±°í©ëë¤.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber04-f7dc85e94c54deaebdbe6e0fc381b0a2-108ba.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 21.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAhUlEQVQI12WOSw6FIBAEuf8ZCWwQDGieAeU76OtA4sZadQo6PewZ9N5nuAfPh5uoeF9DiOeZUpqSEZGUclkWrTXnXCllrfXef/s/cByN6F1ipRRjDDpCCDlY17XW+h6Sc76uC2bfNuccAiowWGXzBxQNcFJr7V3DCP5B4inGiAyDHEJA5Q+XkefP5rfyDAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber04.png"
        title=""
        src="/ho_blog/static/fiber04-f7dc85e94c54deaebdbe6e0fc381b0a2-fb8a0.png"
        srcset="/ho_blog/static/fiber04-f7dc85e94c54deaebdbe6e0fc381b0a2-1a291.png 148w,
/ho_blog/static/fiber04-f7dc85e94c54deaebdbe6e0fc381b0a2-2bc4a.png 295w,
/ho_blog/static/fiber04-f7dc85e94c54deaebdbe6e0fc381b0a2-fb8a0.png 590w,
/ho_blog/static/fiber04-f7dc85e94c54deaebdbe6e0fc381b0a2-108ba.png 700w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>const&nbsp;ENOUGH_TIME&nbsp;=&nbsp;1&nbsp;//&nbsp;milliseconds</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;render&nbsp;ëë&nbsp;scheduleUpdate&nbsp;ìì</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;requestIdleCallback(performWork)&nbsp;ë¡&nbsp;í¸ì¶í¨.</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;performWork(deadline)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;workLoop(deadline)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(nextUnitOfWork&nbsp;||&nbsp;updateQueue.length&nbsp;&gt;&nbsp;0)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;requestIdleCallback(performWork)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;nextUnitOfWorkì&nbsp;ì²ìì&nbsp;nullë¡&nbsp;ìíëì´&nbsp;ìì.</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;workLoop(deadline)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(!nextUnitOfWork)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ì¬ê¸°ì&nbsp;ì²ìì&nbsp;nextUnitOfWork&nbsp;ì&nbsp;ìíí¨.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;resetNextUnitOfWork()</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;while&nbsp;(nextUnitOfWork&nbsp;&amp;&amp;&nbsp;deadline.timeRemaining()&nbsp;&gt;&nbsp;ENOUGH_TIME)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;nextUnitOfWork&nbsp;=&nbsp;performUnitOfWork(nextUnitOfWork)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(pendingCommit)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;commitAllWork(pendingCommit)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ì¬ê¸° ì°ë¦¬ê° ìì ë³´ìë <code>performUnitOfWork()</code> í¨í´ì ì¬ì©í©ëë¤.</p>
<p><code>requestIdleCallback()</code>ì deadline íë¼ë¯¸í°ë¥¼ í¨ê» ê°ì§ íê² í¨ìë¥¼ í¸ì¶í©ëë¤. <code>performWork()</code> deadline ì ë°ìì <code>workLoop()</code> ë¡ ì ë¬í´ì¤ëë¤. <code>workLoop()</code> returns íì, <code>performWork()</code> ìì ì¤ë¹ê° ëìëì§ ì²´í¬ë¥¼ í©ëë¤. ë§ì½ ì¤ë¹ê° ë¬ë¤ë©´, ìê¸° ìì ì ìë¡ì´ ì§ì° í¸ì¶ë¡ ì¤ì¼ì¤ë§ ìíµëë¤.</p>
<p><code>workLoop()</code> ì ìê°ì ì£¼ìíë í¨ììëë¤. ë§ì½ deadline ì´ ëë¬´ ê°ê¹ë¤ë©´(ë§ê°ìê°), ë£¨í ììì ë©ì¶ê³  ë¤ì ìë°ì´í¸ í´ì¼í  ììì ë¨ê²¨ë¡ëë¤. ê·¸ëì ë¤ì ë¤ì íìì ì¬ê° ë  ì ìëë¡ í©ëë¤.</p>
<blockquote>
<p><code>deadline.timeRemaining()</code>ì´ ë¤ë¥¸ ìì ë¨ìë¥¼ ì¤ííê¸°ì ì¶©ë¶íì§ ìëì§ íì¸íê¸° ìí´ ENOUGH_TIME (1ms ìì, React ì ëì¼)ì ì¬ì©í©ëë¤. <code>performUnitOfWork()</code>ê° ê·¸ ì´ìì ìííë©´ ë§ê° ìê°ì´ ì´ê³¼ ë ê²ìëë¤. deadlineì ë¸ë¼ì°ì ì ì ì ì¼ ë¿ì´ë¯ë¡ ëª ë°ë¦¬ ì´ ëì ì´ê³¼ì¤í íëê²ì ê·¸ë ê² ëìì§ ììµëë¤.</p>
</blockquote>
<p><code>performUnitOfWork()</code>ë ìë°ì´í¸ë¥¼ìí work-in-progress í¸ë¦¬ë¥¼ ë§ë¤ê³  DOM ì ì ì©í´ì¼ í  ë³ê²½ ì¬í­ì ë¨ê²¨ë¡ëë¤. <strong>ì´ê²ì í ë²ì í fiber ì© ì ì§ì ì¼ë¡ ì´ë£¨ì´ì§ ê²ìëë¤.</strong></p>
<p><code>performUnitOfWork()</code>ê° íì¬ ìë°ì´í¸ì ëí ëª¨ë  ììì ìë£íë©´ null ì ë°ííê³  ë³´ë¥ì¤ì¸ DOM ë³ê²½ ì¬í­ì <code>pendingCommit</code>ì ë¨ê²¨ ë¡ëë¤. ë§ì¹¨ë´ <code>commitAllWork()</code>ë <code>pendingCommit</code> ìì <code>effects</code>ë¥¼ ë°ì DOM ì ë³ê²½í©ëë¤.</p>
<p><code>commitAllWork()</code>ë ë£¨í ì¸ë¶ìì í¸ì¶ë©ëë¤. <code>performUnitOfWork()</code>ìì ìí ë ììì DOM ì ë³ê²½íì§ ìì¼ë¯ë¡ ë¶í íë ê²ì´ ì¢ìµëë¤. ë°ë©´ì, <code>commitAllWork()</code>ë DOM ì ëì°ë³ì´ìí¬ ê²ì´ê³  ì¼ê´ì±ìë UI ë¥¼ í¼íê¸° ìí´ íë²ì ëª¨ë ìë£ëì´ì¼í©ëë¤.</p>
<p>ì°ë¦¬ë ì¬ì í ì´ëì <code>nextUnitOfWork</code>ë¥¼ ì²ìì¼ë¡ ë¶ë¬ì¤ëì§ ë³´ì§ ëª»íìµëë¤.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber05-0e1c8186d35e3df92e401236f52f1908-108ba.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 21.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAbUlEQVQI142OCwrAIAxDvf8tBUUmguDq37oFe4AtUAhpHq16fquUUmtda+29JVGYnDMRpZTuoxACHfXe0QMAw8xSgwEvicLaGKO19t4750Baa68jtMcYMUYwAOQyH2E151Sf37bW5A5IeAnl/xdhZulTyLyzoAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber05.png"
        title=""
        src="/ho_blog/static/fiber05-0e1c8186d35e3df92e401236f52f1908-fb8a0.png"
        srcset="/ho_blog/static/fiber05-0e1c8186d35e3df92e401236f52f1908-1a291.png 148w,
/ho_blog/static/fiber05-0e1c8186d35e3df92e401236f52f1908-2bc4a.png 295w,
/ho_blog/static/fiber05-0e1c8186d35e3df92e401236f52f1908-fb8a0.png 590w,
/ho_blog/static/fiber05-0e1c8186d35e3df92e401236f52f1908-108ba.png 700w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>ìë°ì´í¸ë¥¼ ë°ìì ì²« ë²ì§¸ <code>nextUnitOfWork</code>ë¡ ë³ííë í¨ìë <code>resetNextUnitOfWork()</code> ìëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>//&nbsp;render&nbsp;í ëë&nbsp;scheduleUpdate&nbsp;í¸ì¶ë ë&nbsp;updateQueueì&nbsp;updateë¥¼&nbsp;ë£ê²&nbsp;ëëë°</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;ì´ë&nbsp;ì²ìì¼ë¡&nbsp;updateQueueì&nbsp;ìë&nbsp;update&nbsp;ë¥¼&nbsp;êº¼ë´ì¤ë&nbsp;í¨ì.</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;update&nbsp;ë¥¼&nbsp;êº¼ë´ìì&nbsp;nextUnitOfWork&nbsp;ì&nbsp;fiberë¥¼&nbsp;ë§ë¤ì´ì¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;resetNextUnitOfWork()&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;update&nbsp;=&nbsp;updateQueue.shift()</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(!update)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;Copy&nbsp;the&nbsp;setState&nbsp;parameter&nbsp;from&nbsp;the&nbsp;update&nbsp;payload&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;fiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;ì¬ê¸°ì&nbsp;instanceë&nbsp;componentì&nbsp;public&nbsp;instanceë¥¼&nbsp;ê°ë¦¬í´.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;partialState&nbsp;ì´ê²ì&nbsp;updateí &nbsp;ìë¡ì´&nbsp;ê°&nbsp;(setStateë¡&nbsp;ëì´ì¤ë&nbsp;ì¸ì)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(update.partialState)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;update.instance.__fiber.partialState&nbsp;=&nbsp;update.partialState</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;ê·¸ë°&nbsp;ë¤ì&nbsp;old&nbsp;fiber&nbsp;treeì&nbsp;rootë¥¼&nbsp;ì°¾ìµëë¤.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;root&nbsp;=</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;update.from&nbsp;==&nbsp;HOST_ROOT</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?&nbsp;update.dom._rootContainerFiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;getRoot(update.instance.__fiber)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;ìë¡ì´&nbsp;fiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;ìë¡ì´&nbsp;work-in-progress&nbsp;treeì&nbsp;root</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;updateì&nbsp;domê°ì´&nbsp;ìì¼ë©´&nbsp;ì²ì&nbsp;render&nbsp;í¨ì&nbsp;í¸ì¶íëê±°</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;updateì&nbsp;newProps&nbsp;ê°ì´&nbsp;ìì¼ë©´&nbsp;ì²ì&nbsp;render&nbsp;í¨ì&nbsp;í¸ì¶íëê±°.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;nextUnitOfWork&nbsp;=&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;tag:&nbsp;HOST_ROOT,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;stateNode:&nbsp;update.dom&nbsp;||&nbsp;root.stateNode,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;props:&nbsp;update.newProps&nbsp;||&nbsp;root.props,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;alternate:&nbsp;root,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;getRoot(fiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;let&nbsp;node&nbsp;=&nbsp;fiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;while&nbsp;(node.parent)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;node&nbsp;=&nbsp;node.parent</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;node</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p><code>resetNextUnitOfWork()</code>ë ëê¸°ì´ìì ì²« ë²ì§¸ ìë°ì´í¸ë¥¼ ê°ì ¸ ìì ììí©ëë¤.</p>
<p>update ê°ì²´ì <code>partialState</code>ê° ìë¤ë©´ ì»´í¬ëí¸ ì¸ì¤í´ì¤ì ìí´ìë fiber ì ê·¸ê²ì ì ì¥ ìì¼ ëìµëë¤. ê·¸ëì ëì¤ì ì»´í¬ëí¸ì <code>render()</code>ë¥¼ í¸ì¶ í  ë ì¬ì©í  ì ììµëë¤.</p>
<p>ê·¸ë° ë¤ì old fiber tree ì root ë¥¼ ì°¾ìµëë¤. ì²ì í¸ì¶ëë <code>render()</code>í¨ìë¡ update ê°ì²´ë¤ì´ ëì´ìì ê²½ì°ìë ë£¨í¸ fiber ê° ìì¼ë¯ë¡ <code>root</code>ê° <code>null</code>ì´ ë©ëë¤. <code>render()</code>ì ëí íì í¸ì¶ìì ì¤ë ê²½ì° DOM ë¸ëì <code>_rootContainerFiber</code> ìì±ìì ë£¨í¸ë¥¼ ì°¾ì ì ììµëë¤. ê·¸ë¦¬ê³  ìë°ì´í¸ê° <code>setState()</code>ìì ì¤ë ê²½ì°ìë, ë¶ëª¨ê°ìë fiber ê° ë°ê²¬ ë  ëê¹ì§ ì¸ì¤í´ì¤ fiber ìì ìë¡ ì´ëí´ì¼í©ëë¤.</p>
<p>ê·¸ë° ë¤ì <code>nextUnitOfWork</code>ì ì fiber ë¥¼ í ë¹í©ëë¤. <strong>ì´ fiber ë ìë¡ì´ work-in-progress tree ì root ìëë¤.</strong></p>
<p>ë§ì½ old root ê° ìë¤ë©´(ì´ë¯¸ ê·¸ë ¤ì§ DOM ì´ ìë¤ë©´), <code>stateNode</code>(component instance)ë <code>render()</code> í¸ì¶í ë ë§¤ê° ë³ìë¡ ë°ì DOM ë¸ë(containerDom)ìëë¤. <code>props</code> ë update ê°ì²´ì <code>newProps</code>ê°ë©ëë¤ : ì¬ê¸°ì <code>newProps</code>ë element(render()ì element ë§¤ê°ë³ì)ë¤ì ê°ì§ê³ ìë children íë¡í¼í°ë¥¼ ê°ì§ ê°ì²´ì´ë¤(ì <code>render</code> í¨ì ì°¸ê³ ). <code>alternate</code>ì null ì´ ë  ê²ìëë¤. ìëíë©´ ì²ìì¼ë¡ í¸ì¶ëë <code>render</code> ì´ê¸° ëë¬¸ì ë£¨í¸ fiber ê° ìë¤.</p>
<p>ë§ì½ old root ê° ìë¤ë©´ <code>stateNode</code>ë ì´ì  ë£¨í¸ì DOM ë¸ëê°ë©ëë¤. <code>props</code>ë ë¤ì newProps ê° null ì´ ìëë©´ <code>newProps</code>ë¡ í ë¹ëê³  ê·¸ë ì§ ìì¼ë©´ ì´ì  ë£¨í¸ìì <code>props</code> ë³µì¬í©ëë¤. <code>alternate</code>ë ì´ì  ë£¨í¸ê°ë©ëë¤.</p>
<p>ì´ì  ì°ë¦¬ë work-in-progress tree ì root ì ê°ì§ê³  ëë¨¸ì§ ë¶ë¶ì ë§ë¤ê¸° ììí©ìë¤.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber06-a3d4baef4ba4a6182d4a51b4d1a88e17-108ba.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 21.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAbUlEQVQI142PSwrAIAxEvf8lXUkRQfAT4r8dEui2fYswTGaImvs3zNxaW2udc9QxULXWnDMRpZRUhBBgllKQnnOOMdDR2BJ673tvg5219hKcc5gxRhXee/RZQDoKaKKGAyiaz9eSoJch3i/AeQAd/uiNdYwOrwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber06.png"
        title=""
        src="/ho_blog/static/fiber06-a3d4baef4ba4a6182d4a51b4d1a88e17-fb8a0.png"
        srcset="/ho_blog/static/fiber06-a3d4baef4ba4a6182d4a51b4d1a88e17-1a291.png 148w,
/ho_blog/static/fiber06-a3d4baef4ba4a6182d4a51b4d1a88e17-2bc4a.png 295w,
/ho_blog/static/fiber06-a3d4baef4ba4a6182d4a51b4d1a88e17-fb8a0.png 590w,
/ho_blog/static/fiber06-a3d4baef4ba4a6182d4a51b4d1a88e17-108ba.png 700w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>//&nbsp;wipFiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;&nbsp;&nbsp;tag:&nbsp;HOST_ROOT,</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;&nbsp;&nbsp;stateNode:&nbsp;update.dom&nbsp;||&nbsp;root.stateNode,</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;&nbsp;&nbsp;props:&nbsp;update.newProps&nbsp;||&nbsp;root.props,</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;&nbsp;&nbsp;alternate:&nbsp;root,</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;performUnitOfWork(wipFiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;beginWork(wipFiber)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(wipFiber.child)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;wipFiber.child</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;No&nbsp;child,&nbsp;we&nbsp;call&nbsp;completeWork&nbsp;until&nbsp;we&nbsp;find&nbsp;a&nbsp;sibling</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;let&nbsp;uow&nbsp;=&nbsp;wipFiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;while&nbsp;(uow)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;completeWork(uow)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(uow.sibling)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Sibling&nbsp;needs&nbsp;to&nbsp;beginWork</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uow.sibling</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;uow&nbsp;=&nbsp;uow.parent</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p><code>performUnitOfWork()</code>ë ì§íì¤ì¸ ìì í¸ë¦¬ë¥¼ íìí©ëë¤.</p>
<p><code>beginWork()</code>ë¥¼ í¸ì¶íë¤. âì´ê²ì ìë¡ì´ fiber ì children ì ë§ë¤ê¸° ìí ììì´ë¤.â ê·¸ë¦¬ê³  ëì ì²«ë²ì§¸ childì ë¦¬í´íë¤. ê·¸ë¦¬ê³ ëì ê·¸ê²ì  <code>nextUnitOfWork</code> ì ëìíë¤.</p>
<p>ë§ì½ ì´ë¤ child ë ìë¤ë©´, <code>completeWork()</code>ë¥¼ í¸ì¶íê³  <code>nextUnitOfWork</code>ê° ë  <code>sibling</code>ì ë¦¬í´íë¤.</p>
<p>ë§ì½ <code>sibling</code>ê° ìë¤ë©´, parents ë¡ ì¬ë¼ê°ì í´ë¹ parents ë¥¼ ì¸ìë¡ <code>completeWork()</code>ë¥¼ í¸ì¶íë¤. ì´ ììì <code>sibling</code>ì ì°¾ìë ëë root ì ëë¬íì ëê¹ì§ ë°ë³µíë¤.</p>
<p><code>performUnitOfWork()</code>ë¥¼ ì¬ë¬ ë² í¸ì¶íë©´ ìì(children)ì´ ìë íì´ë²ë¥¼ ì°¾ì ëê¹ì§ ê° íì´ë²ì ì²«ë²ì§¸ ììì ììë¤ì ìì±íë©´ì ê³ìí´ì í¸ë¦¬ì íìë¡ ë´ë ¤ê°ëë¤. ê·¸ë¦¬ê³  ì¤ë¥¸ìª½ì¼ë¡ ì®ê²¨ì siblings ìë ê°ì ììì ìíí©ëë¤. ê·¸ë¦¬ê³  ë¤ì ìë¡ ì¬ë¼ìì ê°ì ììì ìíí©ëë¤.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber07-d71ef97e3317e6cc9c4d8ee5a383b830-108ba.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 21.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAlElEQVQI122Oyw6EIAxF/f9/NIagGQMmgggUfMyckc0spovm5rY9t91938dxnOdZSkFc1/X+V/g5ZxGpte77jsDscKdpGsdRaz3Ps7WWJSj1qV/cuq4pJQSdsO8xyUqpvu9BcG+MQQ/DAA7He8/etm2vpzgjFn9ZFtAdADYYt0HrzrkYY3uvSJacnfckAwohtBeKyAfr9OT+nGcDnwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber07.png"
        title=""
        src="/ho_blog/static/fiber07-d71ef97e3317e6cc9c4d8ee5a383b830-fb8a0.png"
        srcset="/ho_blog/static/fiber07-d71ef97e3317e6cc9c4d8ee5a383b830-1a291.png 148w,
/ho_blog/static/fiber07-d71ef97e3317e6cc9c4d8ee5a383b830-2bc4a.png 295w,
/ho_blog/static/fiber07-d71ef97e3317e6cc9c4d8ee5a383b830-fb8a0.png 590w,
/ho_blog/static/fiber07-d71ef97e3317e6cc9c4d8ee5a383b830-108ba.png 700w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>//&nbsp;wipFiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;&nbsp;&nbsp;tag:&nbsp;HOST_ROOT,</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;&nbsp;&nbsp;stateNode:&nbsp;update.dom&nbsp;||&nbsp;root.stateNode,</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;&nbsp;&nbsp;props:&nbsp;update.newProps&nbsp;||&nbsp;root.props,</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;&nbsp;&nbsp;alternate:&nbsp;root,</span></span></div><div class="line"><span class="text plain null-grammar"><span>//&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;beginWork(wipFiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(wipFiber.tag&nbsp;==&nbsp;CLASS_COMPONENT)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;updateClassComponent(wipFiber)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;updateHostComponent(wipFiber)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;updateHostComponent(wipFiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(!wipFiber.stateNode)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;wipFiber.stateNode&nbsp;=&nbsp;createDomElement(wipFiber)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;newChildElements&nbsp;=&nbsp;wipFiber.props.children</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;reconcileChildrenArray(wipFiber,&nbsp;newChildElements)</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;updateClassComponent(wipFiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;let&nbsp;instance&nbsp;=&nbsp;wipFiber.stateNode</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(instance&nbsp;==&nbsp;null)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Call&nbsp;class&nbsp;constructor</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;instance&nbsp;=&nbsp;wipFiber.stateNode&nbsp;=&nbsp;createInstance(wipFiber)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(wipFiber.props&nbsp;==&nbsp;instance.props&nbsp;&amp;&amp;&nbsp;!wipFiber.partialState)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;No&nbsp;need&nbsp;to&nbsp;render,&nbsp;clone&nbsp;children&nbsp;from&nbsp;last&nbsp;time</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;cloneChildFibers(wipFiber)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;instance.props&nbsp;=&nbsp;wipFiber.props</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;instance.state&nbsp;=&nbsp;Object.assign({},&nbsp;instance.state,&nbsp;wipFiber.partialState)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;wipFiber.partialState&nbsp;=&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;newChildElements&nbsp;=&nbsp;wipFiber.stateNode.render()</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;reconcileChildrenArray(wipFiber,&nbsp;newChildElements)</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p><code>beginWork()</code>ë ëê°ì§ë¥¼ í©ëë¤:</p>
<ul>
<li><code>stateNode</code>ë¥¼ ê°ì§ê³  ìì§ ìë¤ë©´ ìì±í´ì¤ëë¤.</li>
<li>component children ì ê°ì ¸ì <code>reconcileChildrenArray()</code>ì ê·¸ê²ë¤ì ëê²¨ì¤ë¤.</li>
</ul>
<p>ëê°ì§ íìì component ë¥¼ ì°ë¦¬ê° ë¤ë£¨ê¸° ëë¬¸ì ì°ë¦¬ë 2 ê°ì§ë¡ ëë ì¼ íë¤. <code>updateHostComponent()</code> ì <code>updateClassComponent()</code> ì´ë¤.</p>
<p><code>updateHostComponent()</code>ë host component ë¤ê³¼ root component ë¥¼ ë¤ë£¬ë¤. ê·¸ê²ì íìíë¤ë©´ ìë¡ì´ DOM ì ë§ë¤ì´ë´ê³  <strong>fiber props ìì ëì¨ child element ë¤ì ì´ì©í´ì <code>reconcileChildrenArray()</code>ë¥¼ í¸ì¶íë¤.</strong></p>
<p><code>updateClassComponent()</code>ë class component instance ë¤ì ë¤ë£¬ë¤. ê·¸ê²ì íìíë¤ë©´ component ì ìì±ìë¥¼ í¸ì¶í´ì instance ë¥¼ ë§ë¤ì´ë¸ë¤. <strong>instance ì props ì state ë¥¼ ìë°ì´í¸ë¥¼ íê³  <code>render()</code>ë¥¼ í¸ì¶í´ì ìë¡ì´ children ì ì»ëë¤.</strong></p>
<p><code>updateClassComponent()</code> ëí <code>render()</code>ë¥¼ í¸ì¶íëê²ì´ ë§ëì§ íì¸í©ëë¤. ì´ê²ì <code>shouldComponentUpdate()</code>ì ê°ë¨í ë²ì ì´ë¤. ë§ì½ re-render í  íìê° ìì´ ë³´ì¸ë¤ë©´, ì´ë í reconciliation ìì´ íì¬ sub-tree ë¥¼ work-in-progress í¸ë¦¬ë¡ ë³µì¬í©ëë¤.</p>
<p>ì´ì  <code>newChildElements</code>ë¥¼ ê°ì§ê³ ìê³ , work-in-grogress fiber ë¥¼ ìí child fiber ë¤ì ë§ë¤ ì¤ë¹ê° ëììµëë¤.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber08-f3e48d0a3449fc30707b57a88b80fe12-108ba.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 21.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAcklEQVQI142O2Q5DIQhE/f9vrXEBFAVt52r62vQkknFYw/s/9t7MbGbQrTVVhQhwc84ppXyIMZZSXodr3lIi6r27+5xTRGBCP816QE6/QCP9RBG8OQYx44vN6MQgRDcLP29dS8kkLR86xt1ca8VpGLzdP1qG6VNDcdjaAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber08.png"
        title=""
        src="/ho_blog/static/fiber08-f3e48d0a3449fc30707b57a88b80fe12-fb8a0.png"
        srcset="/ho_blog/static/fiber08-f3e48d0a3449fc30707b57a88b80fe12-1a291.png 148w,
/ho_blog/static/fiber08-f3e48d0a3449fc30707b57a88b80fe12-2bc4a.png 295w,
/ho_blog/static/fiber08-f3e48d0a3449fc30707b57a88b80fe12-fb8a0.png 590w,
/ho_blog/static/fiber08-f3e48d0a3449fc30707b57a88b80fe12-108ba.png 700w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>ì´ê²ì´ ì´ library ì ì¬ì¥ìëë¤. work-in-progress í¸ë¦¬ê° ì»¤ì§ë©° ì»¤ë° ë¨ê³ìì DOM ì ëí´ ì´ë¤ ë³ê²½ ììì ìíí ì§ ê²°ì í©ëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>//&nbsp;Effect&nbsp;tags</span></span></div><div class="line"><span class="text plain null-grammar"><span>const&nbsp;PLACEMENT&nbsp;=&nbsp;1</span></span></div><div class="line"><span class="text plain null-grammar"><span>const&nbsp;DELETION&nbsp;=&nbsp;2</span></span></div><div class="line"><span class="text plain null-grammar"><span>const&nbsp;UPDATE&nbsp;=&nbsp;3</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;arrify(val)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;return&nbsp;val&nbsp;==&nbsp;null&nbsp;?&nbsp;[]&nbsp;:&nbsp;Array.isArray(val)&nbsp;?&nbsp;val&nbsp;:&nbsp;[val]</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;reconcileChildrenArray(wipFiber,&nbsp;newChildElements)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;elements&nbsp;=&nbsp;arrify(newChildElements)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;let&nbsp;index&nbsp;=&nbsp;0</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;let&nbsp;oldFiber&nbsp;=&nbsp;wipFiber.alternate&nbsp;?&nbsp;wipFiber.alternate.child&nbsp;:&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;let&nbsp;newFiber&nbsp;=&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;//&nbsp;ìë¡­ê²&nbsp;ë¤ì´ì¨&nbsp;element&nbsp;ëë&nbsp;oldFiberê°&nbsp;ììëê¹ì§&nbsp;ë°ë³µ</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;while&nbsp;(index&nbsp;&lt;&nbsp;elements.length&nbsp;||&nbsp;oldFiber&nbsp;!=&nbsp;null)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;prevFiber&nbsp;=&nbsp;newFiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;element&nbsp;=&nbsp;index&nbsp;&lt;&nbsp;elements.length&nbsp;&amp;&amp;&nbsp;elements[index]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;sameType&nbsp;=&nbsp;oldFiber&nbsp;&amp;&amp;&nbsp;element&nbsp;&amp;&amp;&nbsp;element.type&nbsp;==&nbsp;oldFiber.type</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(sameType)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newFiber&nbsp;=&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;oldFiber.type,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag:&nbsp;oldFiber.tag,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateNode:&nbsp;oldFiber.stateNode,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;props:&nbsp;element.props,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent:&nbsp;wipFiber,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alternate:&nbsp;oldFiber,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partialState:&nbsp;oldFiber.partialState,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;effectTag:&nbsp;UPDATE,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(element&nbsp;&amp;&amp;&nbsp;!sameType)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newFiber&nbsp;=&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;element.type,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typeof&nbsp;element.type&nbsp;===&nbsp;&#39;string&#39;&nbsp;?&nbsp;HOST_COMPONENT&nbsp;:&nbsp;CLASS_COMPONENT,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;props:&nbsp;element.props,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent:&nbsp;wipFiber,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;effectTag:&nbsp;PLACEMENT,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(oldFiber&nbsp;&amp;&amp;&nbsp;!sameType)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldFiber.effectTag&nbsp;=&nbsp;DELETION</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wipFiber.effects&nbsp;=&nbsp;wipFiber.effects&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wipFiber.effects.push(oldFiber)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(oldFiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldFiber&nbsp;=&nbsp;oldFiber.sibling</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(index&nbsp;==&nbsp;0)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wipFiber.child&nbsp;=&nbsp;newFiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(prevFiber&nbsp;&amp;&amp;&nbsp;element)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prevFiber.sibling&nbsp;=&nbsp;newFiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;index++</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p>ììíê¸° ì ì <code>newChildElements</code>ê° ë°°ì´ì¸ì§ íì¸íì­ìì¤. (ì´ì ì reconciliation ìê³ ë¦¬ì¦ê³¼ ë¬ë¦¬ <code>reconcileChildrenArray</code>ë í­ì ìì ë°°ì´ê³¼ í¨ê» ìëí©ëë¤. ì¦, ì´ì  component ì <code>render()</code> í¨ììì ë°°ì´ì ë°í í  ì ììµëë¤.)</p>
<p>ê·¸ íì old fiber tree ì children ë¤ì ìë¡ì´ element ì ë¹êµíê¸° ììí©ëë¤. (fiber ì element ë¥¼ ë¹êµíë ê²ì´ë¤.) old fiber tree ì children ë¤ì <code>wipFiber.alternate</code> ì children ì´ë¤. ìë¡ì´ element ë¤ì <code>wipFiber.props.children</code> ìì ì»ì´ ì¤ê±°ë ëë <code>wipFiber.stateNode.render()</code> í¸ì¶í´ì ì»ì´ì¨ ê²ìëë¤.</p>
<p>reconciliation ìê³ ë¦¬ì¦ì ì²«ë²ì§¸ old fiber(<code>wipFiber.alternate.child</code>)ì ì²«ë²ì§¸ child element(<code>element[0]</code>) ë¥¼ ì¼ì¹ ìí¤ê³ , ëë²ì§¸ old fiber(<code>wipFiber.alternate.child.sibling</code>) ëë²ì§¸ child element(<code>element[1]</code>)ë ë°ë³µí©ëë¤. ê°ê° oldFiber-element ìì ì´ë£¨ê² í©ëë¤.</p>
<ul>
<li>
<p>ë§ì½ oldFiber ì element ê° íìì´ ê°ë¤ë©´, ì´ê²ì ì¢ì ìììëë¤, ì´ê²ì ê¸°ì¡´ì stateNode ë¥¼ ì ì§í ì ìë¤ë ë»ì´ë¤. ì°ë¦¬ë new fiber ë¥¼ ìì ê±° ê¸°ë°ìì ìì±í©ëë¤. <code>UPDATE</code>ë¥¼ <code>effectTag</code>ì ì¶ê°ìí¨ë¤. ê·¸ë¦¬ê³  ìë¡ì´ fiber ë¥¼ work-in-progress tree ì ë§ë¶ìëë¤.</p>
</li>
<li>
<p>ë§ì½ element ì type ì´ oldFiber ì ë¤ë¥´ê±°ë oldFiber ê° ìë¤ë©´(ìëíë©´ ê¸°ì¡´ ììë¤ë³´ë¤ ìë¡ì´ ììë¤ì ë§ì´ ê°ì§ê³  ìë ê²½ì°), ì°ë¦¬ê° ê°ì§ê³  ìë element ì ë³´ë¥¼ ê°ì§ê³  ìë¡ì´ fiber ë¥¼ ìì±í©ëë¤. ì´ ìë¡ì´ fiber ë <code>alternate</code> ì <code>stateNode</code>ë¥¼ ê°ì§ê³  ìì§ ìëë¤. (<code>stateNode</code>ë <code>beginWork()</code>ìì ìì±ë©ëë¤.) ì´ fiber ì <code>effectTag</code> ë <code>PLACEMENT</code> ìëë¤.</p>
</li>
<li>
<p>ë§ì½ oldFiber ì element ê° ë¤ë¥¸ type ì´ê±°ë ì´ oldFiber ë¥¼ ìí ì´ë í element ë ìë ê²½ì°(ìëíë©´ ê¸°ì¡´ ììë¤ì´ ìë¡ì´ ììë¤ ë³´ë¤ ë§ì´ ê°ì§ê³  ìê¸° ëë¬¸) oldFiber ë DELETION íê·¸ë¥¼ ë¶ìëë¤. ì´ fiber ë ìì ì¤(work-in-progress) í¸ë¦¬ì ì¼ë¶ê° ìëê¸° ëë¬¸ì, ê·¸ê²ì ì¶ì í  ì ìê²ë wipFiber.effets ëª©ë¡ì ì¶ê°í´ì¼ í©ëë¤.</p>
</li>
</ul>
<blockquote>
<p>ë¦¬ì¡í¸ìë ë¬ë¦¬ ì¬ì¡°ì ì ìí´ keys ë¥¼ ì¬ì©íì§ ìì¼ë¯ë¡, ì´ì  ìì¹ìì ë²ì´ë ììì´ ìëì§ ì ì ììµëë¤.</p>
</blockquote>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber09-ac8503ac4e5f378f55ab8d7bfe6dfbd8-108ba.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 21.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAfklEQVQI142O2woDIQxE/f/vlAq6FhZvWRNtT7fvpQMJk2RmiHv9h713rVVV4b13EYE4qrXG4bxRSsk501Gw3zeQIhhjrLXmnHBOZuaYj+Pw3ocQYowpJcgDhMDedOq8LhFy8WAgiFyCTNX9/HXZOGd9LpVSPq99zTjVbJu9ASun6Jpvt5FhAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber09.png"
        title=""
        src="/ho_blog/static/fiber09-ac8503ac4e5f378f55ab8d7bfe6dfbd8-fb8a0.png"
        srcset="/ho_blog/static/fiber09-ac8503ac4e5f378f55ab8d7bfe6dfbd8-1a291.png 148w,
/ho_blog/static/fiber09-ac8503ac4e5f378f55ab8d7bfe6dfbd8-2bc4a.png 295w,
/ho_blog/static/fiber09-ac8503ac4e5f378f55ab8d7bfe6dfbd8-fb8a0.png 590w,
/ho_blog/static/fiber09-ac8503ac4e5f378f55ab8d7bfe6dfbd8-108ba.png 700w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p><code>updateClassComponent()</code> ë ì¬ì¡°ì ì íë ëì  ì§ë¦ê¸¸ë¡ old fiber íì í¸ë¦¬ë¥¼ work-in-progress í¸ë¦¬ë¡ ë³µì íë í¹ë³í ê²½ì°ê° ììµëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;cloneChildFibers(parentFiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;oldFiber&nbsp;=&nbsp;parentFiber.alternate</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(!oldFiber.child)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;let&nbsp;oldChild&nbsp;=&nbsp;oldFiber.child</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;let&nbsp;prevChild&nbsp;=&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;while&nbsp;(oldChild)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;newChild&nbsp;=&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;oldChild.type,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag:&nbsp;oldChild.tag,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateNode:&nbsp;oldChild.stateNode,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;props:&nbsp;oldChild.props,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partialState:&nbsp;oldChild.partialState,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alternate:&nbsp;oldChild,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent:&nbsp;parentFiber,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(prevChild)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prevChild.sibling&nbsp;=&nbsp;newChild</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parentFiber.child&nbsp;=&nbsp;newChild</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;prevChild&nbsp;=&nbsp;newChild</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;oldChild&nbsp;=&nbsp;oldChild.sibling</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p><code>cloneChildFibers()</code> ë ê° <code>wipFiber.alternate</code> ììë¤(children)ì ë³µì íê³  work-in-progress í¸ë¦¬ì ì¶ê°í©ëë¤. ìë¬´ê²ë ë³ê²½íì§ ììë ëë¯ë¡ ì´ë í <code>effectTag</code> ë ì¶ê°í  íìê° ììµëë¤.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber10-46742e113ecd9b82b1fbfb962b49a675-108ba.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 21.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAeklEQVQI131OMQ7EIAzj/29kQwLEgg4IgQa4uiB1rIfIcmLH6v+JtVatlZlFBKSUIhtEhKlwATWllHPGLsaICWXOecyttd77GIM3XvExgznntNbee2utMSaEgAjs3s8wg/w2TiOIMob6KIx41EFDvIX/VANfzFeMk+gGTJ7pA4j0X2oAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber10.png"
        title=""
        src="/ho_blog/static/fiber10-46742e113ecd9b82b1fbfb962b49a675-fb8a0.png"
        srcset="/ho_blog/static/fiber10-46742e113ecd9b82b1fbfb962b49a675-1a291.png 148w,
/ho_blog/static/fiber10-46742e113ecd9b82b1fbfb962b49a675-2bc4a.png 295w,
/ho_blog/static/fiber10-46742e113ecd9b82b1fbfb962b49a675-fb8a0.png 590w,
/ho_blog/static/fiber10-46742e113ecd9b82b1fbfb962b49a675-108ba.png 700w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p><code>performUnitOfWork()</code> ìì wipFiber ê° ìë¡ì´ ììë¤(children)ì ê°ì§ê³  ìì§ ìê±°ë ì´ë¯¸ ëª¨ë  ììë¤ì´ ì´ë¯¸ ììì ìë£ íì ë, <code>completeWork()</code>ë¥¼ í¸ì¶í©ëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;completeWork(fiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(fiber.tag&nbsp;==&nbsp;CLASS_COMPONENT)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;fiber.stateNode.__fiber&nbsp;=&nbsp;fiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(fiber.parent)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;childEffects&nbsp;=&nbsp;fiber.effects&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;thisEffect&nbsp;=&nbsp;fiber.effectTag&nbsp;!=&nbsp;null&nbsp;?&nbsp;[fiber]&nbsp;:&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;parentEffects&nbsp;=&nbsp;fiber.parent.effects&nbsp;||&nbsp;[]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;fiber.parent.effects&nbsp;=&nbsp;parentEffects.concat(childEffects,&nbsp;thisEffect)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;pendingCommit&nbsp;=&nbsp;fiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p><code>completeWork()</code>ë ë¨¼ì  í´ëì¤ ì»´í¬ëí¸ì ì¸ì¤í´ì¤ì ê´ë ¨ë fiber ì ëí ì°¸ì¡°ë¥¼ ìë°ì´í¸í©ëë¤. (ìì§í ë§í´ì, ì¬ê¸° ìì íìë ìì§ë§ ì´ëê°ì ìì´ì¼ í©ëë¤.)</p>
<p>ê·¸ë° ë¤ì <code>effects</code> ëª©ë¡ì ìì±í©ëë¤. ì´ ëª©ë¡ìë effectTag ê° ìë work-in-progress ìë¸ í¸ë¦¬ì ëª¨ë  fiber ë¤ì´ í¬í¨ë©ëë¤. (DELETION effectTag ë¥¼ ê°ì§ ì´ì  íì í¸ë¦¬ì íì´ë²ë í¬í¨). ì´ ìì´ëì´ë effectTag ê° ìë ëª¨ë  fiber ë¥¼ root <code>effects</code> ëª©ë¡ì ëì íë ê²ìëë¤.</p>
<p>ë§ì§ë§ì¼ë¡ fiber ì ë¶ëª¨(<code>parent</code>)ê° ìë¤ë©´, work-in-progress í¸ë¦¬ì ë£¨í¸ì ìì¹ í´ ìëê² ìëë¤. ë°ë¼ì ì°ë¦¬ë ìë°ì´í¸ì ëí ëª¨ë  ììì ìë£íê³  ëª¨ë  effects ë¥¼ ìì§íìµëë¤. <code>workLoop()</code>ì´ <code>commitAllWork()</code>ë¥¼ í¸ì¶ í  ì ìëë¡ <code>pendingCommit</code> ì root ë¥¼ ëìí©ëë¤.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/ho_blog/static/fiber11-648b738f5f4d8d0d37a11a67bf1bcd76-108ba.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 21.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAkklEQVQI122OSw6EMAxDuf8REQuKqESL6AKmX2iYN1TsxovIcWQ73f1CRO5/OM+zlFJr9d4fxwFhTSlBOjxa62EYlmWZ5xmulLLW7vveEtOD67qYwfsqQphzjrUjeF3XcRz7vp+miRSmMYZbaw4hxBjpaQQF/+Yc/b9mUonglnMuL9AxoGDgCieOFV1y/mwbn3wBKM3m+MI+f7YAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="fiber11.png"
        title=""
        src="/ho_blog/static/fiber11-648b738f5f4d8d0d37a11a67bf1bcd76-fb8a0.png"
        srcset="/ho_blog/static/fiber11-648b738f5f4d8d0d37a11a67bf1bcd76-1a291.png 148w,
/ho_blog/static/fiber11-648b738f5f4d8d0d37a11a67bf1bcd76-2bc4a.png 295w,
/ho_blog/static/fiber11-648b738f5f4d8d0d37a11a67bf1bcd76-fb8a0.png 590w,
/ho_blog/static/fiber11-648b738f5f4d8d0d37a11a67bf1bcd76-108ba.png 700w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>ì´ì  ë§ì§ë§ì¼ë¡ ë¨ìê±´ DOM ì ë³ê²½íë ê²ìëë¤.</p>
<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>function&nbsp;commitAllWork(fiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;fiber.effects.forEach(f&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;commitWork(f)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;})</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;fiber.stateNode._rootContainerFiber&nbsp;=&nbsp;fiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;nextUnitOfWork&nbsp;=&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;pendingCommit&nbsp;=&nbsp;null</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;commitWork(fiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(fiber.tag&nbsp;==&nbsp;HOST_ROOT)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;return</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;let&nbsp;domParentFiber&nbsp;=&nbsp;fiber.parent</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;while&nbsp;(domParentFiber.tag&nbsp;==&nbsp;CLASS_COMPONENT)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;domParentFiber&nbsp;=&nbsp;domParentFiber.parent</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;const&nbsp;domParent&nbsp;=&nbsp;domParentFiber.stateNode</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;if&nbsp;(fiber.effectTag&nbsp;==&nbsp;PLACEMENT&nbsp;&amp;&amp;&nbsp;fiber.tag&nbsp;==&nbsp;HOST_COMPONENT)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;domParent.appendChild(fiber.stateNode)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(fiber.effectTag&nbsp;==&nbsp;UPDATE)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;updateDomProperties(fiber.stateNode,&nbsp;fiber.alternate.props,&nbsp;fiber.props)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(fiber.effectTag&nbsp;==&nbsp;DELETION)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;commitDeletion(fiber,&nbsp;domParent)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>function&nbsp;commitDeletion(fiber,&nbsp;domParent)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;let&nbsp;node&nbsp;=&nbsp;fiber</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;while&nbsp;(true)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(node.tag&nbsp;==&nbsp;CLASS_COMPONENT)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node&nbsp;=&nbsp;node.child</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;domParent.removeChild(node.stateNode)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(node&nbsp;!=&nbsp;fiber&nbsp;&amp;&amp;&nbsp;!node.sibling)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node&nbsp;=&nbsp;node.parent</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(node&nbsp;==&nbsp;fiber)&nbsp;{</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;node&nbsp;=&nbsp;node.sibling</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="text plain null-grammar"><span>}</span></span></div></pre>
<p><code>commitAllWork()</code> ë¨¼ì  ê°ê°ì ëª¨ë  ë£¨í¸ <code>effects</code> ë¥¼ ìííì¬ <code>commitWork()</code> ë°ë³µí´ì í¸ì¶í©ëë¤. <code>commitWork()</code>ë ê° fiber ì <code>effectTag</code> ë¥¼ ê²ì¬í©ëë¤.</p>
<ul>
<li>
<p><code>PLACEMENT</code> ì¸ ê²½ì° ì°ë¦¬ë ë¶ëª¨ DOM ë¸ëë¥¼ ì°¾ì ë¤ì ë¨ìí fiber ì stateNode ë¥¼ ì¶ê°í©ëë¤.</p>
</li>
<li>
<p><code>UPDATE</code> ì¸ ê²½ì° stateNode ë¥¼ ì´ì  props ë° ì props ì í¨ê» ì ë¬íê³  <code>updateDomProperties()</code>ê° ìë°ì´í¸ í  í­ëª©ì ê²°ì íëë¡ í©ëë¤.</p>
</li>
<li>
<p><code>DELETION</code> ì´ê³  fiber ê° í¸ì¤í¸ ì»´í¬ëí¸ì¸ ê²½ì° ê°ë¨í©ëë¤. ê·¸ì  <code>removeChild()</code>ë¥¼ í¸ì¶íë©´ ë©ëë¤. ê·¸ë¬ë fiber ê° í´ëì¤ ì»´í¬ëí¸ì¸ ê²½ì° <code>removeChild()</code>ë¥¼ í¸ì¶íê¸° ì ì fiber íì í¸ë¦¬ìì ëª¨ë  í¸ì¤í¸ ì»´í¬ëí¸ë¥¼ ì°¾ìì ì ê±°í´ì¼ í©ëë¤.</p>
</li>
</ul>
<p>ëª¨ë  effects ê° ëëë©´ <code>nextUnitOfWork</code> ë° <code>pendingCommit</code> ì ì´ê¸°í í  ì ììµëë¤. work-in-progress í¸ë¦¬ë ììì¤ì¸ í¸ë¦¬ê° ìë ì´ì  í¸ë¦¬ê° ëë¯ë¡ ë£¨í¸ë¥¼ _rootContainerFiber ì í ë¹í©ëë¤. ì´ì  ì°ë¦¬ë íì¬ì ìë°ì´í¸ê° ëëê³  ë¤ì ìë°ì´í¸ë¥¼ ììí  ì¤ë¹ê° ëììµëë¤.</p></div><hr style="margin-bottom:1.53rem;" data-reactid="9"/><div style="display:flex;margin-bottom:3.825rem;" data-reactid="10"><img src="/ho_blog/static/img_profile.1f79e005.jpeg" alt="Merlin.ho" style="margin-right:0.765rem;margin-bottom:0;width:3.06rem;height:3.06rem;" data-reactid="11"/><p data-reactid="12"><!-- react-text: 13 -->Written by <!-- /react-text --><strong data-reactid="14">Merlin.ho</strong><!-- react-text: 15 --> who lives and works in Pangyo building useful things.<!-- /react-text --><!-- react-text: 16 --> <!-- /react-text --></p></div></div><span style="display:block;clear:both;" data-reactid="17"> </span></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-00a132d46dd380b9cb63.js","99219681209289":"component---node-modules-gatsby-plugin-offline-app-shell-js-5c4c5a0f7af9dc69d6d7.js","107818501498521":"component---src-templates-blog-post-js-dabe65ee189101b630a0.js","35783957827783":"component---src-pages-index-js-4a72a400e6141dde0d21.js","60335399758886":"path----557518bd178906f8d58a.js","210333531512890":"path---offline-plugin-app-shell-fallback-a0e39f21c11f6a62c5ab.js","140444808481594":"path---docker-depolyment-4012246536442f60159d.js","111898030062913":"path---call-stack-ae217c5d96088f3ccd78.js","67469829867878":"path---hello-monad-59e45b33826bee6342ec.js","163121481561693":"path---hello-web-server-50ce4db03e3201a76414.js","240236403038750":"path---maintainable-javascript-event-handling-08483da9a7c1874195de.js","275591574691347":"path---lazy-evaluation-b06a6cf4962e0032b9fb.js","78697077285144":"path---maintainable-javascript-user-error-throwing-2f9594d962f6c72f1e44.js","163591510377563":"path---maintainable-javascript-no-null-comparison-cd4e4ae619857122decb.js","219926873231408":"path---refactoring-complex-refactoring-3bde085886c272fceff0.js","122409595676540":"path---think-high-order-function-58f7199816abbe8ab707.js","105843449635648":"path---experience-monorepo-481c39ada3235001112a.js","174342234436027":"path---hello-middleware-214cfa12d70783762915.js","60702703624353":"path---hello-react-e0cd56e5890daca606f6.js","51191554927023":"path---javascript-basic-1-9a67a2cd34c9412b299b.js","73704410068446":"path---javascript-object-a5446c0327b623ee17b9.js","79996153856445":"path---refactoring-method-cleanup-46236c286e9dee8da3fa.js","257369935370228":"path---refactoring-moving-between-object-9e40449234c2cb6b787d.js","246346007348531":"path---tail-recursion-cb56656bef776961b80b.js","142221992286439":"path---ui-unit-testing-a749535a7628a8651417.js","88166365168691":"path---try-catch-786de2e0ecb3ac4f72aa.js","5023129853458":"path---value-and-reference-6083800bc1607839d93d.js","59645336058927":"path---hello-flow-f30a55513f3646cb48d1.js","90837107504198":"path---hello-oop-8753bd908c30244d5ee3.js","231909470762625":"path---refactoring-concise-conditionals-d2ab514478d45d06c674.js","58827738984857":"path---refactoring-organization-data-1-3cae99d84479a08a4086.js","177359372373161":"path---webpack-config-d646c3ec578c78b12b66.js","55049869895717":"path---hello-docker-05e42a31d1677fb4a2e0.js","160582500480188":"path---hello-webpack-b0122eda8ae66d76c639.js","23603272521549":"path---make-promise-dc2b0ce814f7e412d396.js","239272989053013":"path---refactoring-generalization-processing-e71d2e5e4b0e785fd2f5.js","122362222700994":"path---refactoring-5ee2d02ba04bdb575764.js","201965495218339":"path---refactoring-organization-data-2-6725e1fa3585396087cf.js","234343465206083":"path---sop-and-cors-dns-rebinding-0d28de5fe72d23bb7185.js","262138261438389":"path---hello-rxjs-3872b9c973e75356e524.js","71473981912016":"path---javascript-pattern-648c1f680f29c9828e5a.js","120945912393580":"path---refactoring-simplifying-method-calls-294a8dadb4d3828fd246.js","132591256042226":"path---hello-mobx-01735f8a0f592b5e0358.js","134631639062865":"path---build-react-8fe160cba69ecb4070e4.js","142629428675168":"path---index-cf2fab70390a644affba.js","114276838955818":"component---src-layouts-index-js-60e98b905b7a1c56256e.js"}/*]]>*/</script><script>
            
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'undefined', 'auto');
      }
      </script><script>/*<![CDATA[*/["/ho_blog/commons-241c3561f1c9cf4619a9.js","/ho_blog/app-00a132d46dd380b9cb63.js","/ho_blog/path---build-react-8fe160cba69ecb4070e4.js","/ho_blog/component---src-templates-blog-post-js-dabe65ee189101b630a0.js","/ho_blog/component---src-layouts-index-js-60e98b905b7a1c56256e.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>