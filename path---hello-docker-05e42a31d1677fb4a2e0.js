webpackJsonp([55049869895717],{472:function(n,s){n.exports={data:{site:{siteMetadata:{title:"Merlin Tec Blog",author:"merlin.ho"}},markdownRemark:{id:"/Users/merlin.ho/Documents/workspace/ho_blog/gatsby-blog/src/pages/hello-docker/index.md absPath of file >>> MarkdownRemark",html:'<h2>Docker term</h2>\n<h3>What is Docker?</h3>\n<ul>\n<li>소프트웨어를 containerization(컨테이너화) 한 플랫폼. ( 웹서비스 컨테이너 , 디비 컨테이너 따로 담는다고 하면 서로 isolation 화 할수 있고 서로 독립적인 공간을 가질수 있다. 서로에게 영향을 주지 않을수 있다. )</li>\n<li>containerization 란 컨테이너를 매체로 한 수송체계, 즉. 컨테이너 규격을 맞춰 놓으면 차 , 배 , 비행기등 더 쉽고 빠르게 대량 수송과 시간을 단축 시킬수 있다. 라는 장점을 지니고 있음.</li>\n<li>이걸로 유추해볼 때 도커는 다양한 SW 들을 컨테이너에 담아 이동하기가 쉽게하고 포터블하게 만들수있는 플랫폼.</li>\n<li>리눅스의 응용프로그램들을 소프트웨어 컨테이너 안에 배치시키는 일을 자동화 하는 오픈소스</li>\n</ul>\n<h3>What is Container?</h3>\n<ul>\n<li>개발 , 배포 , 운용 등을 위해 표준화된 단위로 구성된 소프트웨어 패키지화</li>\n<li>호스트 pc 의 커널을 공유하면서 SW 가 돌아갈수 있는 모든 구성들이 들어가있다. 대신, 불필요한 것들은 들어있지 않다.</li>\n<li>해당 도커 이미지를 run 시키면 해당 SW 가 돌아가는데 그 상태를 컨테이너 라고 한다.\n일종의 프로세스와 유사한 개념이다.</li>\n<li>이 해당 컨테이너 내부 환경을 정의하는 파일은 dockerfile 이다.</li>\n<li>나머지 시스템으로 부터 완전히 독립된 공간을 갖는다. 그래서 밖으로 통신하기 위해선 포트를 맵핑해야 한다.</li>\n</ul>\n<h3>What is Service?</h3>\n<ul>\n<li>서비스는 app 의 한 부분이다. 예를 들어 비디오를 공유하는 사이트는 데이타 베이스에 app data 를 저장하는 서비스, 비디오 업로드 후 transcoding 하는 서비스 등등..</li>\n<li>서비스들은 실제로 production 의 컨테이너들로 구성된다.</li>\n<li>하나의 서비스는 하나의 이미지만 실행하지만 그 이미지를 실행하는 방법을 쳬계화 할 수 있습니다. 그 체계화는 docker-compose.yml 파일에서 설정 할 수 있다.</li>\n<li>docker-compose.yml 파일에서는 어떤 포트를 사용해야하는지, 서비스가 가져가야 할 필요한 용량에 따라 얼마나 많은 복제 컨테이너를 실행시켜야 하는지, 서비스를 위해 얼마나 컴퓨팅 리소스를 할당할지를 설정 할 수 있다.</li>\n<li>docker-compose.yml 을 이용 하면 이미지를 일일이 다 run 시키지 않아도 된다.</li>\n</ul>\n<h3>What is Image?</h3>\n<ul>\n<li>도커 이미지란 서비스의 필요한 프로그램 , 라이브러리, 소스등을 설치한 뒤에 이를 파일로 만든 것이다. 쉽게 실행파일이라고 생각하면 된다.</li>\n<li>이미지를 만들기위해 dockerfile 에 필요한 명령들을 설정해 놓는다.</li>\n<li>이미지는 base image 와 parent image 로 나뉜다.</li>\n<li>base image 는 parent image 가 없는 이미지를 말한다.</li>\n<li>parent image 는 사용하는 이미지의 Dockerfile 내에 FROM 으로 지시되는 이미지이다. 만약 Dockerfile 내에 FROM 이 지시되어있지 않다면 부모 이미지가 없는것이고 이는 곧 base image 가 된다.</li>\n<li>Dockerfile 로 이미지를 만들때는 전에 만들었던 이미지 캐시를 잘 이용해야 한다. 기존 방식은 한줄 한줄 실행하면서 <br><b>임시 컨테이너 생성 > 명령어 수행 > 이미지 저장 > 임시 컨테이너 삭제 > 새로 만든 이미지 기반 임시 컨테이너 생성 > 명령어 수행 > 이미지로 저장 > 임시 컨테이너 삭제…</b> 이런식으로 수행…</li>\n</ul>\n<p>----> {해쉬아이디} : 이미지 저장 <br>\n----> Running in {해쉬아이디} : 명령어를 수행하기 위해 그 전 이미지 기반으로 임시 컨테이너 생성</p>\n<p>&#x3C; 처음 Dockerfile 돌렸을때 ></p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/ho_blog/static/img_build_init-746f6243da40bcdfd0dea81cd38cb1fe-3aa92.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 461px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 108.45986984815619%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAADlklEQVQ4y41V2XLiVhSUl7GN2cGAkNCONiSBDXgSZ5K85CH//0Wd7oPtpCpTNfOgEpLu7dunu8/BWXVzrNoZor9ThH/FcL+tMQsW2PgJyrJAWVVwVyuk2wJpmmA0GmFX77DZBKjrmvcNoijCcDDAzc0NnObWwal3g7dvv+F0PiJOU2RZivlshv1+j00YEaDC09MCbbfn7xq73Q5pliEIQlRVjaZtEccJEl5OPh3j2V3i5eWImh+rukEYBNjwarlw7flkEHJzhOPxiHyb20E1WbquyypKPh/s3Xw+J+CuQdl2PHGL1XKJMEqMQVFUyIvCTvZ9H0+LhW24u7sn2ycsFkvc3t7i4eEB0+kMS+51HAeOap9OJsYoSVKCtWRyQsdTA+pzf3+Puy9fLot/5lqRtu9L2NjEF/BuV7OkCk3TYpvnyKhrzru+eZ5nErjuGh0rk27SV8ZovzMn/fXaQ0x2YRiiKCsD1wKJfTqdTfj94dk07fVU4tTK/7jL+aurK7vIcG3W50VpjJ5pTkMNj6cTIh7Q7/cxmUxts7tyMRgOP6OyIiPpK1KfJUvs5XJl+qUsTQwPZCP35KKAhgTxCTIcDn6s4Xg8MYdUpsKapJk5G/B3nhd4ff1KTRv8/sefqHiINn2U91nmfwEV3MW7jgIQ04yhlQQBTQiDi64ZYyWW+v6xThV4NLRiN3nrta1xMn6UHmZIXpJdxMXMIvUsmMOQzBUlVRDrPdnWfBao9Ct5mNpTGT6dv8KRuxdxN4xHxrJ9O6CqdhaVIIyZyRfqmyHbbrFn+7XdwYACktDBOkR7X19/gVOUl8xF1C1NMnRdZ4aIWUmG6lf19ePjozk+Ho0x5fNgMGSEejRqxBRMLDoLGuzkbDG1mk5K3kuSJsqgTFCQl6zApUbSVI4vrEVje5beBvRhioKp3pTIGkeaKIfDwaLjrpbs3Tv0yG7AFh2Nhta7Yqt09PsD+6b2/NdlOieHQ+q2JgvPD8xVsb24XZhRmi4V56M2qzyf6/oE+18OxU7BloZZurVRJDCPDqpjMo4rAcpllf/DYMsxzbLuHUi9ez6/XnqaLnpkr2n009OmZDzkrLTTuBLDNZnUTWuxEXDTNN8v73uXMieggp2hIL9wFqoFBaznjhWIaUo5WgIXdF6BViNonTIcW+QSG3XO9fW1ObylVjJGjNq2MTBpVtGMkGGvqaeAdZAqyvintaVp2vf265vNR8XtH2gPQKn6zAVOAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="처음 Dockerfile 돌렸을때"\n        title=""\n        src="/ho_blog/static/img_build_init-746f6243da40bcdfd0dea81cd38cb1fe-3aa92.png"\n        srcset="/ho_blog/static/img_build_init-746f6243da40bcdfd0dea81cd38cb1fe-999a6.png 148w,\n/ho_blog/static/img_build_init-746f6243da40bcdfd0dea81cd38cb1fe-a24ab.png 295w,\n/ho_blog/static/img_build_init-746f6243da40bcdfd0dea81cd38cb1fe-3aa92.png 461w"\n        sizes="(max-width: 461px) 100vw, 461px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>&#x3C; 기존 Dockerfile 을 2 번째 돌렸을때 ></p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/ho_blog/static/img_build_before-7f2e4d4e319728eb8656bacb2419016f-3aa92.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 461px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 100.43383947939262%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADCElEQVQ4y5VVW1PaUBDmJjAqVRIIMeR2yA0SCCJSp086tT9C+2Qda0WL1al1pv3zX3fX1nHaGdGHMycJZ/d8l92lsPh5jbW4AbUfwHnvQh0G0BIdPdXHcDRCFMfwPQ++CpD0+6iUS9jastBut+H5vuyG0UG9VkWhUEDh+8UpfHrYySPsHb6D3/cRDELoehthGCCmJL2egmluIY4TJEmCEV0UhiF8XyEMQnrPoZSSiwp3X87Ro4R7gxST7SmSMEEURnSzgcFgQMgUPEJodW0JzMdjDIcjWkPYtkOXBcjzMcbjbXS7XUp4f4+u6yGjw67rwnYcocaJ0jQlJBFcx5XbPc/FxuYmOqZJiXpYX2+g0WjIb4y4XC6jMJ/PUavWYFldouDDoeCdnSkh2ZYgDtjY2KDDpQeNlq2rq68SwAJ7vodOxxSN2JCclk0XmJ2OoGL0rVYLis4a9I0ZBHSpYRjyblmk4fHRsWTusOhJH1EUIwgedNG0ptBYWVmRvVKpoEyrVquhWq1idXUV9Xpdfq8SS94L88tLSlgUHdI0Q5aNMJvNkGZD0syXAA5m6mtra8spn5+fo7nZfHCTqGzSc48Q9vsDocDuNptNKRHbtlEsFp9P+PH4gbKm6YJw9naPSiLD9mRK2hkvM+Lpur29hdbU4BI9pXxouv6nQxISX9F3D7qmUY05ZIB6pG5Zthj0X8KjR1NMMYVXQMU6pLrktvprBuvIZpRKJfnG72LCvwnPzj7LIa5DppyQdlz1XIfcZhz4KsqLxYJovBFHubCZRo/6c0LFbRJqNuRVCT+dnMgDTwxGyF3CfcoIbe5NPrTM2afr5uYGLb0lpeJTpzAi1m+6O5OxxcgrlbIcLr4k8enpqTy0qX3YWW4nHkWMUCfHX102FxcXKJFrDk2aQZZSh2SII5px1HqO3ZWJwom5XHhfqumPu3vYlovpZBexijCIM5gtgwp7Qt3SF9dns13pnDzPSR7t+YTXv75hNVyXvwD/Qw/uvkIradGQTXFwsE/6rcgQqNXqUofLKP8GCFj7k1ZmGmYAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="기존 Dockerfile을 2번째 돌렸을때"\n        title=""\n        src="/ho_blog/static/img_build_before-7f2e4d4e319728eb8656bacb2419016f-3aa92.png"\n        srcset="/ho_blog/static/img_build_before-7f2e4d4e319728eb8656bacb2419016f-999a6.png 148w,\n/ho_blog/static/img_build_before-7f2e4d4e319728eb8656bacb2419016f-a24ab.png 295w,\n/ho_blog/static/img_build_before-7f2e4d4e319728eb8656bacb2419016f-3aa92.png 461w"\n        sizes="(max-width: 461px) 100vw, 461px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>&#x3C; 기존 Dockerfile 에서 EXPOSE 80 에서 EXPOSE 81 로 변경했을 때 ></p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/ho_blog/static/img_build_after-8a6555902ada49113c4af2e4c616e516-ab65c.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 455px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 110.76923076923077%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAADlElEQVQ4y42UWVMiWRCFEQRF9qXYigKqqA2oYlNQY2IiZrpdIkQlbMcHp6P9Cf3/386cTKeJ6R7D7ocbdblUnZt58stMbL9skfOzaJ+1YX7swTgxUHaraDRMdC0L4WiEWq0Oq9eDbds4zGZhdbvo9wfo8axjmrCsLgqFAhKJBBKfN5eYpxJYTkOcffgdA6+HMBqh2WjA9TxMogi24/BjC54XII5jRJMJ//P1Atf1MJvN+I6LbtdC4nlzg0kmheNJhHi6hMc/fL5sGIYK2vYAJiOSaIJwhDiKMRqFGI0nFOhiMLAxnfKSeKa/E59fXuBNYk2t1++j1Wrpy74f8GyMIPA1RdO00Ol0UC6XUa/X4dgO8vkCskdHerkIHxxkkNjc3CCfy79GxPB79G2xPNbU+rwgl8vpUn9+ZT09PaHZbGm4PRotwnE8xUzTiDEcDhmZqT72mXar1caQe8vqMdUZwiDgtyaaPJd94urqSpWlkmOmGtGjwWCAxWKJYrGo/+3t7e0ikH0ymdRnOp1GKpXSvawUzyl4rSUX7ybiJY1fHq80ZSlEPp+nNweoVKoolUrfib+5NptbMtfUlCUt2TtDV9OWS9rtNiMtKXftdkuje1fw4uJCN9VqlczFWK3WxCNklMeo12q/Xoxva7vdKpAaIVEQkXi2IIueoiCVFlTkKQSUyyUcERXByCA+b0YoxtbrBvwgVHilgvP5QqPe39/XJT4eHh7qXtJOpzNalP8J3t7eIZs9QovoxMRgPB6zwidYnZxoa/2sCN8qvDu7vLxW8iVt2xm+As4uEf5MNr7DM0m5xeLU30rxx/X4+Ber19Fo/GDEAeArOr7vs+1CwjtVG05Pz7Akm81mkwhV+P4QA/oq3eWQjp3g3d2dsiYdMJvPVUCqfbpeM0qH/iaRpMf/9TKTyeg30pJ5Miz7neDDwwOrZSjEQ/LX4NgaE3AZSVJ5ORORNEVE6Kcp39/fo0SPLCLh+6HC7bq+igmP6/WpFmrF53Kx0Igksmq1pt5WSII8d4KfHh91OIig+69/I46t8/NztmKEMtutwJ42jAb7vaaXi486mZiVsCq9/x3YxVJZJ4kOUPawAC6TxuT8KxSK6q8sGfcyE99N+fn5bzi8LY4jeMTFJS6VckXBDoJAPZQpFDJ9GVsyIN4VfPn6gs5v9OuaY/1ThOAmRH9lc9Qv8eHPPzRCEZFRViy++ieTWibUj0so+AfpzTT853i5jwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="기존 Dockerfile 에서 EXPOSE 80 에서 EXPOSE 81로 변경했을 때"\n        title=""\n        src="/ho_blog/static/img_build_after-8a6555902ada49113c4af2e4c616e516-ab65c.png"\n        srcset="/ho_blog/static/img_build_after-8a6555902ada49113c4af2e4c616e516-a99df.png 148w,\n/ho_blog/static/img_build_after-8a6555902ada49113c4af2e4c616e516-caa51.png 295w,\n/ho_blog/static/img_build_after-8a6555902ada49113c4af2e4c616e516-ab65c.png 455w"\n        sizes="(max-width: 455px) 100vw, 455px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>이미지 생성시 FROM 에 적어둔 parent image 기반으로 변경사항만 따로 저장되는게 장점. vm 처럼 용량을 많이 먹지 않음. <br>\n따라서 parent image 기반으로 새로운 이미지를 만들고 parent image 를 삭제하려고 했을때 에러 뜸.</li>\n</ul>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/ho_blog/static/img_parent_error-62aa45154c39e50055992029e5ace308-efba4.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 11.587301587301587%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAg0lEQVQI1x2NQQ6DIAAEPRjFSqJgrRVssApiTOux///ZlHjamcts1s6K7rhjfpbnZ6QbBpZlxTmHMSN9/0BKSZ7nFGVJXdcURYGoKoQQlzdNQ9sqquTZ6+1Yd88SV8IRCXFLIYNfPTHuF29pQ9jSyYz3ATtNfM8Ta20KSrTWKKW5pfgfyswzLMTUIKAAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="error"\n        title=""\n        src="/ho_blog/static/img_parent_error-62aa45154c39e50055992029e5ace308-fb8a0.png"\n        srcset="/ho_blog/static/img_parent_error-62aa45154c39e50055992029e5ace308-1a291.png 148w,\n/ho_blog/static/img_parent_error-62aa45154c39e50055992029e5ace308-2bc4a.png 295w,\n/ho_blog/static/img_parent_error-62aa45154c39e50055992029e5ace308-fb8a0.png 590w,\n/ho_blog/static/img_parent_error-62aa45154c39e50055992029e5ace308-efba4.png 630w"\n        sizes="(max-width: 590px) 100vw, 590px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h3>What is Stack?</h3>\n<hr>\n<h2>Docker Structure</h2>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/ho_blog/static/img_structure-d38f16b7e2191f33734175d73efd4938-07c6b.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 58.41013824884792%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADPUlEQVQozy2S309bZRjH++eYqFfGOy80XqhLdE5ddjExmrkLY4xRL2YmsAIbcSDbnAGZUBooDAbtVmjpQCiUYrXD9rSlQCml5RxKfxxOz2kLGz+K+vHFePHN++RN3s/7fZ7vYwq4V1h0xpH8CrIU4SjYwYEcgGKMwZib1uAAY8k5VjWZk4NDZK1M3VyBD+dVzs8W+Nin8tZUnhfGtnnRvo0pE5FRwluoySLl7S2eJSfRsyvksylG4kHuhuewL/+O7485jg0dzShzcTbHezOF/3Rxrsi5X/NcEB+86sljimp7uJQKjpTGgGuNk6c1looHvOvVOed/xmu+Yz7z79I14WVe0QlX/2Zgo8qDdZ3hRIn6YJGGJZXW6QzeWA5TV0zjnRmVs5N5PuqOMLWSR9pW+W5Bpm9kGsewG7tjBueEj4eOWVyD43RORxjarBJQSnyysMulxV2+cqSYCe1gcmcqXH2icWOpgFkq0SzpBNIy5kAS24gHz6ATt32aSaeX8dFJXNZhbnkkeuJZJHmHb54YXBCz/Dyo8/WSjsmVq3G5a5Qzb77B23WXaY9oxNSnDKQP6c1Bj1Cn8g93Nk+wZE+4HVSxbhzhTBuElAKfLpZ4+VGWM4/zmEMCOFn4i7r2Pl56/jleP3uetpCKZBwz7/ESu9NG7Oef8NmGuCdm/MCfYWAohs29yZRsENzaoT5c5kbEoFmoRTIwjWeqXFnM0jy7SsN8ipuSxkq1xg89bq5caqTxi1YaWvqwpPdxRHexjq0xuLCDR9knJGdp8mW4bl2m6f4azWHh0LlZ5suggTm6J+ZQpimkEddr2B47sXZfxWZpwjLagzV9wMOohtWe4H5ghynF4M8tBbM/S8NwgkYRSsspcDxd5oPZIq+MZ3lf7FVbtESocEg07Wd3o5dc0sbqhov+LQEUIItFYngqhVdRCcoq34YrtC+XMUfKIlDR8iPh8FrYoOP0Upw3owZSvkL3+gG/JGv0pmp0Jo64Ha9gSe7Rn6xyb32f0fQev2WrWNYMcnqVlWKFH5cFcEI4rA8Z3Pof2BEzCAvgdbE+30d04VgXdYlrIsFTB6du6kV9ClrKVbgbN7AmyvQLtYu3/wIi9gl7h7to6QAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Docker Structure"\n        title=""\n        src="/ho_blog/static/img_structure-d38f16b7e2191f33734175d73efd4938-fb8a0.png"\n        srcset="/ho_blog/static/img_structure-d38f16b7e2191f33734175d73efd4938-1a291.png 148w,\n/ho_blog/static/img_structure-d38f16b7e2191f33734175d73efd4938-2bc4a.png 295w,\n/ho_blog/static/img_structure-d38f16b7e2191f33734175d73efd4938-fb8a0.png 590w,\n/ho_blog/static/img_structure-d38f16b7e2191f33734175d73efd4938-07c6b.png 868w"\n        sizes="(max-width: 590px) 100vw, 590px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><em>출처 : <a href="http://www.leafcats.com/146">http://www.leafcats.com/146</a></em></p>\n<hr>\n<h2>Docker Install</h2>\n<p><a href="https://docs.docker.com/engine/installation/">공식 홈페이지 참조</a></p>\n<hr>\n<h2>Docker use</h2>\n<p>도커 허브에서 원하는 이미지를 다운 받을 수 있다.\n<a href="https://hub.docker.com/">도커 허브</a></p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;--help</span></span></div></pre>\n<p>도커의 명령어를 살펴볼 수 있다.</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;pull&nbsp;nginx:latest</span></span></div><div class="line"><span class="text plain null-grammar"><span>or</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;run&nbsp;-d&nbsp;-it&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>--name&nbsp;merlin-nginx&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>-p&nbsp;8080:80&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>nginx:latest</span></span></div></pre>\n<p>pull 을 하면 해당 이미지만 받는것이다 <br>\nrun 을 실행하게 되면 local 에 nginx:latest 라는 이미지가 없으면 자동으로 hub 에서 다운받아서 run 을 시킨다.</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;images</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;ps</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;ps&nbsp;[-a]&nbsp;[-l]&nbsp;[-n&nbsp;number]</span></span></div></pre>\n<p>images 는 도커 이미지 리스트를 살펴볼 수 있다. <br>\nps 는 실행중인 컨테이너 리스트를 볼 수 있다. <br>\n-a 옵션을 붙이면 종료된 목록까지 볼 수 있다.<br>\n-l 옵션은 마지막 실행했던 목록 , -n 은 리눅스의 tail 명령어와 동일하다.</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;commit&nbsp;-a&nbsp;&quot;merlin&nbsp;&lt;merlin@kakaocrop.com&gt;&quot;&nbsp;-m&nbsp;olympic-search-pc&nbsp;naughty_torvalds&nbsp;search.daum.pc:olypic</span></span></div></pre>\n<p>현재 돌아가고 있는 컨테이너를 이미지로 만들 수 있다.<br>\n-a 옵션 : author , -m : 커밋 메세지 , &#x3C;naughty_torvalds> 들어가는 부분 : 지금 동작하고 있는 컨테이너 이름 , &#x3C;search.daum.pc:olypic> 새로운 이미지 네임과 태그</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;rm&nbsp;&lt;컨테이너&nbsp;이름&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;rmi&nbsp;&lt;이미지&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;한번에&nbsp;처리.</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;rm&nbsp;$(docker&nbsp;ps&nbsp;-a&nbsp;-q)</span></span></div></pre>\n<p>도커 이미지와 컨테이너 삭제</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;start&nbsp;&lt;컨테이너&nbsp;이름&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;stop&nbsp;&nbsp;&lt;컨테이너&nbsp;이름&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;restart&nbsp;&lt;컨테이너&nbsp;이름&gt;</span></span></div></pre>\n<p>도커 컨테이너 실행 , 중지 , 재부팅</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;attach&nbsp;&lt;실행중인&nbsp;컨테이너&nbsp;이름&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;exec&nbsp;-it&nbsp;&lt;실행중인&nbsp;컨테이너&nbsp;이름&gt;&nbsp;&lt;컨테이너&nbsp;안에서&nbsp;실행할&nbsp;명령&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;exec&nbsp;-it&nbsp;merlin-nginx&nbsp;/bin/bash</span></span></div></pre>\n<p>attach 는 실행중인 도커 컨테이너에 접속한다. 단, ps 쳤을때 command 에 /bin/bash 라고 쳐져있어야 자유롭게 입력할 수 있다. 그렇지 않으면 입력은 할 수 없고 출력만 보인다. <br>\nexec 는 컨테이너 안에서 수행할 명령을 날려줍니다. -it 옵션을 주면 실행된 bash 쉘에서 입력 및 출력을 할 수가 있습니다.</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;inspect&nbsp;&lt;컨테이너&nbsp;이름&nbsp;or&nbsp;이미지:태그&gt;</span></span></div></pre>\n<p>이미지 또는 컨테이너의 세부정보를 출력합니다.</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;history&nbsp;&lt;이미지:태그&gt;</span></span></div></pre>\n<p>이미지의 히스토리를 조회</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;diff&nbsp;&lt;실행중인&nbsp;컨테이너&nbsp;이름&gt;</span></span></div></pre>\n<p>컨테이너가 실행되면서 변경된 파일 목록을 출력합니다. 비교 기준은 컨테이너를 생성한 이미지 내용입니다.</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;cp&nbsp;&lt;컨테이너&nbsp;이름&gt;:&lt;경로&gt;&nbsp;&lt;호스트&nbsp;경로&gt;</span></span></div></pre>\n<p>컨테이너에서 파일을 꺼내기.</p>\n<hr>\n<h2>Docker build</h2>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;[OPTIONS]&nbsp;PATH&nbsp;|&nbsp;URL&nbsp;|&nbsp;-</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;build&nbsp;-t&nbsp;app&nbsp;.</span></span></div></pre>\n<p>-t 옵션은 생성할 이미지 이름을 지정합니다. <br>\n-f 옵션은 파일명을 custom 하게 지었을때 사용하거나 Dockerfile 경로가 루트에 없을때 이용. <br>\nPATH 는 도커 이미지 빌드 할때 전송되는 context 를 가리킨다. <br></p>\n<h3>Dockerfile</h3>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>#&nbsp;어떤&nbsp;이미지로부터&nbsp;새로운&nbsp;이미지를&nbsp;생성할지를&nbsp;작성</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;베이스를&nbsp;지정</span></span></div><div class="line"><span class="text plain null-grammar"><span>FROM&nbsp;node:argon</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;Dockerfile&nbsp;을&nbsp;관리하는&nbsp;사람의&nbsp;이름</span></span></div><div class="line"><span class="text plain null-grammar"><span>MAINTAINER&nbsp;&lt;&nbsp;merlin.ho&nbsp;&gt;&nbsp;merlin@merlin.com</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;/app&nbsp;directory&nbsp;생성</span></span></div><div class="line"><span class="text plain null-grammar"><span>RUN&nbsp;mkdir&nbsp;/app</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;/app&nbsp;directory를&nbsp;WORKDIR로&nbsp;설정</span></span></div><div class="line"><span class="text plain null-grammar"><span>WORKDIR&nbsp;/app</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;현재&nbsp;경로에&nbsp;있는&nbsp;package.json을&nbsp;/app에&nbsp;복사</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;ADD와&nbsp;기본적으로&nbsp;동일하나&nbsp;차이점은&nbsp;URL을&nbsp;지정할수&nbsp;없고&nbsp;압축파일을&nbsp;자동으로&nbsp;풀어주지&nbsp;않는다.&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>COPY&nbsp;package.json&nbsp;/app</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;파일과&nbsp;디렉토리를&nbsp;호스트에서&nbsp;docker&nbsp;image로&nbsp;copy한다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;src에&nbsp;파일&nbsp;대신&nbsp;url을&nbsp;입력할수&nbsp;있고&nbsp;압축&nbsp;파일의&nbsp;경우&nbsp;압축을&nbsp;해제하면서&nbsp;복사</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;호스트에&nbsp;있는&nbsp;.&nbsp;경로에&nbsp;있는걸&nbsp;/usr/src/app&nbsp;에&nbsp;복사.</span></span></div><div class="line"><span class="text plain null-grammar"><span>ADD&nbsp;&lt;&nbsp;src&nbsp;&gt;&nbsp;&lt;&nbsp;dest&nbsp;&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>ADD&nbsp;.&nbsp;/usr/src/app</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;내부적으로&nbsp;/bin/sh&nbsp;-c&nbsp;실행&nbsp;뒤&nbsp;npm&nbsp;install&nbsp;을&nbsp;실행</span></span></div><div class="line"><span class="text plain null-grammar"><span>RUN&nbsp;npm&nbsp;install</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;현재&nbsp;Dockerfile&nbsp;이&nbsp;있는&nbsp;경로의&nbsp;모든&nbsp;파일을&nbsp;/app&nbsp;에&nbsp;복사함</span></span></div><div class="line"><span class="text plain null-grammar"><span>COPY&nbsp;.&nbsp;/app</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;가상머신에&nbsp;오픈할&nbsp;포트넘버</span></span></div><div class="line"><span class="text plain null-grammar"><span>EXPOSE&nbsp;3000</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;도커&nbsp;컨테이너가&nbsp;실행&nbsp;되었을때&nbsp;실행되는&nbsp;명령&nbsp;지정,&nbsp;빌드할때는&nbsp;실행되지&nbsp;않으며&nbsp;여러개의&nbsp;CMD가&nbsp;존재할&nbsp;경우&nbsp;가장&nbsp;마지막&nbsp;것만&nbsp;실행&nbsp;됩니다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;한꺼번에&nbsp;여러&nbsp;개의&nbsp;프로그램을&nbsp;실행하고&nbsp;싶은&nbsp;경우에는&nbsp;run.sh파일을&nbsp;작성하여&nbsp;데몬으로&nbsp;실행하거나&nbsp;supervisord나&nbsp;forego와&nbsp;같은&nbsp;여러&nbsp;개의&nbsp;프로그램을&nbsp;실행하는&nbsp;프로그램을&nbsp;사용합니다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>CMD&nbsp;[&quot;npm&quot;,&nbsp;&quot;start&quot;]</span></span></div></pre>\n<h3>recommendation Dockerfile</h3>\n<ol>\n<li>\n<p>Containers should be ephemeral</p>\n<ul>\n<li>Ephemeral environments are also sometimes called “Dynamic environments”, “Temporary environments”, “on-demand environments” or “short-lived environments”.</li>\n<li>static environments 와 반대되는 개념이다.</li>\n<li>이것이 의미하는 바는 이 컨테이너를 우리가 stop and destroy 할 수 있고 새롭게 built 할 수 있으며 최소한의 셋팅과 설정으로 원하는 장소에 올려 놓을수 있다 라는것을 뜻함.</li>\n<li>그래서 항상 production 환경과 같은 환경에서 test 를 진행할 수 있다. test 도 하나의 이미지를 공유 함으로써 병렬로 진행 할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>Use a .dockerignore file</p>\n<ul>\n<li>우리는 docker build 커멘드를 치는 장소를 build context 라고 부른다.</li>\n<li>디폴트로 현재 디렉토리라고 가정하지만 구체적인 다른 디렉토리를 가리키려면 -f flag 를 사용해야한다.</li>\n<li>현재 디렉토리의 파일과 여러 디렉토리들을 docker deamon 에게 build context 로 보내지게 되는데 이 이것은 무심코 이미지 결과로 보내지게 되어 이미지 파일이 커지게 된다.</li>\n<li>따라서 .gitignore 와 비슷하게 .dockerignore 파일을 사용해서 관계없는 파일들을 exclude 시킬수 있다.</li>\n</ul>\n</li>\n<li>\n<p>Use multi-stage builds</p>\n<ul>\n<li>Docker 17.05 버전 이상에서는 multi-stage builds 로 최종 이미지 사이즈를 줄일 수 있다.</li>\n<li>multi-stage builds 란 Dockerfile 안에서 multiple FROM 구문을 사용하면 각각의 새로운 stage 가 빌드 되고 한 stage 에서 나온 결과 산출물을 또다른 stage 로 카피를 할 수 있다. 따라서 중간 산출물을 위해 Dockerfile 을 여러개 만들어서 중간 이미지를 만들고 하는 복잡한 과정을 거치지 않아도 된다.</li>\n<li>dockerfile 을 작성할때 자주 바뀌지 않은 것부터 자주 바뀌는 순으로 작성을 한다.</li>\n</ul>\n</li>\n<li>\n<p>Avoid installing unnecessary packages</p>\n<ul>\n<li>불필요한 패키지는 인스톨을 피해라.</li>\n<li>예를 들면 데이타베이스 이미지에 text editor 를 추가시킬 필요는 없다.</li>\n</ul>\n</li>\n<li>\n<p>Each container should have only one concern</p>\n<ul>\n<li>하나의 컨테이너는 오직 하나의 일만하게 시켜라.</li>\n<li>응용 프로그램을 여러 컨테이너로 분리하면 가로로 확장하고 컨테이너를 다시 사용하는 것이 훨씬 쉬워집니다.</li>\n<li>컨테이너를 깨끗하고 가능한 모듈화 시킬 수 있는 최고의 판단을 해라.</li>\n<li>만약 컨테이너 각각이 의존성을 띄고 있다면 Docker network 를 사용하면 컨테이너끼리의 커뮤니케이션을 할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>Minimize the number of layers</p>\n</li>\n<li>\n<p>Sort multi-line arguments</p>\n</li>\n<li>\n<p>Build cache</p>\n</li>\n</ol>\n<hr>\n<h2>10 things to avoid in docker containers</h2>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>1.&nbsp;Don’t&nbsp;store&nbsp;data&nbsp;in&nbsp;containers</span></span></div><div class="line"><span class="text plain null-grammar"><span>2.&nbsp;Don’t&nbsp;ship&nbsp;your&nbsp;application&nbsp;in&nbsp;two&nbsp;pieces</span></span></div><div class="line"><span class="text plain null-grammar"><span>3.&nbsp;Don’t&nbsp;create&nbsp;large&nbsp;images</span></span></div><div class="line"><span class="text plain null-grammar"><span>4.&nbsp;Don’t&nbsp;use&nbsp;a&nbsp;single&nbsp;layer&nbsp;image</span></span></div><div class="line"><span class="text plain null-grammar"><span>5.&nbsp;Don’t&nbsp;create&nbsp;images&nbsp;from&nbsp;running&nbsp;containers</span></span></div><div class="line"><span class="text plain null-grammar"><span>6.&nbsp;Don’t&nbsp;use&nbsp;only&nbsp;the&nbsp;“latest”&nbsp;tag</span></span></div><div class="line"><span class="text plain null-grammar"><span>7.&nbsp;Don’t&nbsp;run&nbsp;more&nbsp;than&nbsp;one&nbsp;process&nbsp;in&nbsp;a&nbsp;single&nbsp;container</span></span></div><div class="line"><span class="text plain null-grammar"><span>8.&nbsp;Don’t&nbsp;store&nbsp;credentials&nbsp;in&nbsp;the&nbsp;image.&nbsp;Use&nbsp;environment&nbsp;variables</span></span></div><div class="line"><span class="text plain null-grammar"><span>9.&nbsp;Don’t&nbsp;run&nbsp;processes&nbsp;as&nbsp;a&nbsp;root&nbsp;user</span></span></div><div class="line"><span class="text plain null-grammar"><span>10.&nbsp;Don’t&nbsp;rely&nbsp;on&nbsp;IP&nbsp;addresses</span></span></div></pre>\n<p><em>출처 : <a href="https://developers.redhat.com/blog/2016/02/24/10-things-to-avoid-in-docker-containers/">https://developers.redhat.com/blog/2016/02/24/10-things-to-avoid-in-docker-containers/</a></em></p>\n<hr>\n<h2>Docker app data 관리법</h2>\n<h3>호스트의 지정된 폴더를 컨테이너에 다이렉트로 마운트</h3>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;run&nbsp;--name&nbsp;merlin_ubuntu&nbsp;-d&nbsp;-v&nbsp;&lt;호스트&nbsp;폴더경로&gt;:&lt;마운트될&nbsp;컨테이너&nbsp;폴더경로&gt;&nbsp;-it&nbsp;ubuntu:14.04</span></span></div></pre>\n<h3>volume container 사용</h3>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>#&nbsp;볼륨&nbsp;컨테이너를&nbsp;만든다.&nbsp;busybox&nbsp;기반&nbsp;정말&nbsp;리눅스의&nbsp;최소&nbsp;기반만&nbsp;가지고&nbsp;있다.&nbsp;1.14MB</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;run&nbsp;-v&nbsp;/dbdata&nbsp;--name&nbsp;dbdata&nbsp;busybox</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;볼륨&nbsp;컨테이너를&nbsp;우분투&nbsp;컨테이너에&nbsp;연결</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;run&nbsp;--volumes-from=dbdata&nbsp;-it&nbsp;ubuntu:14.04&nbsp;/bin/bash</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;빽업도&nbsp;진행할&nbsp;수&nbsp;있다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;run&nbsp;—volumes-from&nbsp;dbdata&nbsp;-v&nbsp;$(pwd):/backup&nbsp;ubuntu&nbsp;tar&nbsp;cvf&nbsp;/backup/backup.tar&nbsp;/dbdata</span></span></div></pre>\n<h3>volume 으로 사용</h3>\n<ul>\n<li>보통 standalone 컨테이너에는 -v 또는 —volume 옵션을 사용했고, swarm service 에는 —mount 옵션을 사용해 왔지만 17.06 이후 버젼부터는 standalone 컨테이너에서 모두 사용이 가능하다.</li>\n<li>만약 볼륨드라이버의 구체적인 옵션을 셋팅해야 한다면 —mount 옵션을 사용해라.</li>\n<li>-v 또는 —volume 옵션은 도커 호스트에 파일 또는 디렉토리가 없을 경우 자동으로 생성해주지만 —mount 옵션은 자동으로 생성해주지 않는다 대신 에러를 뿜는다.</li>\n<li>-v 또는 —volume 은 세가지 field 를 가질수 있다 첫번째는 호스트 머신의 볼륨 이름이고 랜덤한 볼륨을 생성하고 싶다면 생략해도 된다. 두번째는 컨테이너 안에 생성될 디렉토리 또는 파일 path 이다. 세번째는 옵션으로 콤마(:)로 옵션을 나열할 수 있다. 예를 들면 ro(readonly) 옵션등이 있다.</li>\n<li>—mount 는 key=value 로 구성을 하고 key 에는 type, src or source , dst or target , volume-opt 등이 있다.</li>\n<li>type 의 경우에는 bind , volume , tmpfs 가 있다. 올바른 타입으로 선택하자.</li>\n<li>Voloumn 타입, volumn 은 도커에 의해 관리되는 host 쪽에 있는 파일시스템으로 저장이 된다. 여기서 volumn 은 ”~/Library/Containers/com.docker.docker/Data/com.docker.driver.amd64-linux/tty” 해당 경로에 있는 리눅스 안에 “/var/lib/docker/volumes/” 쪽에 저장이 된다. 도커가 아닌 프로세스가 이 파일은 수정하지 못하고 volumnes 는 도커 안에서 데이터를 유지하기 최고의 방법이다.</li>\n<li>bind 타입, 이 bind 타입은 host 어디에나 저장이 될 수 있다. 여기서 중요한 시스템 파일이나 디렉토리들에 사용이 될수있고 언제든지 도커가 아닌 프로세스나 도커 컨테이너에서 수정될수 있다.</li>\n<li>tmpfs 타입, 이 타입은 hosts 의 메모리에 저장이 된다. 그리고 host 파일시스템에 쓸수가 없다. 휘발성이 강하다.</li>\n</ul>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;volume&nbsp;create&nbsp;my-vol</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;volume&nbsp;ls</span></span></div><div class="line"><span class="text plain null-grammar"><span>##&nbsp;Remove&nbsp;a&nbsp;volume:</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;volume&nbsp;rm&nbsp;my-vol</span></span></div></pre>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>##&nbsp;컨테이너&nbsp;연결</span></span></div><div class="line"><span class="text plain null-grammar"><span>##&nbsp;mount&nbsp;방법</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;run&nbsp;-d&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;-it&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;--name&nbsp;devtest&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;--mount&nbsp;source=myvol2,target=/app&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;nginx:latest</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;$&nbsp;docker&nbsp;run&nbsp;-d&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;-it&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;--name=nginxtest&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;--mount&nbsp;source=nginx-vol,destination=/usr/share/nginx/html&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;nginx:latest</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;-v&nbsp;방법</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;$&nbsp;docker&nbsp;run&nbsp;-d&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;-it&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;--name&nbsp;devtest&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;-v&nbsp;myvol2:/app&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;nginx:latest</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;$&nbsp;docker&nbsp;run&nbsp;-d&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;-it&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;--name=nginxtest&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;-v&nbsp;nginx-vol:/usr/share/nginx/html&nbsp;\\</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;nginx:latest</span></span></div></pre>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/ho_blog/static/img_busybox-4a20af0d205541a77e55e0cf58b015dc-a6c62.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 3.985932004689331%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAANElEQVQI12NgYGD4j4xFRcX+S0lKoojx8fH/19LS/q+jq/tfQUERLq6srPxfXV3jvySSegB1Qhc0E8E1eQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="img_busybox 용량"\n        title=""\n        src="/ho_blog/static/img_busybox-4a20af0d205541a77e55e0cf58b015dc-fb8a0.png"\n        srcset="/ho_blog/static/img_busybox-4a20af0d205541a77e55e0cf58b015dc-1a291.png 148w,\n/ho_blog/static/img_busybox-4a20af0d205541a77e55e0cf58b015dc-2bc4a.png 295w,\n/ho_blog/static/img_busybox-4a20af0d205541a77e55e0cf58b015dc-fb8a0.png 590w,\n/ho_blog/static/img_busybox-4a20af0d205541a77e55e0cf58b015dc-a6c62.png 853w"\n        sizes="(max-width: 590px) 100vw, 590px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>마운트 된 경로는 inspect 명령어로 알아 볼 수 있다.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/ho_blog/static/img_mount-832c2b5fee3133b85cfa73b7f72f28a6-7208f.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 22.55358807082945%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAkklEQVQY06VQWwrDMAzLC5qmyaAU8tE8Bk229f4X1GIPdoF8CAnZlrHFcRzQWkMIASkl8xQopPWOWp/43Deuq7E+z4RcCkqtKKWyl3NhJi/GCO89QngMBNbrukIopdFf7xFwMupo3vcdzjlu+g3RQMC2+b9H9WVZYK3lINIEobVBax0pJS5On0z/M8bwFqXUdOAXX6xt8IkhKWIAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="마운트 경로"\n        title=""\n        src="/ho_blog/static/img_mount-832c2b5fee3133b85cfa73b7f72f28a6-fb8a0.png"\n        srcset="/ho_blog/static/img_mount-832c2b5fee3133b85cfa73b7f72f28a6-1a291.png 148w,\n/ho_blog/static/img_mount-832c2b5fee3133b85cfa73b7f72f28a6-2bc4a.png 295w,\n/ho_blog/static/img_mount-832c2b5fee3133b85cfa73b7f72f28a6-fb8a0.png 590w,\n/ho_blog/static/img_mount-832c2b5fee3133b85cfa73b7f72f28a6-526de.png 885w,\n/ho_blog/static/img_mount-832c2b5fee3133b85cfa73b7f72f28a6-7208f.png 1073w"\n        sizes="(max-width: 590px) 100vw, 590px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>결론은 어찌되었건 호스트에 데이타를 연동 시킨다. <br>\nvolume container 를 사용했을 떄 데이터도 컨테이너로 관리를 할 수 있다. 그럼..컨테이너의 장점을 다 이용할 수 있지 않을까…</p>\n<hr>\n<h2>Docker compose</h2>\n<p>여러 컨테이너의 Docker application 을 running 하고 defining 하기 위한 툴이 Compose 이다. Compose 를 사용하기 위해서 YAML 파일에 config 를 app service 별로 설정하면 되고 한 커맨드 라인으로 서비스를 만들고 시작할수 있다. 해당 서비스는 YAML 파일에 적혀있는 그대로를 실행시킨다.</p>\n<p>docker compose install\n<a href="https://docs.docker.com/compose/install/#install-compose">docker compose install</a></p>\n<p>공식문서 <a href="https://docs.docker.com/compose/compose-file/">https://docs.docker.com/compose/compose-file/</a></p>\n<h3>Docker compose 를 사용하는 방법</h3>\n<ol>\n<li>Define your app’s environment with a <code>Dockerfile</code> so it can be reproduced anywhere.</li>\n<li>Define the services that make up your app in <code>docker-compose.yml</code> so they can be run together in an isolated environment.</li>\n<li>Run <code>docker-compose up</code> and Compose starts and runs your entire app.</li>\n</ol>\n<h3>Docker compose config</h3>\n<p>version 3</p>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>#&nbsp;compose&nbsp;버젼&nbsp;3을&nbsp;이용하겠다.&nbsp;대소문자&nbsp;주의</span></span></div><div class="line"><span class="text plain null-grammar"><span>version:&nbsp;&#39;3&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>services:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;webapp:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;build:&nbsp;./dir&nbsp;#&nbsp;구체적인&nbsp;빌드&nbsp;컨텍스트의&nbsp;경로를&nbsp;지정할&nbsp;수&nbsp;있다.&nbsp;도커&nbsp;파일을&nbsp;포함하는&nbsp;디렉토리나&nbsp;깃&nbsp;레파지토리&nbsp;url,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;build:&nbsp;#&nbsp;또는&nbsp;구체적인&nbsp;옵션들을&nbsp;설정할&nbsp;수&nbsp;있다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context:&nbsp;./dir</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dockerfile:&nbsp;Dockerfile-alternate</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args:&nbsp;#&nbsp;빌드&nbsp;프로세스&nbsp;진행중에&nbsp;사용할&nbsp;환경&nbsp;변수들을&nbsp;지정할&nbsp;수&nbsp;있다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buildno:&nbsp;1</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cache_from:&nbsp;#&nbsp;v3.2지원&nbsp;엔진이&nbsp;캐시로&nbsp;사용할&nbsp;이미지들</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;alpine:latest</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;corp/web_app:3.14</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command:&nbsp;bundle&nbsp;exec&nbsp;thin&nbsp;-p&nbsp;3000&nbsp;&nbsp;#&nbsp;디폴트&nbsp;커멘드를&nbsp;오버라이딩</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name:&nbsp;my-web-container&nbsp;#&nbsp;컨테이너&nbsp;이름</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;버전&nbsp;3부터는&nbsp;depend_on&nbsp;안에&nbsp;condition은&nbsp;지원하지&nbsp;않는다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;depends_on:&nbsp;#&nbsp;서비스들&nbsp;간에&nbsp;의존성을&nbsp;표현,&nbsp;이것은&nbsp;db,&nbsp;redis&nbsp;이후에&nbsp;webapp&nbsp;이&nbsp;실행하게&nbsp;된다.(compose&nbsp;up시)</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;db</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;redis</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpfs:&nbsp;/run&nbsp;#&nbsp;컨테이너에&nbsp;임시&nbsp;파일&nbsp;시스템을&nbsp;마운트&nbsp;,&nbsp;리스트로&nbsp;작성해도&nbsp;된다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entrypoint:&nbsp;/code/entrypoint.sh&nbsp;#&nbsp;도커&nbsp;파일의&nbsp;엔트리&nbsp;포인트를&nbsp;오버라이딩&nbsp;,&nbsp;리스트로&nbsp;작성해도&nbsp;된다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;env_file:&nbsp;&nbsp;#&nbsp;환경변수들을&nbsp;파일로&nbsp;받는다.&nbsp;이&nbsp;환경&nbsp;변수&nbsp;파일들은&nbsp;각각&nbsp;라인마다&nbsp;VAR=VAL&nbsp;포멧으로&nbsp;작성한다.&nbsp;#은&nbsp;주석</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;./common.env</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;./apps/web.env</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;/opt/secrets.env</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;environment:&nbsp;#&nbsp;환경변수&nbsp;추가.&nbsp;어떤&nbsp;boolen&nbsp;값들은&nbsp;quotes로&nbsp;감싼다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RACK_ENV:&nbsp;development</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOW:&nbsp;&#39;true&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SESSION_SECRET:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expose:&nbsp;#&nbsp;포트&nbsp;노출</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&quot;3000&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&quot;8000&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;external_links:&nbsp;#&nbsp;링크&nbsp;컨테이너&nbsp;docker-compose.yml&nbsp;외부에&nbsp;있는&nbsp;컨테이너&nbsp;,&nbsp;CONTAINER:ALIAS</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;redis_1</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;project_db_1:mysql</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;project_db_1:postgresql</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra_hosts:&nbsp;#&nbsp;/etc/hosts&nbsp;에&nbsp;추가</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&quot;somehost:162.242.195.82&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&quot;otherhost:50.31.209.229&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image:&nbsp;redis&nbsp;#&nbsp;특별한&nbsp;이미지로&nbsp;부터&nbsp;런&nbsp;,&nbsp;이미지가&nbsp;없으면&nbsp;pull&nbsp;한다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;healthcheck:&nbsp;#&nbsp;이&nbsp;서비스를&nbsp;위해&nbsp;건강한지&nbsp;체크&nbsp;,&nbsp;이미지로&nbsp;부터&nbsp;어떤&nbsp;디폴트&nbsp;헬스체크를&nbsp;disable&nbsp;하려면&nbsp;disable:&nbsp;true&nbsp;추가</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test:&nbsp;[&quot;CMD&quot;,&nbsp;&quot;curl&quot;,&nbsp;&quot;-f&quot;,&nbsp;&quot;</span><span class="markup underline link http hyperlink"><span>http://localhost</span></span><span>&quot;]</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interval:&nbsp;1m30s</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timeout:&nbsp;10s</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;retries:&nbsp;3</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labels:&nbsp;#&nbsp;라벨&nbsp;추가.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;com.example.description:&nbsp;&quot;Accounting&nbsp;webapp&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;com.example.department:&nbsp;&quot;Finance&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;com.example.label-with-empty-value:&nbsp;&quot;&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;links:&nbsp;#&nbsp;다른&nbsp;서비스들의&nbsp;컨테이너&nbsp;들과&nbsp;연결고리를&nbsp;형성,&nbsp;SERVICE:ALIAS&nbsp;,&nbsp;주의!!&nbsp;--links&nbsp;플래그는&nbsp;레거시&nbsp;이다.&nbsp;--links&nbsp;사용을&nbsp;대신해서&nbsp;사용자가&nbsp;정의하는&nbsp;네트워크&nbsp;설정을&nbsp;이용하길&nbsp;권장한다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;db</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;db:database</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;redis</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging:&nbsp;#&nbsp;서비스의&nbsp;로깅&nbsp;config</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver:&nbsp;syslog&nbsp;#&nbsp;json-file&nbsp;,&nbsp;syslog&nbsp;,&nbsp;none</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syslog-address:&nbsp;&quot;tcp://192.168.0.42:123&quot;,</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max-size:&nbsp;&quot;200k&quot;&nbsp;#&nbsp;json-file&nbsp;의&nbsp;경우&nbsp;로그&nbsp;저장을&nbsp;제한할&nbsp;수&nbsp;있다.&nbsp;오래된&nbsp;파일은&nbsp;지워진다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max-file:&nbsp;&quot;10&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network_mode:&nbsp;bridge&nbsp;#&nbsp;네트워크&nbsp;모드&nbsp;설정&nbsp;,&nbsp;host&nbsp;,&nbsp;none&nbsp;,&nbsp;service:[service&nbsp;name]&nbsp;,&nbsp;container:[container&nbsp;name/id]&nbsp;////&nbsp;host&nbsp;모드는&nbsp;links랑&nbsp;같이&nbsp;사용할&nbsp;수&nbsp;없다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;networks:&nbsp;#&nbsp;top&nbsp;level&nbsp;에서&nbsp;지정한&nbsp;네트워크&nbsp;설정&nbsp;,&nbsp;알리아스를&nbsp;사용할&nbsp;수&nbsp;도&nbsp;있다.&nbsp;이&nbsp;알리아스&nbsp;네임으로&nbsp;서비스를&nbsp;연결&nbsp;할&nbsp;수&nbsp;있다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;some-network</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;other-network</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aliases:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;database</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ports:&nbsp;#&nbsp;HOST:CONTAINER</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&quot;8000:8000&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volumes:&nbsp;#&nbsp;호스트&nbsp;경로&nbsp;또는&nbsp;생성된&nbsp;볼륨을&nbsp;마운트&nbsp;시킨다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;type:&nbsp;volume</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source:&nbsp;mydata</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target:&nbsp;/data</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volume:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nocopy:&nbsp;true</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;type:&nbsp;bind</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source:&nbsp;./static</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target:&nbsp;/opt/app/static</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>volumes:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;mydata:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;external&nbsp;:&nbsp;true&nbsp;#&nbsp;컴포즈&nbsp;밖에&nbsp;volume이&nbsp;존재했을때,&nbsp;없으면&nbsp;&#39;docker&nbsp;volume&nbsp;create&nbsp;--name=&#39;&nbsp;으로&nbsp;만들라고&nbsp;에러뜸.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;:&nbsp;actual-name-of-volume&nbsp;#&nbsp;이름을&nbsp;지정할&nbsp;수도&nbsp;있다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;dbdata:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>networks:</span></span></div></pre>\n<ul>\n<li>직접 했던 예제</li>\n</ul>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>version:&nbsp;&#39;3.2&#39;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>services:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;app_blue:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;image:&nbsp;blog_express:v1</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;depends_on:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;nginx-proxy</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;mongo-db</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;working_dir:&nbsp;/app/</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;networks:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;dbconnection</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;environment:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;VIRTUAL_HOST=nodeapp.local</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;volumes:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;type:&nbsp;bind</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source:&nbsp;./server</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target:&nbsp;/app/server</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;command:&nbsp;npm&nbsp;start</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;app_green:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;image:&nbsp;blog_express:v1</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;depends_on:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;nginx-proxy</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;mongo-db</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;working_dir:&nbsp;/app/</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;networks:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;dbconnection</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;environment:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;VIRTUAL_HOST=nodeapp.local</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;volumes:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;type:&nbsp;bind</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source:&nbsp;./server</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target:&nbsp;/app/server</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;command:&nbsp;npm&nbsp;start</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;nginx-proxy:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;image:&nbsp;jwilder/nginx-proxy</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;ports:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;8081:80</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;networks:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;dbconnection</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;volumes:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;/var/run/docker.sock:/tmp/docker.sock:ro</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;mongo-db:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;image:&nbsp;mongo</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;depends_on:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;nginx-proxy</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;volumes:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;db-data:/data/db</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;networks:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;dbconnection</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;command:&nbsp;mongod&nbsp;--dbpath&nbsp;&quot;/data/db&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>volumes:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;db-data:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="text plain null-grammar"><span>networks:</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;dbconnection:</span></span></div></pre>\n<hr>\n<h2>Docker network</h2>\n<p>출처 : <a href="http://bluese05.tistory.com/15">http://bluese05.tistory.com/15</a></p>\n<h3>network 구성</h3>\n<ul>\n<li>도커를 설치 하면 docker host 쪽에 보면 <strong>docker0</strong> 이라는 virtual ethernet bridge 를 확인할 수 있다. ( $ ifconfig 로 확인가능, 난 172.17.0.1 로 셋팅되어 있다.)</li>\n<li>docker0 는 container 가 통신하기 위한 가상 linux bridge 이다. bridge 는 기본적으로 L2 통신 기반이다.</li>\n<li>컨테이너가 하나씩 생성되면 이 bridge 에 하나씩 바인딩 된다. ( $ brctl show docker0 )</li>\n<li>이렇게 연결된 컨테이너와 host 는 케이블로 연결한 두대의 pc 라고 보면 된다.</li>\n<li>컨테이너 내부의 eth0 인터페이스는 내부로 격리되어있어서 이 내부와 host 를 이어줄 vethxxxx 형태의 인터페이스가 하나 더 존재한다. 이 인터페이스가 host 와 컨테이너 사이를 연결해준다.</li>\n<li>컨테이너 내부의 아이피를 확인하려면 ifconfig eth0 라고 치면 되는데 ifconfig 가 잘 안먹는다. 그럴땐 도커 inspect 로 확인하자.</li>\n</ul>\n<h3>network 확인</h3>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;ip&nbsp;addr&nbsp;show</span></span></div><div class="line"><span class="text plain null-grammar"><span>or</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;ifconfig</span></span></div></pre>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;attach&nbsp;nonenetcontainer</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;접속후</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;cat&nbsp;/etc/hosts</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;ip&nbsp;-4&nbsp;addr</span></span></div></pre>\n<p>attach 했던걸 detach 하기 위해선 CTRL-p CTRL-q 를 입력하면 된다.</p>\n<h3>network 방식</h3>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>#&nbsp;네트워크&nbsp;방식&nbsp;확인하기&nbsp;(&nbsp;드라이버&nbsp;)&nbsp;bridge&nbsp;,&nbsp;host&nbsp;,&nbsp;none&nbsp;(&nbsp;네임&nbsp;기준&nbsp;)</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;network&nbsp;ls</span></span></div></pre>\n<pre class="editor editor-colors"><div class="line"><span class="text plain null-grammar"><span>#&nbsp;기본&nbsp;네트워크는&nbsp;bridge&nbsp;방식이다.</span></span></div><div class="line"><span class="text plain null-grammar"><span>#&nbsp;다른방식으로&nbsp;컨테이너를&nbsp;생성하고&nbsp;싶다면</span></span></div><div class="line"><span class="text plain null-grammar"><span>$&nbsp;docker&nbsp;run&nbsp;--new={네트워크&nbsp;타입}</span></span></div></pre>\n<ol>\n<li>\n<p>birdge</p>\n<ul>\n<li>네트워크에서 브릿지란 호스트 서버의 네트워크를 연결하여 가상화된 머신들도 동일한 네트워크를 사용하도록 하는 것이다.</li>\n<li>docker network inspect bridge 로 브릿지 모드의 자세한 내용을 확인 할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>host</p>\n<ul>\n<li>이 방식은 컨테이너가 독립적인 네트워크 영역을 갖지 않고 host 와 네트워크를 함께 사용한다.</li>\n<li>따라서 해당 컨테이너는 host 의 네트워크 정보와 동일시 하게 가져가게 된다.</li>\n<li>따라서 docker0 에 바인딩 되지 않는다.</li>\n</ul>\n</li>\n<li>\n<p>container</p>\n<ul>\n<li>다른 컨테이너의 네트워크 환경을 가져온다. 즉, ip 와 mac 주소를 동일시 하게 구성한다.</li>\n<li>docker run —name web03 —net=container:{컨테이너 id} -d nginx:alpine</li>\n</ul>\n</li>\n<li>\n<p>none</p>\n<ul>\n<li>이 옵션은 격리된 네트워크 환경은 갖지만, 인터페이스가 없는 상태로 컨테이너를 생성하게 된다.</li>\n</ul>\n</li>\n</ol>\n<h3>container 외부 통신</h3>\n<ul>\n<li>각 컨테이너는 격리된 환경에서 각각의 mac 주소와 ip 주소를 부여 받는다.</li>\n<li>각 컨테이너들은 host 와 통신하기 위해 bridge 방식으로 바인딩 되어있는데 각 부여받은 ip 로 자유롭게 통신 가능.</li>\n<li>예를 들면 web 서비스를 하는 container 는 80 번 포트에서 리스닝을 하고있다. 이 포트는 외부와 통신이 되어야 하는데 이때 포트를 외부로 지정한다. -p 8080:80 으로 옵션을 주게 되면 docker host 의 8080 포트로 요청이 들어오면 컨테이너의 80 포트로 해당 요청을 forwarding 하겠다는 의미이다.</li>\n<li>docker ps -a or netstat -nlp | grep 8080 로 확인</li>\n</ul>\n<h3>link 방식의 한계</h3>\n<ul>\n<li>link 방식은 하나의 호스트 사이에서 실행되는 컨테이너 사이에서만 연결이 가능하다.</li>\n<li>다수의 host 가 존재했을때, 다른 host 의 컨테이너에는 접근할 수가 없다.</li>\n<li>이 경우 docker swarm 같은 orchestration 툴을 사용하거나 dynamic DNS 를 구축해야한다.</li>\n</ul>\n<blockquote>\n<p>Warning: >The —link flag is a legacy feature of Docker. It may eventually be removed. Unless you absolutely need to continue using it, we recommend that you use user-defined networks to facilitate communication between two containers instead of using —link. One feature that user-defined networks do not support that you can do with —link is sharing environmental variables between containers. However, you can use other mechanisms such as volumes to share environment variables between containers in a more controlled way.</p>\n</blockquote>\n<p>** dynamic DNS 란? - 간단하게 ip 가 바뀌면 그걸 알아채서 외부 DNS 서버에 알려준다. 그러면 ip 가 동적으로 바뀌는 환경에서도 사용자는 바뀐 ip 를 알 필요 없이 domain name 만 알면 동일하게 접속 할 수 있다.</p>',
frontmatter:{title:"Hello Docker",date:"January 09, 2018"}}},pathContext:{slug:"/hello-docker/"}}}});
//# sourceMappingURL=path---hello-docker-05e42a31d1677fb4a2e0.js.map